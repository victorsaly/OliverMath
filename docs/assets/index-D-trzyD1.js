const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Assistant-Cf7rrYP-.js","assets/vendor-8tk9GLIC.js","assets/Assistant-D2kYHlrP.css"])))=>i.map(i=>d[i]);
import{c as cs,w as L,d as ah,I as ch,a as uh,r as B,o as qi,b as q,e as ph,f as dh,p as _s,s as hh,g as lh,h as vh,t as us,i as fh,n as gh,j as mh,k as Sh,l as Ch,m as yh,q as Rh,u as Ph,v as Eh,x as Th,y as Ah,z as Ih,A as wh,B as _h,C as bh,D as Mh,E as J,F as Oh,_ as Dh,G as kh,H as Nh}from"./vendor-8tk9GLIC.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))u(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&u(s)}).observe(document,{childList:!0,subtree:!0});function i(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function u(n){if(n.ep)return;n.ep=!0;const o=i(n);fetch(n.href,o)}})();const Ss=(e,t)=>{const i=e.__vccOpts||e;for(const[u,n]of t)i[u]=n;return i},zh=ah({name:"App",components:{IonApp:uh,IonRouterOutlet:ch}});function jh(e,t,i,u,n,o){const s=B("ion-router-outlet"),r=B("ion-app");return qi(),cs(r,null,{default:L(()=>[q(s)]),_:1})}const Lh=Ss(zh,[["render",jh]]),qh=()=>{const e=[],t={},i=f=>{switch(f.routerAction){case"pop":n(f);break;default:o(f);break}f.routerDirection==="root"&&(s(),o(f))},u=f=>{const m=e.findIndex(S=>S.id===f.id);m>-1&&e.splice(m,1,f);const v=t[f.tab||""];if(v){const S=v.findIndex(C=>C.id===f.id);S>-1?v.splice(S,1,f):v.push(f)}else f.tab&&(t[f.tab]=[f])},n=f=>{const m=r(f.tab);let v;if(m){for(v=m[m.length-1];v&&v.id!==f.id;)m.pop(),v=m[m.length-1];m.pop(),m.push(f)}for(v=e[e.length-1];v&&v.id!==f.id;)e.pop(),v=e[e.length-1];e.pop(),e.push(f)},o=f=>{const m=r(f.tab);m&&(m[m.length-1]&&m[m.length-1].id===f.id&&m.pop(),m.push(f)),e.push(f)},s=f=>{if(f){const{position:m,tab:v}=f,S=e.findIndex(R=>R.position===m);if(S===-1)return;e.splice(S);const C=R=>{const T=t[R].findIndex(E=>E.position===m);T!==-1&&t[R].splice(T)},y=t[v];if(v&&y)C(v);else for(const R in t)C(R)}else{for(const m in t)t[m]=[];e.length=0}},r=f=>{let m;return f&&(m=t[f],m||(m=t[f]=[])),m},a=()=>e.length,c=(f,m)=>{const v=m-f;return e[v]||p()},p=()=>e[e.length-1];return{current:c,size:a,last:p,add:i,canGoBack:(f=1,m,v)=>v-f>=m,update:u,getFirstRouteInfoForTab:f=>{const m=r(f);if(m)return m[0]},getCurrentRouteInfoForTab:f=>{const m=r(f);if(m)return m[m.length-1]},findLastLocation:(f,m=-1)=>{const v=r(f.tab);if(v){if(m<-1)return v[v.length-1+m];for(let S=v.length-2;S>=0;S--){const C=v[S];if(C&&C.pathname===f.pushedByRoute)return C}}for(let S=e.length-2;S>=0;S--){const C=e[S];if(C&&C.pathname===f.pushedByRoute)return e[S+1+m]}},clearHistory:s}},bs={main:0},mp=(e="main")=>{var t;const i=((t=bs[e])!==null&&t!==void 0?t:0)+1;return bs[e]=i,i.toString()},Bh=(e,t)=>{let i={direction:void 0,action:void 0,delta:void 0};t.afterEach((E,P,I)=>{if(I)return;const{direction:M,action:k,delta:ee}=i;o=e.history.state.position;const _=e.history.state.replaced?"replace":void 0;d(E,k||_,M,ee),i={direction:void 0,action:void 0,delta:void 0}});const u=qh();let n=e.history.state.position,o=e.history.state.position,s,r;const a=[];typeof document<"u"&&document.addEventListener("ionBackButton",E=>{E.detail.register(0,P=>{e.history.go(-1),P()})}),e.history.listen((E,P,I)=>{i={delta:I.delta,action:I.type==="pop"&&I.delta>=1?"push":I.type,direction:I.direction===""?"forward":I.direction}});const c=(E,P)=>{const I=u.current(n,o);if(I&&I.pushedByRoute){const M=u.findLastLocation(I);M?(r=Object.assign(Object.assign({},M),{routerAction:"pop",routerDirection:"back",routerAnimation:P||I.routerAnimation}),I.lastPathname===I.pushedByRoute||M.pathname===I.pushedByRoute&&!I.tab&&!M.tab?t.back():t.go(M.position-I.position)):p(E,"pop","back",P)}else p(E,"pop","back",P)},p=(E,P,I,M,k)=>{C(P,I,M,k),P==="push"?t.push(E):t.replace(E)},d=(E,P,I,M)=>{let k;if(r)if(r.routerAction==="replace")k=u.current(n,o);else if(r.routerAction==="pop")k=u.current(n,o+1),P==="replace"&&u.clearHistory();else{const _=r.routerDirection==="root"?o:o-1;k=u.current(n,_)}else k=s;if(k||(k={pathname:"",search:""}),k.pathname+k.search!==E.fullPath){if(!r){if(P==="replace")r={routerAction:"replace",routerDirection:"none"};else if(P==="pop"){const de=u.current(n,o-M);if(de&&de.pushedByRoute){const N=u.findLastLocation(de,M);r=Object.assign(Object.assign({},N),{routerAction:"pop",routerDirection:"back"})}else r={routerAction:"pop",routerDirection:"none"}}r||(r={routerAction:"push",routerDirection:I||"forward"})}let _;if(r!=null&&r.id)_=Object.assign(Object.assign({},r),{lastPathname:k.pathname});else{const de=r.routerAction==="push"&&r.routerDirection==="forward";if(_=Object.assign(Object.assign({id:mp("routeInfo")},r),{lastPathname:k.pathname,pathname:E.path,search:E.fullPath&&E.fullPath.split("?")[1]||"",params:E.params&&E.params,prevRouteLastPathname:k.lastPathname}),de)_.pushedByRoute=k.pathname!==""?k.pathname:void 0;else if(_.routerAction==="pop"){const N=u.findLastLocation(_);_.pushedByRoute=N==null?void 0:N.pushedByRoute}else if(_.routerAction==="push"&&_.tab!==k.tab){const N=u.getCurrentRouteInfoForTab(_.tab);_.pushedByRoute=N==null?void 0:N.pushedByRoute}else if(_.routerAction==="replace"){const N=u.current(n,o),qe=N==null?void 0:N.pushedByRoute,Wi=qe!==void 0&&qe!==_.pathname?qe:_.pushedByRoute;_.lastPathname=(N==null?void 0:N.pathname)||_.lastPathname,_.pushedByRoute=Wi,_.routerDirection=(N==null?void 0:N.routerDirection)||_.routerDirection,_.routerAnimation=(N==null?void 0:N.routerAnimation)||_.routerAnimation,_.prevRouteLastPathname=N==null?void 0:N.lastPathname}}_.position=o,_.delta=M;const Ne=u.size(),ki=o-n,Ui=Ne===ki&&Ne>0&&P==="replace";Ne>ki||Ui?(_.routerAction==="push"||_.routerAction==="replace")&&M===void 0&&(u.clearHistory(_),u.add(_)):u.add(_),u.size()===1&&(n=_.position),s=_}r=void 0,a.forEach(_=>_(s))},l=()=>s,h=(E=1)=>u.canGoBack(E,n,o),g=E=>{const{routerAnimation:P,routerDirection:I,routerLink:M}=E;C("push",I,P),t.push(M)},f=E=>{const P=u.getFirstRouteInfoForTab(E);P&&t.go(P.position-o)},m=(E,P)=>{if(!P)return;const I=u.getCurrentRouteInfoForTab(E),[M]=P.split("?");I?(r=Object.assign(Object.assign({},r),{routerAction:"push",routerDirection:"none",tab:E}),I.pathname===M?t.push({path:I.pathname,query:_s(I.search)}):t.push({path:M,query:_s(I.search)})):p(M,"push","none",void 0,E)},v=E=>{const P=Object.assign({},u.current(n,o));P.tab!==E&&(P.tab=E,u.update(P));const I=u.findLastLocation(P);P.pushedByRoute!==P.lastPathname&&(I==null?void 0:I.tab)!==E&&(P.pushedByRoute=void 0,u.update(P))},S=E=>{a.push(E)},C=(E="push",P="forward",I,M)=>{r={routerAction:E,routerDirection:P,routerAnimation:I,tab:M}};return{handleNavigate:p,getLeavingRouteInfo:()=>u.current(n,o),handleNavigateBack:c,handleSetCurrentTab:v,getCurrentRouteInfo:l,canGoBack:h,navigate:g,resetTab:f,changeTab:m,registerHistoryChangeListener:S,goBack:E=>{C("pop","back",E),t.back()},goForward:E=>{C("push","forward",E),t.forward()}}},Fh=e=>{const t={},i=()=>Object.keys(t).length,u=v=>{delete t[v]},n=v=>t[v],o=(v,S)=>{v.ionPageElement=S,v.ionRoute=!0,v.matchedRoute.instances={default:v.vueComponentRef.value}},s=(v,S)=>p(v.pathname,S,!1),r=(v,S,C=!0)=>p(v.lastPathname,S,C),a=(v,S)=>p(v,S,!1),c=(v,S)=>S.find(C=>{if(C.pathname===v)return C}),p=(v,S,C=!1)=>{const y=R=>{if(C&&!R.ionRoute||v==="")return!1;const E=e.resolve(v).matched.find(P=>P===R.matchedRoute);if(E)return E.path.includes(":")&&v!==R.pathname?!1:R};if(S){const R=t[S];if(!R)return;const T=e?R.find(y):c(v,R);if(T)return T}else for(const R in t){const T=t[R],E=c(v,T);if(E)return E}};return{unmountLeavingViews:(v,S,C=1)=>{const y=t[v];if(!y)return;const R=y.findIndex(T=>T===S);for(let T=R+1;T<R-C;T++){const E=y[T];E.mount=!1,E.ionPageElement=void 0,E.ionRoute=!1,E.matchedRoute.instances={}}},mountIntermediaryViews:(v,S,C=1)=>{const y=t[v];if(!y)return;const R=y.findIndex(T=>T===S);for(let T=R+1;T<R+C;T++)y[T].mount=!0},clear:u,findViewItemByRouteInfo:s,findLeavingViewItemByRouteInfo:r,findViewItemByPathname:a,createViewItem:(v,S,C,y,R)=>({id:mp("viewItem"),pathname:y.pathname,outletId:v,matchedRoute:C,ionPageElement:R,vueComponent:S,vueComponentRef:hh(),ionRoute:!1,mount:!1,exact:y.pathname===C.path,params:y.params,vueComponentData:{}}),getChildrenToRender:v=>t[v]?t[v].filter(y=>y.mount):[],add:v=>{const{outletId:S}=v;t[S]?t[S].push(v):t[S]=[v]},remove:(v,S)=>{if(!S)throw Error("outletId required");const C=t[S];C&&(t[S]=C.filter(y=>y.id!==v.id))},registerIonPage:o,getViewStack:n,size:i}},xh=e=>{const t=Object.assign({},e);delete t.tabsPrefix;const i=ph(t),u=Bh(e,i),n=Fh(i),o=i.install.bind(i);i.install=r=>{r.provide("navManager",u),r.provide("viewStacks",n),o(r)};const s=i.isReady.bind(i);return i.isReady=()=>s(),i},Uh=e=>dh(e),Wh={name:"BotFace",props:{botState:{type:String,default:"neutral"},text:{type:String,default:""},isPlayMode:{type:Boolean,default:!0}}},Hh={class:"bubble speech"};function Kh(e,t,i,u,n,o){return qi(),lh("div",{id:"bot",class:gh(i.botState)},[vh("p",Hh,us(i.text),1),t[0]||(t[0]=fh('<div id="head" data-v-a1ac0ce1><div id="left-ear" data-v-a1ac0ce1><div id="left-ear-inner" data-v-a1ac0ce1></div></div><div id="face" data-v-a1ac0ce1><div id="eyes" data-v-a1ac0ce1><div id="left-eye" data-v-a1ac0ce1></div><div id="right-eye" data-v-a1ac0ce1></div></div><div id="mouth" data-v-a1ac0ce1></div></div><div id="right-ear" data-v-a1ac0ce1><div id="right-ear-inner" data-v-a1ac0ce1></div></div></div>',1))],2)}const Vh=Ss(Wh,[["render",Kh],["__scopeId","data-v-a1ac0ce1"]]);function Jh(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var i=function u(){return this instanceof u?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};i.prototype=t.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(e).forEach(function(u){var n=Object.getOwnPropertyDescriptor(e,u);Object.defineProperty(i,u,n.get?n:{enumerable:!0,get:function(){return e[u]}})}),i}var he={},le={},Be={},ve={},z={},Ki={},fe={},Vi={},Fe={},Ni={},Ms;function Sp(){if(Ms)return Ni;Ms=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.default=i;let e;const t=new Uint8Array(16);function i(){if(!e&&(e=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!e))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return e(t)}return Ni}var ze={},xe={},Ue={},Os;function Gh(){if(Os)return Ue;Os=1,Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.default=void 0;var e=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;return Ue.default=e,Ue}var Ds;function Bi(){if(Ds)return xe;Ds=1,Object.defineProperty(xe,"__esModule",{value:!0}),xe.default=void 0;var e=t(Gh());function t(n){return n&&n.__esModule?n:{default:n}}function i(n){return typeof n=="string"&&e.default.test(n)}var u=i;return xe.default=u,xe}var ks;function Fi(){if(ks)return ze;ks=1,Object.defineProperty(ze,"__esModule",{value:!0}),ze.default=void 0,ze.unsafeStringify=u;var e=t(Bi());function t(s){return s&&s.__esModule?s:{default:s}}const i=[];for(let s=0;s<256;++s)i.push((s+256).toString(16).slice(1));function u(s,r=0){return i[s[r+0]]+i[s[r+1]]+i[s[r+2]]+i[s[r+3]]+"-"+i[s[r+4]]+i[s[r+5]]+"-"+i[s[r+6]]+i[s[r+7]]+"-"+i[s[r+8]]+i[s[r+9]]+"-"+i[s[r+10]]+i[s[r+11]]+i[s[r+12]]+i[s[r+13]]+i[s[r+14]]+i[s[r+15]]}function n(s,r=0){const a=u(s,r);if(!(0,e.default)(a))throw TypeError("Stringified UUID is invalid");return a}var o=n;return ze.default=o,ze}var Ns;function Qh(){if(Ns)return Fe;Ns=1,Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.default=void 0;var e=i(Sp()),t=Fi();function i(c){return c&&c.__esModule?c:{default:c}}let u,n,o=0,s=0;function r(c,p,d){let l=p&&d||0;const h=p||new Array(16);c=c||{};let g=c.node||u,f=c.clockseq!==void 0?c.clockseq:n;if(g==null||f==null){const R=c.random||(c.rng||e.default)();g==null&&(g=u=[R[0]|1,R[1],R[2],R[3],R[4],R[5]]),f==null&&(f=n=(R[6]<<8|R[7])&16383)}let m=c.msecs!==void 0?c.msecs:Date.now(),v=c.nsecs!==void 0?c.nsecs:s+1;const S=m-o+(v-s)/1e4;if(S<0&&c.clockseq===void 0&&(f=f+1&16383),(S<0||m>o)&&c.nsecs===void 0&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");o=m,s=v,n=f,m+=122192928e5;const C=((m&268435455)*1e4+v)%4294967296;h[l++]=C>>>24&255,h[l++]=C>>>16&255,h[l++]=C>>>8&255,h[l++]=C&255;const y=m/4294967296*1e4&268435455;h[l++]=y>>>8&255,h[l++]=y&255,h[l++]=y>>>24&15|16,h[l++]=y>>>16&255,h[l++]=f>>>8|128,h[l++]=f&255;for(let R=0;R<6;++R)h[l+R]=g[R];return p||(0,t.unsafeStringify)(h)}var a=r;return Fe.default=a,Fe}var We={},oe={},He={},zs;function Cp(){if(zs)return He;zs=1,Object.defineProperty(He,"__esModule",{value:!0}),He.default=void 0;var e=t(Bi());function t(n){return n&&n.__esModule?n:{default:n}}function i(n){if(!(0,e.default)(n))throw TypeError("Invalid UUID");let o;const s=new Uint8Array(16);return s[0]=(o=parseInt(n.slice(0,8),16))>>>24,s[1]=o>>>16&255,s[2]=o>>>8&255,s[3]=o&255,s[4]=(o=parseInt(n.slice(9,13),16))>>>8,s[5]=o&255,s[6]=(o=parseInt(n.slice(14,18),16))>>>8,s[7]=o&255,s[8]=(o=parseInt(n.slice(19,23),16))>>>8,s[9]=o&255,s[10]=(o=parseInt(n.slice(24,36),16))/1099511627776&255,s[11]=o/4294967296&255,s[12]=o>>>24&255,s[13]=o>>>16&255,s[14]=o>>>8&255,s[15]=o&255,s}var u=i;return He.default=u,He}var js;function yp(){if(js)return oe;js=1,Object.defineProperty(oe,"__esModule",{value:!0}),oe.URL=oe.DNS=void 0,oe.default=s;var e=Fi(),t=i(Cp());function i(r){return r&&r.__esModule?r:{default:r}}function u(r){r=unescape(encodeURIComponent(r));const a=[];for(let c=0;c<r.length;++c)a.push(r.charCodeAt(c));return a}const n="6ba7b810-9dad-11d1-80b4-00c04fd430c8";oe.DNS=n;const o="6ba7b811-9dad-11d1-80b4-00c04fd430c8";oe.URL=o;function s(r,a,c){function p(d,l,h,g){var f;if(typeof d=="string"&&(d=u(d)),typeof l=="string"&&(l=(0,t.default)(l)),((f=l)===null||f===void 0?void 0:f.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let m=new Uint8Array(16+d.length);if(m.set(l),m.set(d,l.length),m=c(m),m[6]=m[6]&15|a,m[8]=m[8]&63|128,h){g=g||0;for(let v=0;v<16;++v)h[g+v]=m[v];return h}return(0,e.unsafeStringify)(m)}try{p.name=r}catch{}return p.DNS=n,p.URL=o,p}return oe}var Ke={},Ls;function Xh(){if(Ls)return Ke;Ls=1,Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.default=void 0;function e(h){if(typeof h=="string"){const g=unescape(encodeURIComponent(h));h=new Uint8Array(g.length);for(let f=0;f<g.length;++f)h[f]=g.charCodeAt(f)}return t(u(n(h),h.length*8))}function t(h){const g=[],f=h.length*32,m="0123456789abcdef";for(let v=0;v<f;v+=8){const S=h[v>>5]>>>v%32&255,C=parseInt(m.charAt(S>>>4&15)+m.charAt(S&15),16);g.push(C)}return g}function i(h){return(h+64>>>9<<4)+14+1}function u(h,g){h[g>>5]|=128<<g%32,h[i(g)-1]=g;let f=1732584193,m=-271733879,v=-1732584194,S=271733878;for(let C=0;C<h.length;C+=16){const y=f,R=m,T=v,E=S;f=a(f,m,v,S,h[C],7,-680876936),S=a(S,f,m,v,h[C+1],12,-389564586),v=a(v,S,f,m,h[C+2],17,606105819),m=a(m,v,S,f,h[C+3],22,-1044525330),f=a(f,m,v,S,h[C+4],7,-176418897),S=a(S,f,m,v,h[C+5],12,1200080426),v=a(v,S,f,m,h[C+6],17,-1473231341),m=a(m,v,S,f,h[C+7],22,-45705983),f=a(f,m,v,S,h[C+8],7,1770035416),S=a(S,f,m,v,h[C+9],12,-1958414417),v=a(v,S,f,m,h[C+10],17,-42063),m=a(m,v,S,f,h[C+11],22,-1990404162),f=a(f,m,v,S,h[C+12],7,1804603682),S=a(S,f,m,v,h[C+13],12,-40341101),v=a(v,S,f,m,h[C+14],17,-1502002290),m=a(m,v,S,f,h[C+15],22,1236535329),f=c(f,m,v,S,h[C+1],5,-165796510),S=c(S,f,m,v,h[C+6],9,-1069501632),v=c(v,S,f,m,h[C+11],14,643717713),m=c(m,v,S,f,h[C],20,-373897302),f=c(f,m,v,S,h[C+5],5,-701558691),S=c(S,f,m,v,h[C+10],9,38016083),v=c(v,S,f,m,h[C+15],14,-660478335),m=c(m,v,S,f,h[C+4],20,-405537848),f=c(f,m,v,S,h[C+9],5,568446438),S=c(S,f,m,v,h[C+14],9,-1019803690),v=c(v,S,f,m,h[C+3],14,-187363961),m=c(m,v,S,f,h[C+8],20,1163531501),f=c(f,m,v,S,h[C+13],5,-1444681467),S=c(S,f,m,v,h[C+2],9,-51403784),v=c(v,S,f,m,h[C+7],14,1735328473),m=c(m,v,S,f,h[C+12],20,-1926607734),f=p(f,m,v,S,h[C+5],4,-378558),S=p(S,f,m,v,h[C+8],11,-2022574463),v=p(v,S,f,m,h[C+11],16,1839030562),m=p(m,v,S,f,h[C+14],23,-35309556),f=p(f,m,v,S,h[C+1],4,-1530992060),S=p(S,f,m,v,h[C+4],11,1272893353),v=p(v,S,f,m,h[C+7],16,-155497632),m=p(m,v,S,f,h[C+10],23,-1094730640),f=p(f,m,v,S,h[C+13],4,681279174),S=p(S,f,m,v,h[C],11,-358537222),v=p(v,S,f,m,h[C+3],16,-722521979),m=p(m,v,S,f,h[C+6],23,76029189),f=p(f,m,v,S,h[C+9],4,-640364487),S=p(S,f,m,v,h[C+12],11,-421815835),v=p(v,S,f,m,h[C+15],16,530742520),m=p(m,v,S,f,h[C+2],23,-995338651),f=d(f,m,v,S,h[C],6,-198630844),S=d(S,f,m,v,h[C+7],10,1126891415),v=d(v,S,f,m,h[C+14],15,-1416354905),m=d(m,v,S,f,h[C+5],21,-57434055),f=d(f,m,v,S,h[C+12],6,1700485571),S=d(S,f,m,v,h[C+3],10,-1894986606),v=d(v,S,f,m,h[C+10],15,-1051523),m=d(m,v,S,f,h[C+1],21,-2054922799),f=d(f,m,v,S,h[C+8],6,1873313359),S=d(S,f,m,v,h[C+15],10,-30611744),v=d(v,S,f,m,h[C+6],15,-1560198380),m=d(m,v,S,f,h[C+13],21,1309151649),f=d(f,m,v,S,h[C+4],6,-145523070),S=d(S,f,m,v,h[C+11],10,-1120210379),v=d(v,S,f,m,h[C+2],15,718787259),m=d(m,v,S,f,h[C+9],21,-343485551),f=o(f,y),m=o(m,R),v=o(v,T),S=o(S,E)}return[f,m,v,S]}function n(h){if(h.length===0)return[];const g=h.length*8,f=new Uint32Array(i(g));for(let m=0;m<g;m+=8)f[m>>5]|=(h[m/8]&255)<<m%32;return f}function o(h,g){const f=(h&65535)+(g&65535);return(h>>16)+(g>>16)+(f>>16)<<16|f&65535}function s(h,g){return h<<g|h>>>32-g}function r(h,g,f,m,v,S){return o(s(o(o(g,h),o(m,S)),v),f)}function a(h,g,f,m,v,S,C){return r(g&f|~g&m,h,g,v,S,C)}function c(h,g,f,m,v,S,C){return r(g&m|f&~m,h,g,v,S,C)}function p(h,g,f,m,v,S,C){return r(g^f^m,h,g,v,S,C)}function d(h,g,f,m,v,S,C){return r(f^(g|~m),h,g,v,S,C)}var l=e;return Ke.default=l,Ke}var qs;function Zh(){if(qs)return We;qs=1,Object.defineProperty(We,"__esModule",{value:!0}),We.default=void 0;var e=i(yp()),t=i(Xh());function i(o){return o&&o.__esModule?o:{default:o}}var n=(0,e.default)("v3",48,t.default);return We.default=n,We}var Ve={},Je={},Bs;function Yh(){if(Bs)return Je;Bs=1,Object.defineProperty(Je,"__esModule",{value:!0}),Je.default=void 0;var t={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};return Je.default=t,Je}var Fs;function $h(){if(Fs)return Ve;Fs=1,Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.default=void 0;var e=u(Yh()),t=u(Sp()),i=Fi();function u(s){return s&&s.__esModule?s:{default:s}}function n(s,r,a){if(e.default.randomUUID&&!r&&!s)return e.default.randomUUID();s=s||{};const c=s.random||(s.rng||t.default)();if(c[6]=c[6]&15|64,c[8]=c[8]&63|128,r){a=a||0;for(let p=0;p<16;++p)r[a+p]=c[p];return r}return(0,i.unsafeStringify)(c)}var o=n;return Ve.default=o,Ve}var Ge={},Qe={},xs;function el(){if(xs)return Qe;xs=1,Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.default=void 0;function e(n,o,s,r){switch(n){case 0:return o&s^~o&r;case 1:return o^s^r;case 2:return o&s^o&r^s&r;case 3:return o^s^r}}function t(n,o){return n<<o|n>>>32-o}function i(n){const o=[1518500249,1859775393,2400959708,3395469782],s=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof n=="string"){const p=unescape(encodeURIComponent(n));n=[];for(let d=0;d<p.length;++d)n.push(p.charCodeAt(d))}else Array.isArray(n)||(n=Array.prototype.slice.call(n));n.push(128);const r=n.length/4+2,a=Math.ceil(r/16),c=new Array(a);for(let p=0;p<a;++p){const d=new Uint32Array(16);for(let l=0;l<16;++l)d[l]=n[p*64+l*4]<<24|n[p*64+l*4+1]<<16|n[p*64+l*4+2]<<8|n[p*64+l*4+3];c[p]=d}c[a-1][14]=(n.length-1)*8/Math.pow(2,32),c[a-1][14]=Math.floor(c[a-1][14]),c[a-1][15]=(n.length-1)*8&4294967295;for(let p=0;p<a;++p){const d=new Uint32Array(80);for(let v=0;v<16;++v)d[v]=c[p][v];for(let v=16;v<80;++v)d[v]=t(d[v-3]^d[v-8]^d[v-14]^d[v-16],1);let l=s[0],h=s[1],g=s[2],f=s[3],m=s[4];for(let v=0;v<80;++v){const S=Math.floor(v/20),C=t(l,5)+e(S,h,g,f)+m+o[S]+d[v]>>>0;m=f,f=g,g=t(h,30)>>>0,h=l,l=C}s[0]=s[0]+l>>>0,s[1]=s[1]+h>>>0,s[2]=s[2]+g>>>0,s[3]=s[3]+f>>>0,s[4]=s[4]+m>>>0}return[s[0]>>24&255,s[0]>>16&255,s[0]>>8&255,s[0]&255,s[1]>>24&255,s[1]>>16&255,s[1]>>8&255,s[1]&255,s[2]>>24&255,s[2]>>16&255,s[2]>>8&255,s[2]&255,s[3]>>24&255,s[3]>>16&255,s[3]>>8&255,s[3]&255,s[4]>>24&255,s[4]>>16&255,s[4]>>8&255,s[4]&255]}var u=i;return Qe.default=u,Qe}var Us;function tl(){if(Us)return Ge;Us=1,Object.defineProperty(Ge,"__esModule",{value:!0}),Ge.default=void 0;var e=i(yp()),t=i(el());function i(o){return o&&o.__esModule?o:{default:o}}var n=(0,e.default)("v5",80,t.default);return Ge.default=n,Ge}var Xe={},Ws;function rl(){if(Ws)return Xe;Ws=1,Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.default=void 0;var e="00000000-0000-0000-0000-000000000000";return Xe.default=e,Xe}var Ze={},Hs;function il(){if(Hs)return Ze;Hs=1,Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.default=void 0;var e=t(Bi());function t(n){return n&&n.__esModule?n:{default:n}}function i(n){if(!(0,e.default)(n))throw TypeError("Invalid UUID");return parseInt(n.slice(14,15),16)}var u=i;return Ze.default=u,Ze}var Ks;function nl(){return Ks||(Ks=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"NIL",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"v1",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(e,"v3",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"v4",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"v5",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"validate",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return s.default}});var t=p(Qh()),i=p(Zh()),u=p($h()),n=p(tl()),o=p(rl()),s=p(il()),r=p(Bi()),a=p(Fi()),c=p(Cp());function p(d){return d&&d.__esModule?d:{default:d}}})(Vi)),Vi}var Vs;function De(){if(Vs)return fe;Vs=1,Object.defineProperty(fe,"__esModule",{value:!0}),fe.createNoDashGuid=fe.createGuid=void 0;const e=nl(),t=()=>(0,e.v4)();fe.createGuid=t;const i=()=>t().replace(new RegExp("-","g"),"").toUpperCase();return fe.createNoDashGuid=i,fe}var Js;function Mi(){return Js||(Js=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PlatformEvent=e.EventType=void 0;const t=De();(function(u){u[u.Debug=0]="Debug",u[u.Info=1]="Info",u[u.Warning=2]="Warning",u[u.Error=3]="Error",u[u.None=4]="None"})(e.EventType||(e.EventType={}));class i{constructor(n,o){this.privName=n,this.privEventId=(0,t.createNoDashGuid)(),this.privEventTime=new Date().toISOString(),this.privEventType=o,this.privMetadata={}}get name(){return this.privName}get eventId(){return this.privEventId}get eventTime(){return this.privEventTime}get eventType(){return this.privEventType}get metadata(){return this.privMetadata}}e.PlatformEvent=i})(Ki)),Ki}var Gs;function sl(){if(Gs)return z;Gs=1,Object.defineProperty(z,"__esModule",{value:!0}),z.AudioStreamNodeErrorEvent=z.AudioStreamNodeDetachedEvent=z.AudioStreamNodeAttachedEvent=z.AudioStreamNodeAttachingEvent=z.AudioStreamNodeEvent=z.AudioSourceErrorEvent=z.AudioSourceOffEvent=z.AudioSourceReadyEvent=z.AudioSourceInitializingEvent=z.AudioSourceEvent=void 0;const e=Mi();class t extends e.PlatformEvent{constructor(l,h,g=e.EventType.Info){super(l,g),this.privAudioSourceId=h}get audioSourceId(){return this.privAudioSourceId}}z.AudioSourceEvent=t;class i extends t{constructor(l){super("AudioSourceInitializingEvent",l)}}z.AudioSourceInitializingEvent=i;class u extends t{constructor(l){super("AudioSourceReadyEvent",l)}}z.AudioSourceReadyEvent=u;class n extends t{constructor(l){super("AudioSourceOffEvent",l)}}z.AudioSourceOffEvent=n;class o extends t{constructor(l,h){super("AudioSourceErrorEvent",l,e.EventType.Error),this.privError=h}get error(){return this.privError}}z.AudioSourceErrorEvent=o;class s extends t{constructor(l,h,g){super(l,h),this.privAudioNodeId=g}get audioNodeId(){return this.privAudioNodeId}}z.AudioStreamNodeEvent=s;class r extends s{constructor(l,h){super("AudioStreamNodeAttachingEvent",l,h)}}z.AudioStreamNodeAttachingEvent=r;class a extends s{constructor(l,h){super("AudioStreamNodeAttachedEvent",l,h)}}z.AudioStreamNodeAttachedEvent=a;class c extends s{constructor(l,h){super("AudioStreamNodeDetachedEvent",l,h)}}z.AudioStreamNodeDetachedEvent=c;class p extends s{constructor(l,h,g){super("AudioStreamNodeErrorEvent",l,h),this.privError=g}get error(){return this.privError}}return z.AudioStreamNodeErrorEvent=p,z}var j={},Qs;function ol(){if(Qs)return j;Qs=1,Object.defineProperty(j,"__esModule",{value:!0}),j.ConnectionRedirectEvent=j.ConnectionMessageSentEvent=j.ConnectionMessageReceivedEvent=j.ConnectionEstablishErrorEvent=j.ConnectionErrorEvent=j.ConnectionClosedEvent=j.ConnectionEstablishedEvent=j.ConnectionStartEvent=j.ConnectionEvent=j.ServiceEvent=void 0;const e=Mi();class t extends e.PlatformEvent{constructor(l,h,g=e.EventType.Info){super(l,g),this.privJsonResult=h}get jsonString(){return this.privJsonResult}}j.ServiceEvent=t;class i extends e.PlatformEvent{constructor(l,h,g=e.EventType.Info){super(l,g),this.privConnectionId=h}get connectionId(){return this.privConnectionId}}j.ConnectionEvent=i;class u extends i{constructor(l,h,g){super("ConnectionStartEvent",l),this.privUri=h,this.privHeaders=g}get uri(){return this.privUri}get headers(){return this.privHeaders}}j.ConnectionStartEvent=u;class n extends i{constructor(l){super("ConnectionEstablishedEvent",l)}}j.ConnectionEstablishedEvent=n;class o extends i{constructor(l,h,g){super("ConnectionClosedEvent",l,e.EventType.Debug),this.privReason=g,this.privStatusCode=h}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}j.ConnectionClosedEvent=o;class s extends i{constructor(l,h,g){super("ConnectionErrorEvent",l,e.EventType.Debug),this.privMessage=h,this.privType=g}get message(){return this.privMessage}get type(){return this.privType}}j.ConnectionErrorEvent=s;class r extends i{constructor(l,h,g){super("ConnectionEstablishErrorEvent",l,e.EventType.Error),this.privStatusCode=h,this.privReason=g}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}j.ConnectionEstablishErrorEvent=r;class a extends i{constructor(l,h,g){super("ConnectionMessageReceivedEvent",l),this.privNetworkReceivedTime=h,this.privMessage=g}get networkReceivedTime(){return this.privNetworkReceivedTime}get message(){return this.privMessage}}j.ConnectionMessageReceivedEvent=a;class c extends i{constructor(l,h,g){super("ConnectionMessageSentEvent",l),this.privNetworkSentTime=h,this.privMessage=g}get networkSentTime(){return this.privNetworkSentTime}get message(){return this.privMessage}}j.ConnectionMessageSentEvent=c;class p extends i{constructor(l,h,g,f){super("ConnectionRedirectEvent",l,e.EventType.Info),this.privRedirectUrl=h,this.privOriginalUrl=g,this.privContext=f}get redirectUrl(){return this.privRedirectUrl}get originalUrl(){return this.privOriginalUrl}get context(){return this.privContext}}return j.ConnectionRedirectEvent=p,j}var Ji={},te={},Xs;function $(){if(Xs)return te;Xs=1,Object.defineProperty(te,"__esModule",{value:!0}),te.ObjectDisposedError=te.InvalidOperationError=te.ArgumentNullError=void 0;class e extends Error{constructor(n){super(n),this.name="ArgumentNull",this.message=n}}te.ArgumentNullError=e;class t extends Error{constructor(n){super(n),this.name="InvalidOperation",this.message=n}}te.InvalidOperationError=t;class i extends Error{constructor(n,o){super(o),this.name=n+"ObjectDisposed",this.message=o}}return te.ObjectDisposedError=i,te}var Zs;function Rp(){return Zs||(Zs=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionMessage=e.MessageType=void 0;const t=$(),i=De();var u;(function(o){o[o.Text=0]="Text",o[o.Binary=1]="Binary"})(u=e.MessageType||(e.MessageType={}));class n{constructor(s,r,a,c){if(this.privBody=null,s===u.Text&&r&&typeof r!="string")throw new t.InvalidOperationError("Payload must be a string");if(s===u.Binary&&r&&!(r instanceof ArrayBuffer))throw new t.InvalidOperationError("Payload must be ArrayBuffer");switch(this.privMessageType=s,this.privBody=r,this.privHeaders=a||{},this.privId=c||(0,i.createNoDashGuid)(),this.messageType){case u.Binary:this.privSize=this.binaryBody!==null?this.binaryBody.byteLength:0;break;case u.Text:this.privSize=this.textBody.length}}get messageType(){return this.privMessageType}get headers(){return this.privHeaders}get body(){return this.privBody}get textBody(){if(this.privMessageType===u.Binary)throw new t.InvalidOperationError("Not supported for binary message");return this.privBody}get binaryBody(){if(this.privMessageType===u.Text)throw new t.InvalidOperationError("Not supported for text message");return this.privBody}get id(){return this.privId}}e.ConnectionMessage=n})(Ji)),Ji}var Ye={},Ys;function al(){if(Ys)return Ye;Ys=1,Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.ConnectionOpenResponse=void 0;let e=class{constructor(i,u){this.privStatusCode=i,this.privReason=u}get statusCode(){return this.privStatusCode}get reason(){return this.privReason}};return Ye.ConnectionOpenResponse=e,Ye}var $e={},$s;function cl(){if($s)return $e;$s=1,Object.defineProperty($e,"__esModule",{value:!0}),$e.DeferralMap=void 0;let e=class{constructor(){this.privMap={}}add(i,u){this.privMap[i]=u}getId(i){return this.privMap[i]}complete(i,u){try{this.privMap[i].resolve(u)}catch(n){this.privMap[i].reject(n)}finally{this.privMap[i]=void 0}}};return $e.DeferralMap=e,$e}var ge={},eo;function Pp(){if(eo)return ge;eo=1,Object.defineProperty(ge,"__esModule",{value:!0}),ge.SendingAgentContextMessageEvent=ge.DialogEvent=void 0;const e=Mi();class t extends e.PlatformEvent{constructor(n,o=e.EventType.Info){super(n,o)}}ge.DialogEvent=t;class i extends t{constructor(n){super("SendingAgentContextMessageEvent"),this.privAgentConfig=n}get agentConfig(){return this.privAgentConfig}}return ge.SendingAgentContextMessageEvent=i,ge}var et={},tt={},to;function Ep(){if(to)return tt;to=1,Object.defineProperty(tt,"__esModule",{value:!0}),tt.EventSource=void 0;const e=$(),t=De();let i=class{constructor(n){this.privEventListeners={},this.privIsDisposed=!1,this.privConsoleListener=void 0,this.privMetadata=n}onEvent(n){if(this.isDisposed())throw new e.ObjectDisposedError("EventSource");if(this.metadata)for(const o in this.metadata)o&&n.metadata&&(n.metadata[o]||(n.metadata[o]=this.metadata[o]));for(const o in this.privEventListeners)o&&this.privEventListeners[o]&&this.privEventListeners[o](n)}attach(n){const o=(0,t.createNoDashGuid)();return this.privEventListeners[o]=n,{detach:()=>(delete this.privEventListeners[o],Promise.resolve())}}attachListener(n){return this.attach(o=>n.onEvent(o))}attachConsoleListener(n){return this.privConsoleListener&&this.privConsoleListener.detach(),this.privConsoleListener=this.attach(o=>n.onEvent(o)),this.privConsoleListener}isDisposed(){return this.privIsDisposed}dispose(){this.privEventListeners=null,this.privIsDisposed=!0}get metadata(){return this.privMetadata}};return tt.EventSource=i,tt}var ro;function ul(){if(ro)return et;ro=1,Object.defineProperty(et,"__esModule",{value:!0}),et.Events=void 0;const e=$(),t=Ep();let i=class ps{static setEventSource(n){if(!n)throw new e.ArgumentNullError("eventSource");ps.privInstance=n}static get instance(){return ps.privInstance}};return et.Events=i,i.privInstance=new t.EventSource,et}var Gi={},io;function pl(){return io||(io=1,Object.defineProperty(Gi,"__esModule",{value:!0})),Gi}var Qi={},no;function dl(){return no||(no=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionState=void 0,(function(t){t[t.None=0]="None",t[t.Connected=1]="Connected",t[t.Connecting=2]="Connecting",t[t.Disconnected=3]="Disconnected"})(e.ConnectionState||(e.ConnectionState={}))})(Qi)),Qi}var Xi={},so;function hl(){return so||(so=1,Object.defineProperty(Xi,"__esModule",{value:!0})),Xi}var Zi={},oo;function ll(){return oo||(oo=1,Object.defineProperty(Zi,"__esModule",{value:!0})),Zi}var Yi={},ao;function vl(){return ao||(ao=1,Object.defineProperty(Yi,"__esModule",{value:!0})),Yi}var $i={},co;function fl(){return co||(co=1,Object.defineProperty($i,"__esModule",{value:!0})),$i}var en={},uo;function gl(){return uo||(uo=1,Object.defineProperty(en,"__esModule",{value:!0})),en}var tn={},po;function ml(){return po||(po=1,Object.defineProperty(tn,"__esModule",{value:!0})),tn}var rn={},ho;function Sl(){return ho||(ho=1,Object.defineProperty(rn,"__esModule",{value:!0})),rn}var nn={},lo;function Cl(){return lo||(lo=1,Object.defineProperty(nn,"__esModule",{value:!0})),nn}var rt={},vo;function Tp(){if(vo)return rt;vo=1,Object.defineProperty(rt,"__esModule",{value:!0}),rt.List=void 0;const e=$();let t=class Me{constructor(u){if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.privList=[],u)for(const n of u)this.privList.push(n)}get(u){return this.throwIfDisposed(),this.privList[u]}first(){return this.get(0)}last(){return this.get(this.length()-1)}add(u){this.throwIfDisposed(),this.insertAt(this.privList.length,u)}insertAt(u,n){this.throwIfDisposed(),u===0?this.privList.unshift(n):u===this.privList.length?this.privList.push(n):this.privList.splice(u,0,n),this.triggerSubscriptions(this.privAddSubscriptions)}removeFirst(){return this.throwIfDisposed(),this.removeAt(0)}removeLast(){return this.throwIfDisposed(),this.removeAt(this.length()-1)}removeAt(u){return this.throwIfDisposed(),this.remove(u,1)[0]}remove(u,n){this.throwIfDisposed();const o=this.privList.splice(u,n);return this.triggerSubscriptions(this.privRemoveSubscriptions),o}clear(){this.throwIfDisposed(),this.remove(0,this.length())}length(){return this.throwIfDisposed(),this.privList.length}onAdded(u){this.throwIfDisposed();const n=this.privSubscriptionIdCounter++;return this.privAddSubscriptions[n]=u,{detach:()=>(delete this.privAddSubscriptions[n],Promise.resolve())}}onRemoved(u){this.throwIfDisposed();const n=this.privSubscriptionIdCounter++;return this.privRemoveSubscriptions[n]=u,{detach:()=>(delete this.privRemoveSubscriptions[n],Promise.resolve())}}onDisposed(u){this.throwIfDisposed();const n=this.privSubscriptionIdCounter++;return this.privDisposedSubscriptions[n]=u,{detach:()=>(delete this.privDisposedSubscriptions[n],Promise.resolve())}}join(u){return this.throwIfDisposed(),this.privList.join(u)}toArray(){const u=Array();return this.privList.forEach(n=>{u.push(n)}),u}any(u){return this.throwIfDisposed(),u?this.where(u).length()>0:this.length()>0}all(u){return this.throwIfDisposed(),this.where(u).length()===this.length()}forEach(u){this.throwIfDisposed();for(let n=0;n<this.length();n++)u(this.privList[n],n)}select(u){this.throwIfDisposed();const n=[];for(let o=0;o<this.privList.length;o++)n.push(u(this.privList[o],o));return new Me(n)}where(u){this.throwIfDisposed();const n=new Me;for(let o=0;o<this.privList.length;o++)u(this.privList[o],o)&&n.add(this.privList[o]);return n}orderBy(u){this.throwIfDisposed();const o=this.toArray().sort(u);return new Me(o)}orderByDesc(u){return this.throwIfDisposed(),this.orderBy((n,o)=>u(o,n))}clone(){return this.throwIfDisposed(),new Me(this.toArray())}concat(u){return this.throwIfDisposed(),new Me(this.privList.concat(u.toArray()))}concatArray(u){return this.throwIfDisposed(),new Me(this.privList.concat(u))}isDisposed(){return this.privList==null}dispose(u){this.isDisposed()||(this.privDisposeReason=u,this.privList=null,this.privAddSubscriptions=null,this.privRemoveSubscriptions=null,this.triggerSubscriptions(this.privDisposedSubscriptions))}throwIfDisposed(){if(this.isDisposed())throw new e.ObjectDisposedError("List",this.privDisposeReason)}triggerSubscriptions(u){if(u)for(const n in u)n&&u[n]()}};return rt.List=t,rt}var sn={},fo;function Ap(){return fo||(fo=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.marshalPromiseToCallbacks=e.Sink=e.Deferred=e.PromiseResultEventSource=e.PromiseResult=e.PromiseState=void 0;var t;(function(r){r[r.None=0]="None",r[r.Resolved=1]="Resolved",r[r.Rejected=2]="Rejected"})(t=e.PromiseState||(e.PromiseState={}));class i{constructor(a){this.throwIfError=()=>{if(this.isError)throw this.error},a.on(c=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!1,this.privResult=c)},c=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!0,this.privError=c)})}get isCompleted(){return this.privIsCompleted}get isError(){return this.privIsError}get error(){return this.privError}get result(){return this.privResult}}e.PromiseResult=i;class u{constructor(){this.setResult=a=>{this.privOnSetResult(a)},this.setError=a=>{this.privOnSetError(a)},this.on=(a,c)=>{this.privOnSetResult=a,this.privOnSetError=c}}}e.PromiseResultEventSource=u;class n{constructor(){this.resolve=a=>(this.privResolve(a),this),this.reject=a=>(this.privReject(a),this),this.privPromise=new Promise((a,c)=>{this.privResolve=a,this.privReject=c})}get promise(){return this.privPromise}}e.Deferred=n;class o{constructor(){this.privState=t.None,this.privPromiseResult=null,this.privPromiseResultEvents=null,this.privSuccessHandlers=[],this.privErrorHandlers=[],this.privPromiseResultEvents=new u,this.privPromiseResult=new i(this.privPromiseResultEvents)}get state(){return this.privState}get result(){return this.privPromiseResult}resolve(a){if(this.privState!==t.None)throw new Error("'Cannot resolve a completed promise'");this.privState=t.Resolved,this.privPromiseResultEvents.setResult(a);for(let c=0;c<this.privSuccessHandlers.length;c++)this.executeSuccessCallback(a,this.privSuccessHandlers[c],this.privErrorHandlers[c]);this.detachHandlers()}reject(a){if(this.privState!==t.None)throw new Error("'Cannot reject a completed promise'");this.privState=t.Rejected,this.privPromiseResultEvents.setError(a);for(const c of this.privErrorHandlers)this.executeErrorCallback(a,c);this.detachHandlers()}on(a,c){a==null&&(a=()=>{}),this.privState===t.None?(this.privSuccessHandlers.push(a),this.privErrorHandlers.push(c)):(this.privState===t.Resolved?this.executeSuccessCallback(this.privPromiseResult.result,a,c):this.privState===t.Rejected&&this.executeErrorCallback(this.privPromiseResult.error,c),this.detachHandlers())}executeSuccessCallback(a,c,p){try{c(a)}catch(d){this.executeErrorCallback(`'Unhandled callback error: ${d}'`,p)}}executeErrorCallback(a,c){if(c)try{c(a)}catch(p){throw new Error(`'Unhandled callback error: ${p}. InnerError: ${a}'`)}else throw new Error(`'Unhandled error: ${a}'`)}detachHandlers(){this.privErrorHandlers=[],this.privSuccessHandlers=[]}}e.Sink=o;function s(r,a,c){r.then(p=>{try{a&&a(p)}catch(d){if(c)try{if(d instanceof Error){const l=d;c(l.name+": "+l.message)}else c(d)}catch{}}},p=>{if(c)try{if(p instanceof Error){const d=p;c(d.name+": "+d.message)}else c(p)}catch{}})}e.marshalPromiseToCallbacks=s})(sn)),sn}var it={},go;function Ip(){if(go)return it;go=1,Object.defineProperty(it,"__esModule",{value:!0}),it.Queue=void 0;const e=$(),t=Tp(),i=Ap();var u;(function(o){o[o.Dequeue=0]="Dequeue",o[o.Peek=1]="Peek"})(u||(u={}));let n=class{constructor(s){this.privPromiseStore=new t.List,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.privList=s||new t.List,this.privDetachables=[],this.privSubscribers=new t.List,this.privDetachables.push(this.privList.onAdded(()=>this.drain()))}enqueue(s){this.throwIfDispose(),this.enqueueFromPromise(new Promise(r=>r(s)))}enqueueFromPromise(s){this.throwIfDispose(),s.then(r=>{this.privList.add(r)},()=>{})}dequeue(){this.throwIfDispose();const s=new i.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:s,type:u.Dequeue}),this.drain()),s.promise}peek(){this.throwIfDispose();const s=new i.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:s,type:u.Peek}),this.drain()),s.promise}length(){return this.throwIfDispose(),this.privList.length()}isDisposed(){return this.privSubscribers==null}async drainAndDispose(s,r){if(!this.isDisposed()&&!this.privIsDisposing){this.privDisposeReason=r,this.privIsDisposing=!0;const a=this.privSubscribers;if(a){for(;a.length()>0;)a.removeFirst().deferral.resolve(void 0);this.privSubscribers===a&&(this.privSubscribers=a)}for(const c of this.privDetachables)await c.detach();if(this.privPromiseStore.length()>0&&s){const c=[];return this.privPromiseStore.toArray().forEach(p=>{c.push(p)}),Promise.all(c).finally(()=>{this.privSubscribers=null,this.privList.forEach(p=>{s(p)}),this.privList=null}).then()}else this.privSubscribers=null,this.privList=null}}async dispose(s){await this.drainAndDispose(null,s)}drain(){if(!this.privIsDrainInProgress&&!this.privIsDisposing){this.privIsDrainInProgress=!0;const s=this.privSubscribers,r=this.privList;if(s&&r){for(;r.length()>0&&s.length()>0&&!this.privIsDisposing;){const a=s.removeFirst();if(a.type===u.Peek)a.deferral.resolve(r.first());else{const c=r.removeFirst();a.deferral.resolve(c)}}this.privSubscribers===s&&(this.privSubscribers=s),this.privList===r&&(this.privList=r)}this.privIsDrainInProgress=!1}}throwIfDispose(){if(this.isDisposed())throw this.privDisposeReason?new e.InvalidOperationError(this.privDisposeReason):new e.ObjectDisposedError("Queue");if(this.privIsDisposing)throw new e.InvalidOperationError("Queue disposing")}};return it.Queue=n,it}var nt={},mo;function yl(){if(mo)return nt;mo=1,Object.defineProperty(nt,"__esModule",{value:!0}),nt.RawWebsocketMessage=void 0;const e=Rp(),t=$(),i=De();let u=class{constructor(o,s,r){if(this.privPayload=null,!s)throw new t.ArgumentNullError("payload");if(o===e.MessageType.Binary&&Object.getPrototypeOf(s).constructor.name!=="ArrayBuffer")throw new t.InvalidOperationError("Payload must be ArrayBuffer");if(o===e.MessageType.Text&&typeof s!="string")throw new t.InvalidOperationError("Payload must be a string");this.privMessageType=o,this.privPayload=s,this.privId=r||(0,i.createNoDashGuid)()}get messageType(){return this.privMessageType}get payload(){return this.privPayload}get textContent(){if(this.privMessageType===e.MessageType.Binary)throw new t.InvalidOperationError("Not supported for binary message");return this.privPayload}get binaryContent(){if(this.privMessageType===e.MessageType.Text)throw new t.InvalidOperationError("Not supported for text message");return this.privPayload}get id(){return this.privId}};return nt.RawWebsocketMessage=u,nt}var st={},So;function Rl(){if(So)return st;So=1,Object.defineProperty(st,"__esModule",{value:!0}),st.RiffPcmEncoder=void 0;let e=class{constructor(i,u){this.privActualSampleRate=i,this.privDesiredSampleRate=u}encode(i){const u=this.downSampleAudioFrame(i,this.privActualSampleRate,this.privDesiredSampleRate);if(!u)return null;const n=u.length*2,o=new ArrayBuffer(n),s=new DataView(o);return this.floatTo16BitPCM(s,0,u),o}setString(i,u,n){for(let o=0;o<n.length;o++)i.setUint8(u+o,n.charCodeAt(o))}floatTo16BitPCM(i,u,n){for(let o=0;o<n.length;o++,u+=2){const s=Math.max(-1,Math.min(1,n[o]));i.setInt16(u,s<0?s*32768:s*32767,!0)}}downSampleAudioFrame(i,u,n){if(!i)return null;if(n===u||n>u)return i;const o=u/n,s=Math.round(i.length/o),r=new Float32Array(s);let a=0,c=0;for(;c<s;){const p=Math.round((c+1)*o);let d=0,l=0;for(;a<p&&a<i.length;)d+=i[a++],l++;r[c++]=d/l}return r}};return st.RiffPcmEncoder=e,st}var ot={},Co;function Pl(){if(Co)return ot;Co=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.Stream=void 0;const e=$(),t=De(),i=Ip();let u=class{constructor(o){this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.privId=o||(0,t.createNoDashGuid)(),this.privReaderQueue=new i.Queue}get isClosed(){return this.privIsWriteEnded}get isReadEnded(){return this.privIsReadEnded}get id(){return this.privId}close(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)}writeStreamChunk(o){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(o)}catch{}}read(){if(this.privIsReadEnded)throw new e.InvalidOperationError("Stream read has already finished");return this.privReaderQueue.dequeue().then(async o=>((o===void 0||o.isEnd)&&await this.privReaderQueue.dispose("End of stream reached"),o))}readEnded(){this.privIsReadEnded||(this.privIsReadEnded=!0,this.privReaderQueue=new i.Queue)}throwIfClosed(){if(this.privIsWriteEnded)throw new e.InvalidOperationError("Stream closed")}};return ot.Stream=u,ot}var on={},yo;function Cs(){return yo||(yo=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TranslationStatus=void 0,(function(t){t[t.Success=0]="Success",t[t.Error=1]="Error"})(e.TranslationStatus||(e.TranslationStatus={}))})(on)),on}var at={},Ro;function El(){if(Ro)return at;Ro=1,Object.defineProperty(at,"__esModule",{value:!0}),at.ChunkedArrayBufferStream=void 0;const e=b();let t=class extends e.Stream{constructor(u,n){super(n),this.privTargetChunkSize=Math.round(u),this.privNextBufferReadyBytes=0}writeStreamChunk(u){if(u.isEnd||this.privNextBufferReadyBytes===0&&u.buffer.byteLength===this.privTargetChunkSize){super.writeStreamChunk(u);return}let n=0;for(;n<u.buffer.byteLength;){this.privNextBufferToWrite===void 0&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=u.timeReceived);const o=Math.min(u.buffer.byteLength-n,this.privTargetChunkSize-this.privNextBufferReadyBytes),s=new Uint8Array(this.privNextBufferToWrite),r=new Uint8Array(u.buffer.slice(n,o+n));s.set(r,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=o,n+=o,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(super.writeStreamChunk({buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}}close(){this.privNextBufferReadyBytes!==0&&!this.isClosed&&super.writeStreamChunk({buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),super.close()}};return at.ChunkedArrayBufferStream=t,at}var an={},Po;function Tl(){return Po||(Po=1,Object.defineProperty(an,"__esModule",{value:!0})),an}var ct={},Eo;function Al(){if(Eo)return ct;Eo=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.Timeout=void 0;let e=class ae{static load(){const i=new Map([[0,()=>{}]]),u=new Map,o="data:text/javascript;base64,"+btoa(`!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error('There is no interval scheduled with the given id "'.concat(e,'".'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error('The given method "'.concat(e.method,'" is not supported'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);`),s=new Worker(o);return s.addEventListener("message",({data:c})=>{if(ae.isCallNotification(c)){const{params:{timerId:p}}=c,d=i.get(p);if(typeof d=="number"){const l=u.get(d);if(l===void 0||l!==p)throw new Error("The timer is in an undefined state.")}else if(typeof d<"u")d(),i.delete(p);else throw new Error("The timer is in an undefined state.")}else if(ae.isClearResponse(c)){const{id:p}=c,d=u.get(p);if(d===void 0)throw new Error("The timer is in an undefined state.");u.delete(p),i.delete(d)}else{const{error:{message:p}}=c;throw new Error(p)}}),{clearTimeout:c=>{const p=Math.random();u.set(p,c),i.set(c,p),s.postMessage({id:p,method:"clear",params:{timerId:c}})},setTimeout:(c,p)=>{const d=Math.random();return i.set(d,c),s.postMessage({id:null,method:"set",params:{delay:p,now:performance.now(),timerId:d}}),d}}}static loadWorkerTimers(){return()=>(ae.workerTimers!==null||(ae.workerTimers=ae.load()),ae.workerTimers)}static isCallNotification(i){return i.method!==void 0&&i.method==="call"}static isClearResponse(i){return i.error===null&&typeof i.id=="number"}};return ct.Timeout=e,e.workerTimers=null,e.clearTimeout=t=>e.timers().clearTimeout(t),e.setTimeout=(t,i)=>e.timers().setTimeout(t,i),e.timers=e.loadWorkerTimers(),ct}var O={},To;function Il(){if(To)return O;To=1,Object.defineProperty(O,"__esModule",{value:!0}),O.OCSPCacheUpdateErrorEvent=O.OCSPResponseRetrievedEvent=O.OCSPCacheFetchErrorEvent=O.OCSPVerificationFailedEvent=O.OCSPCacheHitEvent=O.OCSPCacheEntryNeedsRefreshEvent=O.OCSPCacheEntryExpiredEvent=O.OCSPWSUpgradeStartedEvent=O.OCSPStapleReceivedEvent=O.OCSPCacheUpdateCompleteEvent=O.OCSPDiskCacheStoreEvent=O.OCSPMemoryCacheStoreEvent=O.OCSPCacheUpdateNeededEvent=O.OCSPDiskCacheHitEvent=O.OCSPCacheMissEvent=O.OCSPMemoryCacheHitEvent=O.OCSPEvent=void 0;const e=Mi();class t extends e.PlatformEvent{constructor(C,y,R){super(C,y),this.privSignature=R}}O.OCSPEvent=t;class i extends t{constructor(C){super("OCSPMemoryCacheHitEvent",e.EventType.Debug,C)}}O.OCSPMemoryCacheHitEvent=i;class u extends t{constructor(C){super("OCSPCacheMissEvent",e.EventType.Debug,C)}}O.OCSPCacheMissEvent=u;class n extends t{constructor(C){super("OCSPDiskCacheHitEvent",e.EventType.Debug,C)}}O.OCSPDiskCacheHitEvent=n;class o extends t{constructor(C){super("OCSPCacheUpdateNeededEvent",e.EventType.Debug,C)}}O.OCSPCacheUpdateNeededEvent=o;class s extends t{constructor(C){super("OCSPMemoryCacheStoreEvent",e.EventType.Debug,C)}}O.OCSPMemoryCacheStoreEvent=s;class r extends t{constructor(C){super("OCSPDiskCacheStoreEvent",e.EventType.Debug,C)}}O.OCSPDiskCacheStoreEvent=r;class a extends t{constructor(C){super("OCSPCacheUpdateCompleteEvent",e.EventType.Debug,C)}}O.OCSPCacheUpdateCompleteEvent=a;class c extends t{constructor(){super("OCSPStapleReceivedEvent",e.EventType.Debug,"")}}O.OCSPStapleReceivedEvent=c;class p extends t{constructor(C){super("OCSPWSUpgradeStartedEvent",e.EventType.Debug,C)}}O.OCSPWSUpgradeStartedEvent=p;class d extends t{constructor(C,y){super("OCSPCacheEntryExpiredEvent",e.EventType.Debug,C),this.privExpireTime=y}}O.OCSPCacheEntryExpiredEvent=d;class l extends t{constructor(C,y,R){super("OCSPCacheEntryNeedsRefreshEvent",e.EventType.Debug,C),this.privExpireTime=R,this.privStartTime=y}}O.OCSPCacheEntryNeedsRefreshEvent=l;class h extends t{constructor(C,y,R){super("OCSPCacheHitEvent",e.EventType.Debug,C),this.privExpireTime=R,this.privExpireTimeString=new Date(R).toLocaleDateString(),this.privStartTime=y,this.privStartTimeString=new Date(y).toLocaleTimeString()}}O.OCSPCacheHitEvent=h;class g extends t{constructor(C,y){super("OCSPVerificationFailedEvent",e.EventType.Debug,C),this.privError=y}}O.OCSPVerificationFailedEvent=g;class f extends t{constructor(C,y){super("OCSPCacheFetchErrorEvent",e.EventType.Debug,C),this.privError=y}}O.OCSPCacheFetchErrorEvent=f;class m extends t{constructor(C){super("OCSPResponseRetrievedEvent",e.EventType.Debug,C)}}O.OCSPResponseRetrievedEvent=m;class v extends t{constructor(C,y){super("OCSPCacheUpdateErrorEvent",e.EventType.Debug,C),this.privError=y}}return O.OCSPCacheUpdateErrorEvent=v,O}var ut={},Ao;function wl(){if(Ao)return ut;Ao=1,Object.defineProperty(ut,"__esModule",{value:!0}),ut.BackgroundEvent=void 0;const e=b();class t extends e.PlatformEvent{constructor(u){super("BackgroundEvent",e.EventType.Error),this.privError=u}get error(){return this.privError}}return ut.BackgroundEvent=t,ut}var Io;function b(){return Io||(Io=1,(function(e){var t=ve&&ve.__createBinding||(Object.create?(function(n,o,s,r){r===void 0&&(r=s),Object.defineProperty(n,r,{enumerable:!0,get:function(){return o[s]}})}):(function(n,o,s,r){r===void 0&&(r=s),n[r]=o[s]})),i=ve&&ve.__exportStar||function(n,o){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(o,s)&&t(o,n,s)};Object.defineProperty(e,"__esModule",{value:!0}),e.TranslationStatus=void 0,i(sl(),e),i(ol(),e),i(Rp(),e),i(al(),e),i(cl(),e),i(Pp(),e),i($(),e),i(ul(),e),i(Ep(),e),i(De(),e),i(pl(),e),i(dl(),e),i(hl(),e),i(ll(),e),i(vl(),e),i(fl(),e),i(gl(),e),i(ml(),e),i(Sl(),e),i(Cl(),e),i(Tp(),e),i(Mi(),e),i(Ap(),e),i(Ip(),e),i(yl(),e),i(Rl(),e),i(Pl(),e);var u=Cs();Object.defineProperty(e,"TranslationStatus",{enumerable:!0,get:function(){return u.TranslationStatus}}),i(El(),e),i(Tl(),e),i(Al(),e),i(Il(),e),i(wl(),e)})(ve)),ve}var pt={},wo;function V(){if(wo)return pt;wo=1,Object.defineProperty(pt,"__esModule",{value:!0}),pt.HeaderNames=void 0;let e=class{};return pt.HeaderNames=e,e.AuthKey="Ocp-Apim-Subscription-Key",e.Authorization="Authorization",e.SpIDAuthKey="Apim-Subscription-Id",e.ConnectionId="X-ConnectionId",e.ContentType="Content-Type",e.CustomCommandsAppId="X-CommandsAppId",e.Path="Path",e.RequestId="X-RequestId",e.RequestStreamId="X-StreamId",e.RequestTimestamp="X-Timestamp",pt}var dt={},_o;function ys(){if(_o)return dt;_o=1,Object.defineProperty(dt,"__esModule",{value:!0}),dt.AuthInfo=void 0;class e{constructor(i,u){this.privHeaderName=i,this.privToken=u}get headerName(){return this.privHeaderName}get token(){return this.privToken}}return dt.AuthInfo=e,dt}var bo;function _l(){if(bo)return Be;bo=1,Object.defineProperty(Be,"__esModule",{value:!0}),Be.CognitiveSubscriptionKeyAuthentication=void 0;const e=b(),t=V(),i=ys();let u=class{constructor(o){if(!o)throw new e.ArgumentNullError("subscriptionKey");this.privAuthInfo=new i.AuthInfo(t.HeaderNames.AuthKey,o)}fetch(o){return Promise.resolve(this.privAuthInfo)}fetchOnExpiry(o){return Promise.resolve(this.privAuthInfo)}};return Be.CognitiveSubscriptionKeyAuthentication=u,Be}var ht={},Mo;function bl(){if(Mo)return ht;Mo=1,Object.defineProperty(ht,"__esModule",{value:!0}),ht.CognitiveTokenAuthentication=void 0;const e=b(),t=ys(),i=V();let u=class ds{constructor(o,s){if(!o)throw new e.ArgumentNullError("fetchCallback");if(!s)throw new e.ArgumentNullError("fetchOnExpiryCallback");this.privFetchCallback=o,this.privFetchOnExpiryCallback=s}fetch(o){return this.privFetchCallback(o).then(s=>new t.AuthInfo(i.HeaderNames.Authorization,s===void 0?void 0:ds.privTokenPrefix+s))}fetchOnExpiry(o){return this.privFetchOnExpiryCallback(o).then(s=>new t.AuthInfo(i.HeaderNames.Authorization,s===void 0?void 0:ds.privTokenPrefix+s))}};return ht.CognitiveTokenAuthentication=u,u.privTokenPrefix="Bearer ",ht}var cn={},Oo;function Ml(){return Oo||(Oo=1,Object.defineProperty(cn,"__esModule",{value:!0})),cn}var un={},Do;function Ol(){return Do||(Do=1,Object.defineProperty(un,"__esModule",{value:!0})),un}var pn={},ko;function Rs(){return ko||(ko=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.RecognitionEndedEvent=e.RecognitionCompletionStatus=e.RecognitionStartedEvent=e.ConnectingToServiceEvent=e.ListeningStartedEvent=e.RecognitionTriggeredEvent=e.SpeechRecognitionEvent=void 0;const t=b();class i extends t.PlatformEvent{constructor(p,d,l,h=t.EventType.Info){super(p,h),this.privRequestId=d,this.privSessionId=l}get requestId(){return this.privRequestId}get sessionId(){return this.privSessionId}}e.SpeechRecognitionEvent=i;class u extends i{constructor(p,d,l,h){super("RecognitionTriggeredEvent",p,d),this.privAudioSourceId=l,this.privAudioNodeId=h}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}e.RecognitionTriggeredEvent=u;class n extends i{constructor(p,d,l,h){super("ListeningStartedEvent",p,d),this.privAudioSourceId=l,this.privAudioNodeId=h}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}e.ListeningStartedEvent=n;class o extends i{constructor(p,d,l){super("ConnectingToServiceEvent",p,l),this.privAuthFetchEventid=d}get authFetchEventid(){return this.privAuthFetchEventid}}e.ConnectingToServiceEvent=o;class s extends i{constructor(p,d,l,h,g){super("RecognitionStartedEvent",p,g),this.privAudioSourceId=d,this.privAudioNodeId=l,this.privAuthFetchEventId=h}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}}e.RecognitionStartedEvent=s;var r;(function(c){c[c.Success=0]="Success",c[c.AudioSourceError=1]="AudioSourceError",c[c.AudioSourceTimeout=2]="AudioSourceTimeout",c[c.AuthTokenFetchError=3]="AuthTokenFetchError",c[c.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",c[c.UnAuthorized=5]="UnAuthorized",c[c.ConnectTimeout=6]="ConnectTimeout",c[c.ConnectError=7]="ConnectError",c[c.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",c[c.UnknownError=9]="UnknownError"})(r=e.RecognitionCompletionStatus||(e.RecognitionCompletionStatus={}));class a extends i{constructor(p,d,l,h,g,f,m,v){super("RecognitionEndedEvent",p,g,m===r.Success?t.EventType.Info:t.EventType.Error),this.privAudioSourceId=d,this.privAudioNodeId=l,this.privAuthFetchEventId=h,this.privStatus=m,this.privError=v,this.privServiceTag=f}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}get serviceTag(){return this.privServiceTag}get status(){return this.privStatus}get error(){return this.privError}}e.RecognitionEndedEvent=a})(pn)),pn}var lt={},me={},G={};const Dl={},kl=Object.freeze(Object.defineProperty({__proto__:null,default:Dl},Symbol.toStringTag,{value:"Module"})),Oe=Jh(kl);var dn={},No;function wp(){return No||(No=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LogLevel=void 0;const t=b();Object.defineProperty(e,"LogLevel",{enumerable:!0,get:function(){return t.EventType}})})(dn)),dn}var vt={},zo;function D(){if(zo)return vt;zo=1,Object.defineProperty(vt,"__esModule",{value:!0}),vt.Contracts=void 0;let e=class ce{static throwIfNullOrUndefined(i,u){if(i==null)throw new Error("throwIfNullOrUndefined:"+u)}static throwIfNull(i,u){if(i===null)throw new Error("throwIfNull:"+u)}static throwIfNullOrWhitespace(i,u){if(ce.throwIfNullOrUndefined(i,u),(""+i).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+u)}static throwIfNullOrTooLong(i,u,n){if(ce.throwIfNullOrUndefined(i,u),(""+i).length>n)throw new Error("throwIfNullOrTooLong:"+u+" (more than "+n.toString()+" characters)")}static throwIfNullOrTooShort(i,u,n){if(ce.throwIfNullOrUndefined(i,u),(""+i).length<n)throw new Error("throwIfNullOrTooShort:"+u+" (less than "+n.toString()+" characters)")}static throwIfDisposed(i){if(i)throw new Error("the object is already disposed")}static throwIfArrayEmptyOrWhitespace(i,u){if(ce.throwIfNullOrUndefined(i,u),i.length===0)throw new Error("throwIfArrayEmptyOrWhitespace:"+u);for(const n of i)ce.throwIfNullOrWhitespace(n,u)}static throwIfFileDoesNotExist(i,u){ce.throwIfNullOrWhitespace(i,u)}static throwIfNotUndefined(i,u){if(i!==void 0)throw new Error("throwIfNotUndefined:"+u)}static throwIfNumberOutOfRange(i,u,n,o){if(ce.throwIfNullOrUndefined(i,u),i<n||i>o)throw new Error("throwIfNumberOutOfRange:"+u+" (must be between "+n.toString()+" and "+o.toString()+")")}};return vt.Contracts=e,vt}var jo;function Nl(){if(jo)return G;jo=1;var e=G&&G.__createBinding||(Object.create?(function(r,a,c,p){p===void 0&&(p=c),Object.defineProperty(r,p,{enumerable:!0,get:function(){return a[c]}})}):(function(r,a,c,p){p===void 0&&(p=c),r[p]=a[c]})),t=G&&G.__setModuleDefault||(Object.create?(function(r,a){Object.defineProperty(r,"default",{enumerable:!0,value:a})}):function(r,a){r.default=a}),i=G&&G.__importStar||function(r){if(r&&r.__esModule)return r;var a={};if(r!=null)for(var c in r)c!=="default"&&Object.prototype.hasOwnProperty.call(r,c)&&e(a,r,c);return t(a,r),a};Object.defineProperty(G,"__esModule",{value:!0}),G.ConsoleLoggingListener=void 0;const u=i(Oe),n=wp(),o=D();let s=class{constructor(a=n.LogLevel.None){this.privLogPath=void 0,this.privEnableConsoleOutput=!0,this.privLogLevelFilter=a}set logPath(a){o.Contracts.throwIfNullOrUndefined(u.openSync,`
File System access not available`),this.privLogPath=a}set enableConsoleOutput(a){this.privEnableConsoleOutput=a}onEvent(a){if(a.eventType>=this.privLogLevelFilter){const c=this.toString(a);if(this.logCallback&&this.logCallback(c),this.privLogPath&&u.writeFileSync(this.privLogPath,c+`
`,{flag:"a+"}),this.privEnableConsoleOutput)switch(a.eventType){case n.LogLevel.Debug:console.debug(c);break;case n.LogLevel.Info:console.info(c);break;case n.LogLevel.Warning:console.warn(c);break;case n.LogLevel.Error:console.error(c);break;default:console.log(c);break}}}toString(a){const c=[`${a.eventTime}`,`${a.name}`],p=a;for(const d in p)if(d&&a.hasOwnProperty(d)&&d!=="eventTime"&&d!=="eventType"&&d!=="eventId"&&d!=="name"&&d!=="constructor"){const l=p[d];let h="<NULL>";l!=null&&(typeof l=="number"||typeof l=="string"?h=l.toString():h=JSON.stringify(l)),c.push(`${d}: ${h}`)}return c.join(" | ")}};return G.ConsoleLoggingListener=s,G}var hn={},Lo;function zl(){return Lo||(Lo=1,Object.defineProperty(hn,"__esModule",{value:!0})),hn}var ln={},vn={},qo;function ke(){return qo||(qo=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.AudioStreamFormatImpl=e.AudioStreamFormat=e.AudioFormatTag=void 0;var t;(function(n){n[n.PCM=1]="PCM",n[n.MuLaw=2]="MuLaw",n[n.Siren=3]="Siren",n[n.MP3=4]="MP3",n[n.SILKSkype=5]="SILKSkype",n[n.OGG_OPUS=6]="OGG_OPUS",n[n.WEBM_OPUS=7]="WEBM_OPUS",n[n.ALaw=8]="ALaw",n[n.FLAC=9]="FLAC",n[n.OPUS=10]="OPUS",n[n.AMR_WB=11]="AMR_WB",n[n.G722=12]="G722"})(t=e.AudioFormatTag||(e.AudioFormatTag={}));class i{static getDefaultInputFormat(){return u.getDefaultInputFormat()}static getWaveFormat(o,s,r,a){return new u(o,s,r,a)}static getWaveFormatPCM(o,s,r){return new u(o,s,r)}}e.AudioStreamFormat=i;class u extends i{constructor(o=16e3,s=16,r=1,a=t.PCM){super();let c=!0;switch(a){case t.PCM:this.formatTag=1;break;case t.ALaw:this.formatTag=6;break;case t.MuLaw:this.formatTag=7;break;default:c=!1}if(this.bitsPerSample=s,this.samplesPerSec=o,this.channels=r,this.avgBytesPerSec=this.samplesPerSec*this.channels*(this.bitsPerSample/8),this.blockAlign=this.channels*Math.max(this.bitsPerSample,8),c){this.privHeader=new ArrayBuffer(44);const p=new DataView(this.privHeader);this.setString(p,0,"RIFF"),p.setUint32(4,0,!0),this.setString(p,8,"WAVEfmt "),p.setUint32(16,16,!0),p.setUint16(20,this.formatTag,!0),p.setUint16(22,this.channels,!0),p.setUint32(24,this.samplesPerSec,!0),p.setUint32(28,this.avgBytesPerSec,!0),p.setUint16(32,this.channels*(this.bitsPerSample/8),!0),p.setUint16(34,this.bitsPerSample,!0),this.setString(p,36,"data"),p.setUint32(40,0,!0)}}static getDefaultInputFormat(){return new u}static getAudioContext(o){const s=window.AudioContext||window.webkitAudioContext||!1;if(s)return o!==void 0&&navigator.mediaDevices.getSupportedConstraints().sampleRate?new s({sampleRate:o}):new s;throw new Error("Browser does not support Web Audio API (AudioContext is not available).")}close(){}get header(){return this.privHeader}setString(o,s,r){for(let a=0;a<r.length;a++)o.setUint8(s+a,r.charCodeAt(a))}}e.AudioStreamFormatImpl=u})(vn)),vn}var Bo;function jl(){return Bo||(Bo=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.MicAudioSource=e.AudioWorkletSourceURLPropertyName=void 0;const t=w(),i=b(),u=ke();e.AudioWorkletSourceURLPropertyName="MICROPHONE-WorkletSourceUrl";class n{constructor(s,r,a,c){this.privRecorder=s,this.deviceId=r,this.privStreams={},this.privOutputChunkSize=n.AUDIOFORMAT.avgBytesPerSec/10,this.privId=a||(0,i.createNoDashGuid)(),this.privEvents=new i.EventSource,this.privMediaStream=c||null,this.privIsClosing=!1}get format(){return Promise.resolve(n.AUDIOFORMAT)}turnOn(){if(this.privInitializeDeferral)return this.privInitializeDeferral.promise;this.privInitializeDeferral=new i.Deferred;try{this.createAudioContext()}catch(a){if(a instanceof Error){const c=a;this.privInitializeDeferral.reject(c.name+": "+c.message)}else this.privInitializeDeferral.reject(a);return this.privInitializeDeferral.promise}const s=window.navigator;let r=s.getUserMedia||s.webkitGetUserMedia||s.mozGetUserMedia||s.msGetUserMedia;if(s.mediaDevices&&(r=(a,c,p)=>{s.mediaDevices.getUserMedia(a).then(c).catch(p)}),r){const a=()=>{this.onEvent(new i.AudioSourceInitializingEvent(this.privId)),this.privMediaStream&&this.privMediaStream.active?(this.onEvent(new i.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()):r({audio:this.deviceId?{deviceId:this.deviceId}:!0,video:!1},c=>{this.privMediaStream=c,this.onEvent(new i.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()},c=>{const p=`Error occurred during microphone initialization: ${c}`;this.privInitializeDeferral.reject(p),this.onEvent(new i.AudioSourceErrorEvent(this.privId,p))})};this.privContext.state==="suspended"?this.privContext.resume().then(a).catch(c=>{this.privInitializeDeferral.reject(`Failed to initialize audio context: ${c}`)}):a()}else{const a="Browser does not support getUserMedia.";this.privInitializeDeferral.reject(a),this.onEvent(new i.AudioSourceErrorEvent(a,""))}return this.privInitializeDeferral.promise}id(){return this.privId}attach(s){return this.onEvent(new i.AudioStreamNodeAttachingEvent(this.privId,s)),this.listen(s).then(r=>(this.onEvent(new i.AudioStreamNodeAttachedEvent(this.privId,s)),{detach:async()=>(r.readEnded(),delete this.privStreams[s],this.onEvent(new i.AudioStreamNodeDetachedEvent(this.privId,s)),this.turnOff()),id:()=>s,read:()=>r.read()}))}detach(s){s&&this.privStreams[s]&&(this.privStreams[s].close(),delete this.privStreams[s],this.onEvent(new i.AudioStreamNodeDetachedEvent(this.privId,s)))}async turnOff(){for(const s in this.privStreams)if(s){const r=this.privStreams[s];r&&r.close()}this.onEvent(new i.AudioSourceOffEvent(this.privId)),this.privInitializeDeferral&&(await this.privInitializeDeferral,this.privInitializeDeferral=null),await this.destroyAudioContext()}get events(){return this.privEvents}get deviceInfo(){return this.getMicrophoneLabel().then(s=>({bitspersample:n.AUDIOFORMAT.bitsPerSample,channelcount:n.AUDIOFORMAT.channels,connectivity:t.connectivity.Unknown,manufacturer:"Speech SDK",model:s,samplerate:n.AUDIOFORMAT.samplesPerSec,type:t.type.Microphones}))}setProperty(s,r){if(s===e.AudioWorkletSourceURLPropertyName)this.privRecorder.setWorkletUrl(r);else throw new Error("Property '"+s+"' is not supported on Microphone.")}getMicrophoneLabel(){const s="microphone";if(this.privMicrophoneLabel!==void 0)return Promise.resolve(this.privMicrophoneLabel);if(this.privMediaStream===void 0||!this.privMediaStream.active)return Promise.resolve(s);this.privMicrophoneLabel=s;const r=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(r===void 0)return Promise.resolve(this.privMicrophoneLabel);const a=new i.Deferred;return navigator.mediaDevices.enumerateDevices().then(c=>{for(const p of c)if(p.deviceId===r){this.privMicrophoneLabel=p.label;break}a.resolve(this.privMicrophoneLabel)},()=>a.resolve(this.privMicrophoneLabel)),a.promise}async listen(s){await this.turnOn();const r=new i.ChunkedArrayBufferStream(this.privOutputChunkSize,s);this.privStreams[s]=r;try{this.privRecorder.record(this.privContext,this.privMediaStream,r)}catch(c){throw this.onEvent(new i.AudioStreamNodeErrorEvent(this.privId,s,c)),c}return r}onEvent(s){this.privEvents.onEvent(s),i.Events.instance.onEvent(s)}createAudioContext(){this.privContext||(this.privContext=u.AudioStreamFormatImpl.getAudioContext(n.AUDIOFORMAT.samplesPerSec))}async destroyAudioContext(){if(!this.privContext)return;this.privRecorder.releaseMediaResources(this.privContext);let s=!1;"close"in this.privContext&&(s=!0),s?this.privIsClosing||(this.privIsClosing=!0,await this.privContext.close(),this.privContext=null,this.privIsClosing=!1):this.privContext!==null&&this.privContext.state==="running"&&await this.privContext.suspend()}}e.MicAudioSource=n,n.AUDIOFORMAT=u.AudioStreamFormat.getDefaultInputFormat()})(ln)),ln}var ft={},Fo;function Ll(){if(Fo)return ft;Fo=1,Object.defineProperty(ft,"__esModule",{value:!0}),ft.FileAudioSource=void 0;const e=w(),t=b(),i=ke();let u=class{constructor(o,s,r){this.privStreams={},this.privHeaderEnd=44,this.privId=r||(0,t.createNoDashGuid)(),this.privEvents=new t.EventSource,this.privSource=o,typeof window<"u"&&typeof Blob<"u"&&this.privSource instanceof Blob?this.privFilename=o.name:this.privFilename=s||"unknown.wav",this.privAudioFormatPromise=this.readHeader()}get format(){return this.privAudioFormatPromise}turnOn(){if(this.privFilename.lastIndexOf(".wav")!==this.privFilename.length-4){const o=this.privFilename+" is not supported. Only WAVE files are allowed at the moment.";return this.onEvent(new t.AudioSourceErrorEvent(o,"")),Promise.reject(o)}this.onEvent(new t.AudioSourceInitializingEvent(this.privId)),this.onEvent(new t.AudioSourceReadyEvent(this.privId))}id(){return this.privId}async attach(o){this.onEvent(new t.AudioStreamNodeAttachingEvent(this.privId,o));const s=await this.upload(o);return this.onEvent(new t.AudioStreamNodeAttachedEvent(this.privId,o)),Promise.resolve({detach:async()=>{s.readEnded(),delete this.privStreams[o],this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,o)),await this.turnOff()},id:()=>o,read:()=>s.read()})}detach(o){o&&this.privStreams[o]&&(this.privStreams[o].close(),delete this.privStreams[o],this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,o)))}turnOff(){for(const o in this.privStreams)if(o){const s=this.privStreams[o];s&&!s.isClosed&&s.close()}return this.onEvent(new t.AudioSourceOffEvent(this.privId)),Promise.resolve()}get events(){return this.privEvents}get deviceInfo(){return this.privAudioFormatPromise.then(o=>Promise.resolve({bitspersample:o.bitsPerSample,channelcount:o.channels,connectivity:e.connectivity.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:o.samplesPerSec,type:e.type.File}))}readHeader(){const s=this.privSource.slice(0,4296),r=new t.Deferred,a=c=>{const p=new DataView(c),d=v=>String.fromCharCode(p.getUint8(v),p.getUint8(v+1),p.getUint8(v+2),p.getUint8(v+3));if(d(0)!=="RIFF"){r.reject("Invalid WAV header in file, RIFF was not found");return}if(d(8)!=="WAVE"||d(12)!=="fmt "){r.reject("Invalid WAV header in file, WAVEfmt was not found");return}const l=p.getInt32(16,!0),h=p.getUint16(22,!0),g=p.getUint32(24,!0),f=p.getUint16(34,!0);let m=36+Math.max(l-16,0);for(;d(m)!=="data";m+=2)if(m>4288){r.reject("Invalid WAV header in file, data block was not found");return}this.privHeaderEnd=m+8,r.resolve(i.AudioStreamFormat.getWaveFormatPCM(g,f,h))};if(typeof window<"u"&&typeof Blob<"u"&&s instanceof Blob){const c=new FileReader;c.onload=p=>{const d=p.target.result;a(d)},c.readAsArrayBuffer(s)}else{const c=s;a(c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength))}return r.promise}async upload(o){const s=r=>{const a=`Error occurred while processing '${this.privFilename}'. ${r}`;throw this.onEvent(new t.AudioStreamNodeErrorEvent(this.privId,o,a)),new Error(a)};try{await this.turnOn();const r=await this.privAudioFormatPromise,a=new t.ChunkedArrayBufferStream(r.avgBytesPerSec/10,o);this.privStreams[o]=a;const c=this.privSource.slice(this.privHeaderEnd),p=d=>{a.isClosed||(a.writeStreamChunk({buffer:d,isEnd:!1,timeReceived:Date.now()}),a.close())};if(typeof window<"u"&&typeof Blob<"u"&&c instanceof Blob){const d=new FileReader;d.onerror=l=>s(l.toString()),d.onload=l=>{const h=l.target.result;p(h)},d.readAsArrayBuffer(c)}else{const d=c;p(d.buffer.slice(d.byteOffset,d.byteOffset+d.byteLength))}return a}catch(r){s(r)}}onEvent(o){this.privEvents.onEvent(o),t.Events.instance.onEvent(o)}};return ft.FileAudioSource=u,ft}var gt={},xo;function ql(){if(xo)return gt;xo=1,Object.defineProperty(gt,"__esModule",{value:!0}),gt.PcmRecorder=void 0;const e=b();class t{constructor(u){this.privStopInputOnRelease=u}record(u,n,o){const r=new e.RiffPcmEncoder(u.sampleRate,16e3),a=u.createMediaStreamSource(n),c=()=>{const d=(()=>{let l=0;try{return u.createScriptProcessor(l,1,1)}catch{l=2048;let g=u.sampleRate;for(;l<16384&&g>=32e3;)l<<=1,g>>=1;return u.createScriptProcessor(l,1,1)}})();d.onaudioprocess=l=>{const h=l.inputBuffer.getChannelData(0);if(o&&!o.isClosed){const g=r.encode(h);g&&o.writeStreamChunk({buffer:g,isEnd:!1,timeReceived:Date.now()})}},a.connect(d),d.connect(u.destination),this.privMediaResources={scriptProcessorNode:d,source:a,stream:n}},p=!!this.privSpeechProcessorScript&&this.privSpeechProcessorScript.toLowerCase()==="ignore";if(u.audioWorklet&&!p){if(!this.privSpeechProcessorScript){const d=`class SP extends AudioWorkletProcessor {
                    constructor(options) {
                      super(options);
                    }
                    process(inputs, outputs) {
                      const input = inputs[0];
                      const output = [];
                      for (let channel = 0; channel < input.length; channel += 1) {
                        output[channel] = input[channel];
                      }
                      this.port.postMessage(output[0]);
                      return true;
                    }
                  }
                  registerProcessor('speech-processor', SP);`,l=new Blob([d],{type:"application/javascript; charset=utf-8"});this.privSpeechProcessorScript=URL.createObjectURL(l)}u.audioWorklet.addModule(this.privSpeechProcessorScript).then(()=>{const d=new AudioWorkletNode(u,"speech-processor");d.port.onmessage=l=>{const h=l.data;if(o&&!o.isClosed){const g=r.encode(h);g&&o.writeStreamChunk({buffer:g,isEnd:!1,timeReceived:Date.now()})}},a.connect(d),d.connect(u.destination),this.privMediaResources={scriptProcessorNode:d,source:a,stream:n}}).catch(()=>{c()})}else try{c()}catch(d){throw new Error(`Unable to start audio worklet node for PCMRecorder: ${d}`)}}releaseMediaResources(u){this.privMediaResources&&(this.privMediaResources.scriptProcessorNode&&(this.privMediaResources.scriptProcessorNode.disconnect(u.destination),this.privMediaResources.scriptProcessorNode=null),this.privMediaResources.source&&(this.privMediaResources.source.disconnect(),this.privStopInputOnRelease&&this.privMediaResources.stream.getTracks().forEach(n=>n.stop()),this.privMediaResources.source=null))}setWorkletUrl(u){this.privSpeechProcessorScript=u}}return gt.PcmRecorder=t,gt}var mt={},W={},Uo;function _p(){if(Uo)return W;Uo=1;var e=W&&W.__createBinding||(Object.create?(function(l,h,g,f){f===void 0&&(f=g),Object.defineProperty(l,f,{enumerable:!0,get:function(){return h[g]}})}):(function(l,h,g,f){f===void 0&&(f=g),l[f]=h[g]})),t=W&&W.__setModuleDefault||(Object.create?(function(l,h){Object.defineProperty(l,"default",{enumerable:!0,value:h})}):function(l,h){l.default=h}),i=W&&W.__importStar||function(l){if(l&&l.__esModule)return l;var h={};if(l!=null)for(var g in l)g!=="default"&&Object.prototype.hasOwnProperty.call(l,g)&&e(h,l,g);return t(h,l),h},u=W&&W.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(W,"__esModule",{value:!0}),W.WebsocketMessageAdapter=void 0;const n=i(Oe),o=i(Oe),s=u(Oe),r=u(Oe),a=u(Oe),c=V(),p=b();let d=class hs{constructor(h,g,f,m,v,S){if(!h)throw new p.ArgumentNullError("uri");if(!f)throw new p.ArgumentNullError("messageFormatter");this.proxyInfo=m,this.privConnectionEvents=new p.EventSource,this.privConnectionId=g,this.privMessageFormatter=f,this.privConnectionState=p.ConnectionState.None,this.privUri=h,this.privHeaders=v,this.privEnableCompression=S,this.privHeaders[c.HeaderNames.ConnectionId]=this.privConnectionId,this.privHeaders.connectionId=this.privConnectionId,this.privLastErrorReceived=""}get state(){return this.privConnectionState}open(){if(this.privConnectionState===p.ConnectionState.Disconnected)return Promise.reject(`Cannot open a connection that is in ${this.privConnectionState} state`);if(this.privConnectionEstablishDeferral)return this.privConnectionEstablishDeferral.promise;this.privConnectionEstablishDeferral=new p.Deferred,this.privCertificateValidatedDeferral=new p.Deferred,this.privConnectionState=p.ConnectionState.Connecting;try{if(typeof WebSocket<"u"&&!hs.forceNpmWebSocket)this.privCertificateValidatedDeferral.resolve(),this.privWebsocketClient=new WebSocket(this.privUri);else{let g=new URL(this.privUri).protocol;(g==null?void 0:g.toLocaleLowerCase())==="wss:"?g="https:":(g==null?void 0:g.toLocaleLowerCase())==="ws:"&&(g="http:");const f={headers:this.privHeaders,perMessageDeflate:this.privEnableCompression,followRedirects:g.toLocaleLowerCase()==="https:"};this.privCertificateValidatedDeferral.resolve(),f.agent=this.getAgent(),f.agent.protocol=g,this.privWebsocketClient=new a.default(this.privUri,f),this.privWebsocketClient.on("redirect",m=>{const v=new p.ConnectionRedirectEvent(this.privConnectionId,m,this.privUri,`Getting redirect URL from endpoint ${this.privUri} with redirect URL '${m}'`);p.Events.instance.onEvent(v)})}this.privWebsocketClient.binaryType="arraybuffer",this.privReceivingMessageQueue=new p.Queue,this.privDisconnectDeferral=new p.Deferred,this.privSendMessageQueue=new p.Queue,this.processSendQueue().catch(h=>{p.Events.instance.onEvent(new p.BackgroundEvent(h))})}catch(h){return this.privConnectionEstablishDeferral.resolve(new p.ConnectionOpenResponse(500,h)),this.privConnectionEstablishDeferral.promise}return this.onEvent(new p.ConnectionStartEvent(this.privConnectionId,this.privUri)),this.privWebsocketClient.onopen=()=>{this.privCertificateValidatedDeferral.promise.then(()=>{this.privConnectionState=p.ConnectionState.Connected,this.onEvent(new p.ConnectionEstablishedEvent(this.privConnectionId)),this.privConnectionEstablishDeferral.resolve(new p.ConnectionOpenResponse(200,""))},h=>{this.privConnectionEstablishDeferral.reject(h)})},this.privWebsocketClient.onerror=h=>{this.onEvent(new p.ConnectionErrorEvent(this.privConnectionId,h.message,h.type)),this.privLastErrorReceived=h.message},this.privWebsocketClient.onclose=h=>{this.privConnectionState===p.ConnectionState.Connecting?(this.privConnectionState=p.ConnectionState.Disconnected,this.privConnectionEstablishDeferral.resolve(new p.ConnectionOpenResponse(h.code,h.reason+" "+this.privLastErrorReceived))):(this.privConnectionState=p.ConnectionState.Disconnected,this.privWebsocketClient=null,this.onEvent(new p.ConnectionClosedEvent(this.privConnectionId,h.code,h.reason))),this.onClose(h.code,h.reason).catch(g=>{p.Events.instance.onEvent(new p.BackgroundEvent(g))})},this.privWebsocketClient.onmessage=h=>{const g=new Date().toISOString();if(this.privConnectionState===p.ConnectionState.Connected){const f=new p.Deferred;if(this.privReceivingMessageQueue.enqueueFromPromise(f.promise),h.data instanceof ArrayBuffer){const m=new p.RawWebsocketMessage(p.MessageType.Binary,h.data);this.privMessageFormatter.toConnectionMessage(m).then(v=>{this.onEvent(new p.ConnectionMessageReceivedEvent(this.privConnectionId,g,v)),f.resolve(v)},v=>{f.reject(`Invalid binary message format. Error: ${v}`)})}else{const m=new p.RawWebsocketMessage(p.MessageType.Text,h.data);this.privMessageFormatter.toConnectionMessage(m).then(v=>{this.onEvent(new p.ConnectionMessageReceivedEvent(this.privConnectionId,g,v)),f.resolve(v)},v=>{f.reject(`Invalid text message format. Error: ${v}`)})}}},this.privConnectionEstablishDeferral.promise}send(h){if(this.privConnectionState!==p.ConnectionState.Connected)return Promise.reject(`Cannot send on connection that is in ${p.ConnectionState[this.privConnectionState]} state`);const g=new p.Deferred,f=new p.Deferred;return this.privSendMessageQueue.enqueueFromPromise(f.promise),this.privMessageFormatter.fromConnectionMessage(h).then(m=>{f.resolve({Message:h,RawWebsocketMessage:m,sendStatusDeferral:g})},m=>{f.reject(`Error formatting the message. ${m}`)}),g.promise}read(){return this.privConnectionState!==p.ConnectionState.Connected?Promise.reject(`Cannot read on connection that is in ${this.privConnectionState} state`):this.privReceivingMessageQueue.dequeue()}close(h){if(this.privWebsocketClient)this.privConnectionState!==p.ConnectionState.Disconnected&&this.privWebsocketClient.close(1e3,h||"Normal closure by client");else return Promise.resolve();return this.privDisconnectDeferral.promise}get events(){return this.privConnectionEvents}sendRawMessage(h){try{if(!h)return Promise.resolve();if(this.onEvent(new p.ConnectionMessageSentEvent(this.privConnectionId,new Date().toISOString(),h.Message)),this.isWebsocketOpen)this.privWebsocketClient.send(h.RawWebsocketMessage.payload);else return Promise.reject("websocket send error: Websocket not ready "+this.privConnectionId+" "+h.Message.id+" "+new Error().stack);return Promise.resolve()}catch(g){return Promise.reject(`websocket send error: ${g}`)}}async onClose(h,g){const f=`Connection closed. ${h}: ${g}`;this.privConnectionState=p.ConnectionState.Disconnected,this.privDisconnectDeferral.resolve(),await this.privReceivingMessageQueue.drainAndDispose(()=>{},f),await this.privSendMessageQueue.drainAndDispose(m=>{m.sendStatusDeferral.reject(f)},f)}async processSendQueue(){for(;;){const g=await this.privSendMessageQueue.dequeue();if(!g)return;try{await this.sendRawMessage(g),g.sendStatusDeferral.resolve()}catch(f){g.sendStatusDeferral.reject(f)}}}onEvent(h){this.privConnectionEvents.onEvent(h),p.Events.instance.onEvent(h)}getAgent(){const h=new s.default.Agent(this.createConnection);return this.proxyInfo!==void 0&&this.proxyInfo.HostName!==void 0&&this.proxyInfo.Port>0&&(h.proxyInfo=this.proxyInfo),h}static GetProxyAgent(h){const g={host:h.HostName,port:h.Port};return h.UserName?g.headers={"Proxy-Authentication":"Basic "+Buffer.from(`${h.UserName}:${h.Password===void 0?"":h.Password}`).toString("base64")}:g.headers={},g.headers.requestOCSP="true",new r.default(g)}createConnection(h,g){let f;if(g={...g,requestOCSP:!0,servername:g.host},this.proxyInfo){const v=hs.GetProxyAgent(this.proxyInfo);f=new Promise((S,C)=>{v.callback(h,g,(y,R)=>{y?C(y):S(R)})})}else g.secureEndpoint?f=Promise.resolve(o.connect(g)):f=Promise.resolve(n.connect(g));return f}get isWebsocketOpen(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN}};return W.WebsocketMessageAdapter=d,d.forceNpmWebSocket=!1,W}var Wo;function Bl(){if(Wo)return mt;Wo=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.WebsocketConnection=void 0;const e=b(),t=_p();let i=class{constructor(n,o,s,r,a,c=!1,p){if(this.privIsDisposed=!1,!n)throw new e.ArgumentNullError("uri");if(!r)throw new e.ArgumentNullError("messageFormatter");this.privMessageFormatter=r;let d="",l=0;if(o){for(const h in o)if(h){d+=l===0&&n.indexOf("?")===-1?"?":"&";const g=encodeURIComponent(h);d+=g;let f=o[h];f&&(f=encodeURIComponent(f),d+=`=${f}`),l++}}if(s){for(const h in s)if(h){d+=l===0&&n.indexOf("?")===-1?"?":"&";const g=encodeURIComponent(s[h]);d+=`${h}=${g}`,l++}}this.privUri=n+d,this.privId=p||(0,e.createNoDashGuid)(),this.privConnectionMessageAdapter=new t.WebsocketMessageAdapter(this.privUri,this.id,this.privMessageFormatter,a,s,c)}async dispose(){this.privIsDisposed=!0,this.privConnectionMessageAdapter&&await this.privConnectionMessageAdapter.close()}isDisposed(){return this.privIsDisposed}get id(){return this.privId}get uri(){return this.privUri}state(){return this.privConnectionMessageAdapter.state}open(){return this.privConnectionMessageAdapter.open()}send(n){return this.privConnectionMessageAdapter.send(n)}read(){return this.privConnectionMessageAdapter.read()}get events(){return this.privConnectionMessageAdapter.events}};return mt.WebsocketConnection=i,mt}var St={},Ho;function Fl(){if(Ho)return St;Ho=1,Object.defineProperty(St,"__esModule",{value:!0}),St.ReplayableAudioNode=void 0;let e=class{constructor(u,n){this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.privAudioNode=u,this.privBytesPerSecond=n}id(){return this.privAudioNode.id()}read(){if(this.privReplay&&this.privBuffers.length!==0){const u=this.privReplayOffset-this.privBufferStartOffset;let n=Math.round(u*this.privBytesPerSecond*1e-7);n%2!==0&&n++;let o=0;for(;o<this.privBuffers.length&&n>=this.privBuffers[o].chunk.buffer.byteLength;)n-=this.privBuffers[o++].chunk.buffer.byteLength;if(o<this.privBuffers.length){const s=this.privBuffers[o].chunk.buffer.slice(n);return this.privReplayOffset+=s.byteLength/this.privBytesPerSecond*1e7,o===this.privBuffers.length-1&&(this.privReplay=!1),Promise.resolve({buffer:s,isEnd:!1,timeReceived:this.privBuffers[o].chunk.timeReceived})}}return this.privAudioNode.read().then(u=>(u&&u.buffer&&this.privBuffers&&(this.privBuffers.push(new t(u,this.privBufferSerial++,this.privBufferedBytes)),this.privBufferedBytes+=u.buffer.byteLength),u))}detach(){return this.privBuffers=void 0,this.privAudioNode.detach()}replay(){this.privBuffers&&this.privBuffers.length!==0&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)}shrinkBuffers(u){if(this.privBuffers===void 0||this.privBuffers.length===0)return;this.privLastShrinkOffset=u;const n=u-this.privBufferStartOffset;let o=Math.round(n*this.privBytesPerSecond*1e-7),s=0;for(;s<this.privBuffers.length&&o>=this.privBuffers[s].chunk.buffer.byteLength;)o-=this.privBuffers[s++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(u-o/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(s)}findTimeAtOffset(u){if(u<this.privBufferStartOffset||this.privBuffers===void 0)return 0;for(const n of this.privBuffers){const o=n.byteOffset/this.privBytesPerSecond*1e7,s=o+n.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(u>=o&&u<=s)return n.chunk.timeReceived}return 0}};St.ReplayableAudioNode=e;class t{constructor(u,n,o){this.chunk=u,this.serial=n,this.byteOffset=o}}return St}var Ct={},fn={},re={},Q={},Ko;function bp(){if(Ko)return Q;Ko=1;var e=Q&&Q.__createBinding||(Object.create?(function(s,r,a,c){c===void 0&&(c=a),Object.defineProperty(s,c,{enumerable:!0,get:function(){return r[a]}})}):(function(s,r,a,c){c===void 0&&(c=a),s[c]=r[a]})),t=Q&&Q.__setModuleDefault||(Object.create?(function(s,r){Object.defineProperty(s,"default",{enumerable:!0,value:r})}):function(s,r){s.default=r}),i=Q&&Q.__importStar||function(s){if(s&&s.__esModule)return s;var r={};if(s!=null)for(var a in s)a!=="default"&&Object.prototype.hasOwnProperty.call(s,a)&&e(r,s,a);return t(r,s),r};Object.defineProperty(Q,"__esModule",{value:!0}),Q.AudioFileWriter=void 0;const u=i(Oe),n=D();let o=class{constructor(r){n.Contracts.throwIfNullOrUndefined(u.openSync,`
File System access not available, please use Push or PullAudioOutputStream`),this.privFd=u.openSync(r,"w")}set format(r){n.Contracts.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=r;let a=0;this.privAudioFormat.hasHeader&&(a=this.privAudioFormat.header.byteLength),this.privFd!==void 0&&(this.privWriteStream=u.createWriteStream("",{fd:this.privFd,start:a,autoClose:!1}))}write(r){n.Contracts.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),this.privWriteStream!==void 0&&this.privWriteStream.write(new Uint8Array(r.slice(0)))}close(){this.privFd!==void 0&&(this.privWriteStream.on("finish",()=>{this.privAudioFormat.hasHeader&&(this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten),u.writeSync(this.privFd,new Int8Array(this.privAudioFormat.header),0,this.privAudioFormat.header.byteLength,0)),u.closeSync(this.privFd),this.privFd=void 0}),this.privWriteStream.end())}id(){return this.privId}};return Q.AudioFileWriter=o,Q}var H={},Vo;function Mp(){if(Vo)return H;Vo=1,Object.defineProperty(H,"__esModule",{value:!0}),H.PullAudioInputStreamImpl=H.PullAudioInputStream=H.PushAudioInputStreamImpl=H.PushAudioInputStream=H.AudioInputStream=void 0;const e=w(),t=b(),i=De(),u=A(),n=ke();let o=class{constructor(){}static createPushStream(d){return s.create(d)}static createPullStream(d,l){return a.create(d,l)}};H.AudioInputStream=o;class s extends o{static create(d){return new r(d)}}H.PushAudioInputStream=s;class r extends s{constructor(d){super(),d===void 0?this.privFormat=n.AudioStreamFormatImpl.getDefaultInputFormat():this.privFormat=d,this.privEvents=new t.EventSource,this.privId=(0,i.createNoDashGuid)(),this.privStream=new t.ChunkedArrayBufferStream(this.privFormat.avgBytesPerSec/10)}get format(){return Promise.resolve(this.privFormat)}write(d){this.privStream.writeStreamChunk({buffer:d,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}id(){return this.privId}turnOn(){this.onEvent(new t.AudioSourceInitializingEvent(this.privId)),this.onEvent(new t.AudioSourceReadyEvent(this.privId))}async attach(d){this.onEvent(new t.AudioStreamNodeAttachingEvent(this.privId,d)),await this.turnOn();const l=this.privStream;return this.onEvent(new t.AudioStreamNodeAttachedEvent(this.privId,d)),{detach:async()=>(this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,d)),this.turnOff()),id:()=>d,read:()=>l.read()}}detach(d){this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,d))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:e.connectivity.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:e.type.Stream})}onEvent(d){this.privEvents.onEvent(d),t.Events.instance.onEvent(d)}toBuffer(d){const l=Buffer.alloc(d.byteLength),h=new Uint8Array(d);for(let g=0;g<l.length;++g)l[g]=h[g];return l}}H.PushAudioInputStreamImpl=r;class a extends o{constructor(){super()}static create(d,l){return new c(d,l)}}H.PullAudioInputStream=a;class c extends a{constructor(d,l){super(),l===void 0?this.privFormat=u.AudioStreamFormat.getDefaultInputFormat():this.privFormat=l,this.privEvents=new t.EventSource,this.privId=(0,i.createNoDashGuid)(),this.privCallback=d,this.privIsClosed=!1,this.privBufferSize=this.privFormat.avgBytesPerSec/10}get format(){return Promise.resolve(this.privFormat)}close(){this.privIsClosed=!0,this.privCallback.close()}id(){return this.privId}turnOn(){this.onEvent(new t.AudioSourceInitializingEvent(this.privId)),this.onEvent(new t.AudioSourceReadyEvent(this.privId))}async attach(d){return this.onEvent(new t.AudioStreamNodeAttachingEvent(this.privId,d)),await this.turnOn(),this.onEvent(new t.AudioStreamNodeAttachedEvent(this.privId,d)),{detach:()=>(this.privCallback.close(),this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,d)),this.turnOff()),id:()=>d,read:()=>{let l=0,h;for(;l<this.privBufferSize;){const g=new ArrayBuffer(this.privBufferSize-l),f=this.privCallback.read(g);if(h===void 0?h=g:new Int8Array(h).set(new Int8Array(g),l),f===0)break;l+=f}return Promise.resolve({buffer:h.slice(0,l),isEnd:this.privIsClosed||l===0,timeReceived:Date.now()})}}}detach(d){this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,d))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:e.connectivity.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:e.type.Stream})}onEvent(d){this.privEvents.onEvent(d),t.Events.instance.onEvent(d)}}return H.PullAudioInputStreamImpl=c,H}var K={},yt={},gn={},Jo;function Op(){return Jo||(Jo=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechSynthesisOutputFormat=void 0,(function(t){t[t.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",t[t.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",t[t.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",t[t.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",t[t.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",t[t.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",t[t.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",t[t.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",t[t.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",t[t.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",t[t.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",t[t.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",t[t.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",t[t.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",t[t.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",t[t.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",t[t.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",t[t.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",t[t.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus",t[t.Raw48Khz16BitMonoPcm=19]="Raw48Khz16BitMonoPcm",t[t.Riff48Khz16BitMonoPcm=20]="Riff48Khz16BitMonoPcm",t[t.Audio48Khz96KBitRateMonoMp3=21]="Audio48Khz96KBitRateMonoMp3",t[t.Audio48Khz192KBitRateMonoMp3=22]="Audio48Khz192KBitRateMonoMp3",t[t.Ogg48Khz16BitMonoOpus=23]="Ogg48Khz16BitMonoOpus",t[t.Webm16Khz16BitMonoOpus=24]="Webm16Khz16BitMonoOpus",t[t.Webm24Khz16BitMonoOpus=25]="Webm24Khz16BitMonoOpus",t[t.Raw24Khz16BitMonoTrueSilk=26]="Raw24Khz16BitMonoTrueSilk",t[t.Raw8Khz8BitMonoALaw=27]="Raw8Khz8BitMonoALaw",t[t.Riff8Khz8BitMonoALaw=28]="Riff8Khz8BitMonoALaw",t[t.Webm24Khz16Bit24KbpsMonoOpus=29]="Webm24Khz16Bit24KbpsMonoOpus",t[t.Audio16Khz16Bit32KbpsMonoOpus=30]="Audio16Khz16Bit32KbpsMonoOpus",t[t.Audio24Khz16Bit48KbpsMonoOpus=31]="Audio24Khz16Bit48KbpsMonoOpus",t[t.Audio24Khz16Bit24KbpsMonoOpus=32]="Audio24Khz16Bit24KbpsMonoOpus",t[t.Raw22050Hz16BitMonoPcm=33]="Raw22050Hz16BitMonoPcm",t[t.Riff22050Hz16BitMonoPcm=34]="Riff22050Hz16BitMonoPcm",t[t.Raw44100Hz16BitMonoPcm=35]="Raw44100Hz16BitMonoPcm",t[t.Riff44100Hz16BitMonoPcm=36]="Riff44100Hz16BitMonoPcm",t[t.AmrWb16000Hz=37]="AmrWb16000Hz",t[t.G72216Khz64Kbps=38]="G72216Khz64Kbps"})(e.SpeechSynthesisOutputFormat||(e.SpeechSynthesisOutputFormat={}))})(gn)),gn}var Go;function Oi(){if(Go)return yt;Go=1,Object.defineProperty(yt,"__esModule",{value:!0}),yt.AudioOutputFormatImpl=void 0;const e=Op(),t=ke();class i extends t.AudioStreamFormatImpl{constructor(n,o,s,r,a,c,p,d,l){super(s,c,o,n),this.formatTag=n,this.avgBytesPerSec=r,this.blockAlign=a,this.priAudioFormatString=p,this.priRequestAudioFormatString=d,this.priHasHeader=l}static fromSpeechSynthesisOutputFormat(n){return n===void 0?i.getDefaultOutputFormat():i.fromSpeechSynthesisOutputFormatString(i.SpeechSynthesisOutputFormatToString[n])}static fromSpeechSynthesisOutputFormatString(n){switch(n){case"raw-8khz-8bit-mono-mulaw":return new i(t.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,n,n,!1);case"riff-16khz-16kbps-mono-siren":return new i(t.AudioFormatTag.Siren,1,16e3,2e3,40,0,n,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new i(t.AudioFormatTag.Siren,1,16e3,2e3,40,0,n,n,!1);case"audio-16khz-32kbitrate-mono-mp3":return new i(t.AudioFormatTag.MP3,1,16e3,4096,2,16,n,n,!1);case"audio-16khz-128kbitrate-mono-mp3":return new i(t.AudioFormatTag.MP3,1,16e3,16384,2,16,n,n,!1);case"audio-16khz-64kbitrate-mono-mp3":return new i(t.AudioFormatTag.MP3,1,16e3,8192,2,16,n,n,!1);case"audio-24khz-48kbitrate-mono-mp3":return new i(t.AudioFormatTag.MP3,1,24e3,6144,2,16,n,n,!1);case"audio-24khz-96kbitrate-mono-mp3":return new i(t.AudioFormatTag.MP3,1,24e3,12288,2,16,n,n,!1);case"audio-24khz-160kbitrate-mono-mp3":return new i(t.AudioFormatTag.MP3,1,24e3,20480,2,16,n,n,!1);case"raw-16khz-16bit-mono-truesilk":return new i(t.AudioFormatTag.SILKSkype,1,16e3,32e3,2,16,n,n,!1);case"riff-8khz-16bit-mono-pcm":return new i(t.AudioFormatTag.PCM,1,8e3,16e3,2,16,n,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new i(t.AudioFormatTag.PCM,1,24e3,48e3,2,16,n,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new i(t.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,n,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new i(t.AudioFormatTag.PCM,1,16e3,32e3,2,16,n,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new i(t.AudioFormatTag.PCM,1,24e3,48e3,2,16,n,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new i(t.AudioFormatTag.PCM,1,8e3,16e3,2,16,n,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new i(t.AudioFormatTag.OGG_OPUS,1,16e3,8192,2,16,n,n,!1);case"ogg-24khz-16bit-mono-opus":return new i(t.AudioFormatTag.OGG_OPUS,1,24e3,8192,2,16,n,n,!1);case"raw-48khz-16bit-mono-pcm":return new i(t.AudioFormatTag.PCM,1,48e3,96e3,2,16,n,"raw-48khz-16bit-mono-pcm",!1);case"riff-48khz-16bit-mono-pcm":return new i(t.AudioFormatTag.PCM,1,48e3,96e3,2,16,n,"raw-48khz-16bit-mono-pcm",!0);case"audio-48khz-96kbitrate-mono-mp3":return new i(t.AudioFormatTag.MP3,1,48e3,12288,2,16,n,n,!1);case"audio-48khz-192kbitrate-mono-mp3":return new i(t.AudioFormatTag.MP3,1,48e3,24576,2,16,n,n,!1);case"ogg-48khz-16bit-mono-opus":return new i(t.AudioFormatTag.OGG_OPUS,1,48e3,12e3,2,16,n,n,!1);case"webm-16khz-16bit-mono-opus":return new i(t.AudioFormatTag.WEBM_OPUS,1,16e3,4e3,2,16,n,n,!1);case"webm-24khz-16bit-mono-opus":return new i(t.AudioFormatTag.WEBM_OPUS,1,24e3,6e3,2,16,n,n,!1);case"webm-24khz-16bit-24kbps-mono-opus":return new i(t.AudioFormatTag.WEBM_OPUS,1,24e3,3e3,2,16,n,n,!1);case"audio-16khz-16bit-32kbps-mono-opus":return new i(t.AudioFormatTag.OPUS,1,16e3,4e3,2,16,n,n,!1);case"audio-24khz-16bit-48kbps-mono-opus":return new i(t.AudioFormatTag.OPUS,1,24e3,6e3,2,16,n,n,!1);case"audio-24khz-16bit-24kbps-mono-opus":return new i(t.AudioFormatTag.OPUS,1,24e3,3e3,2,16,n,n,!1);case"audio-24khz-16bit-mono-flac":return new i(t.AudioFormatTag.FLAC,1,24e3,24e3,2,16,n,n,!1);case"audio-48khz-16bit-mono-flac":return new i(t.AudioFormatTag.FLAC,1,48e3,3e4,2,16,n,n,!1);case"raw-24khz-16bit-mono-truesilk":return new i(t.AudioFormatTag.SILKSkype,1,24e3,48e3,2,16,n,n,!1);case"raw-8khz-8bit-mono-alaw":return new i(t.AudioFormatTag.ALaw,1,8e3,8e3,1,8,n,n,!1);case"riff-8khz-8bit-mono-alaw":return new i(t.AudioFormatTag.ALaw,1,8e3,8e3,1,8,n,"raw-8khz-8bit-mono-alaw",!0);case"raw-22050hz-16bit-mono-pcm":return new i(t.AudioFormatTag.PCM,1,22050,44100,2,16,n,n,!1);case"riff-22050hz-16bit-mono-pcm":return new i(t.AudioFormatTag.PCM,1,22050,44100,2,16,n,"raw-22050hz-16bit-mono-pcm",!0);case"raw-44100hz-16bit-mono-pcm":return new i(t.AudioFormatTag.PCM,1,44100,88200,2,16,n,n,!1);case"riff-44100hz-16bit-mono-pcm":return new i(t.AudioFormatTag.PCM,1,44100,88200,2,16,n,"raw-44100hz-16bit-mono-pcm",!0);case"amr-wb-16000h":return new i(t.AudioFormatTag.AMR_WB,1,16e3,3052,2,16,n,n,!1);case"g722-16khz-64kbps":return new i(t.AudioFormatTag.G722,1,16e3,8e3,2,16,n,n,!1);case"riff-16khz-16bit-mono-pcm":default:return new i(t.AudioFormatTag.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}}static getDefaultOutputFormat(){return i.fromSpeechSynthesisOutputFormatString(typeof window<"u"?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")}get hasHeader(){return this.priHasHeader}get header(){if(this.hasHeader)return this.privHeader}updateHeader(n){if(this.priHasHeader){const o=new DataView(this.privHeader);o.setUint32(4,n+this.privHeader.byteLength-8,!0),o.setUint32(40,n,!0)}}get requestAudioFormatString(){return this.priRequestAudioFormatString}addHeader(n){if(!this.hasHeader)return n;this.updateHeader(n.byteLength);const o=new Uint8Array(n.byteLength+this.header.byteLength);return o.set(new Uint8Array(this.header),0),o.set(new Uint8Array(n),this.header.byteLength),o.buffer}}return yt.AudioOutputFormatImpl=i,i.SpeechSynthesisOutputFormatToString={[e.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoMULaw]:"raw-8khz-8bit-mono-mulaw",[e.SpeechSynthesisOutputFormat.Riff16Khz16KbpsMonoSiren]:"riff-16khz-16kbps-mono-siren",[e.SpeechSynthesisOutputFormat.Audio16Khz16KbpsMonoSiren]:"audio-16khz-16kbps-mono-siren",[e.SpeechSynthesisOutputFormat.Audio16Khz32KBitRateMonoMp3]:"audio-16khz-32kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3]:"audio-16khz-128kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio16Khz64KBitRateMonoMp3]:"audio-16khz-64kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3]:"audio-24khz-48kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio24Khz96KBitRateMonoMp3]:"audio-24khz-96kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio24Khz160KBitRateMonoMp3]:"audio-24khz-160kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoTrueSilk]:"raw-16khz-16bit-mono-truesilk",[e.SpeechSynthesisOutputFormat.Riff16Khz16BitMonoPcm]:"riff-16khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff8Khz16BitMonoPcm]:"riff-8khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm]:"riff-24khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoMULaw]:"riff-8khz-8bit-mono-mulaw",[e.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoPcm]:"raw-16khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoPcm]:"raw-24khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Raw8Khz16BitMonoPcm]:"raw-8khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Ogg16Khz16BitMonoOpus]:"ogg-16khz-16bit-mono-opus",[e.SpeechSynthesisOutputFormat.Ogg24Khz16BitMonoOpus]:"ogg-24khz-16bit-mono-opus",[e.SpeechSynthesisOutputFormat.Raw48Khz16BitMonoPcm]:"raw-48khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff48Khz16BitMonoPcm]:"riff-48khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Audio48Khz96KBitRateMonoMp3]:"audio-48khz-96kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio48Khz192KBitRateMonoMp3]:"audio-48khz-192kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Ogg48Khz16BitMonoOpus]:"ogg-48khz-16bit-mono-opus",[e.SpeechSynthesisOutputFormat.Webm16Khz16BitMonoOpus]:"webm-16khz-16bit-mono-opus",[e.SpeechSynthesisOutputFormat.Webm24Khz16BitMonoOpus]:"webm-24khz-16bit-mono-opus",[e.SpeechSynthesisOutputFormat.Webm24Khz16Bit24KbpsMonoOpus]:"webm-24khz-16bit-24kbps-mono-opus",[e.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoTrueSilk]:"raw-24khz-16bit-mono-truesilk",[e.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoALaw]:"raw-8khz-8bit-mono-alaw",[e.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoALaw]:"riff-8khz-8bit-mono-alaw",[e.SpeechSynthesisOutputFormat.Audio16Khz16Bit32KbpsMonoOpus]:"audio-16khz-16bit-32kbps-mono-opus",[e.SpeechSynthesisOutputFormat.Audio24Khz16Bit48KbpsMonoOpus]:"audio-24khz-16bit-48kbps-mono-opus",[e.SpeechSynthesisOutputFormat.Audio24Khz16Bit24KbpsMonoOpus]:"audio-24khz-16bit-24kbps-mono-opus",[e.SpeechSynthesisOutputFormat.Raw22050Hz16BitMonoPcm]:"raw-22050hz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff22050Hz16BitMonoPcm]:"riff-22050hz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Raw44100Hz16BitMonoPcm]:"raw-44100hz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff44100Hz16BitMonoPcm]:"riff-44100hz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.AmrWb16000Hz]:"amr-wb-16000hz",[e.SpeechSynthesisOutputFormat.G72216Khz64Kbps]:"g722-16khz-64kbps"},yt}var Qo;function Le(){if(Qo)return K;Qo=1,Object.defineProperty(K,"__esModule",{value:!0}),K.PushAudioOutputStreamImpl=K.PushAudioOutputStream=K.PullAudioOutputStreamImpl=K.PullAudioOutputStream=K.AudioOutputStream=void 0;const e=b(),t=D(),i=Oi();let u=class{constructor(){}static createPullStream(){return n.create()}};K.AudioOutputStream=u;class n extends u{static create(){return new o}}K.PullAudioOutputStream=n;class o extends n{constructor(){super(),this.privId=(0,e.createNoDashGuid)(),this.privStream=new e.Stream}set format(c){c==null&&(this.privFormat=i.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privFormat=c}get format(){return this.privFormat}get isClosed(){return this.privStream.isClosed}id(){return this.privId}async read(c){const p=new Int8Array(c);let d=0;if(this.privLastChunkView!==void 0){if(this.privLastChunkView.length>c.byteLength)return p.set(this.privLastChunkView.slice(0,c.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(c.byteLength),Promise.resolve(c.byteLength);p.set(this.privLastChunkView),d=this.privLastChunkView.length,this.privLastChunkView=void 0}for(;d<c.byteLength&&!this.privStream.isReadEnded;){const l=await this.privStream.read();if(l!==void 0&&!l.isEnd){let h;l.buffer.byteLength>c.byteLength-d?(h=l.buffer.slice(0,c.byteLength-d),this.privLastChunkView=new Int8Array(l.buffer.slice(c.byteLength-d))):h=l.buffer,p.set(new Int8Array(h),d),d+=h.byteLength}else this.privStream.readEnded()}return d}write(c){t.Contracts.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:c,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}}K.PullAudioOutputStreamImpl=o;class s extends u{constructor(){super()}static create(c){return new r(c)}}K.PushAudioOutputStream=s;class r extends s{constructor(c){super(),this.privId=(0,e.createNoDashGuid)(),this.privCallback=c}set format(c){}write(c){this.privCallback.write&&this.privCallback.write(c)}close(){this.privCallback.close&&this.privCallback.close()}id(){return this.privId}}return K.PushAudioOutputStreamImpl=r,K}var Xo;function xl(){if(Xo)return re;Xo=1,Object.defineProperty(re,"__esModule",{value:!0}),re.AudioOutputConfigImpl=re.AudioConfigImpl=re.AudioConfig=void 0;const e=U(),t=D(),i=A(),u=bp(),n=Mp(),o=Le();let s=class Dp{static fromDefaultMicrophoneInput(){const p=new e.PcmRecorder(!0);return new r(new e.MicAudioSource(p))}static fromMicrophoneInput(p){const d=new e.PcmRecorder(!0);return new r(new e.MicAudioSource(d,p))}static fromWavFileInput(p,d="unnamedBuffer.wav"){return new r(new e.FileAudioSource(p,d))}static fromStreamInput(p){if(p instanceof i.PullAudioInputStreamCallback)return new r(new n.PullAudioInputStreamImpl(p));if(p instanceof i.AudioInputStream)return new r(p);if(typeof MediaStream<"u"&&p instanceof MediaStream){const d=new e.PcmRecorder(!1);return new r(new e.MicAudioSource(d,null,null,p))}throw new Error("Not Supported Type")}static fromDefaultSpeakerOutput(){return new a(new i.SpeakerAudioDestination)}static fromSpeakerOutput(p){if(p===void 0)return Dp.fromDefaultSpeakerOutput();if(p instanceof i.SpeakerAudioDestination)return new a(p);throw new Error("Not Supported Type")}static fromAudioFileOutput(p){return new a(new u.AudioFileWriter(p))}static fromStreamOutput(p){if(p instanceof i.PushAudioOutputStreamCallback)return new a(new o.PushAudioOutputStreamImpl(p));if(p instanceof i.PushAudioOutputStream)return new a(p);if(p instanceof i.PullAudioOutputStream)return new a(p);throw new Error("Not Supported Type")}};re.AudioConfig=s;class r extends s{constructor(p){super(),this.privSource=p}get format(){return this.privSource.format}close(p,d){this.privSource.turnOff().then(()=>{p&&p()},l=>{d&&d(l)})}id(){return this.privSource.id()}turnOn(){return this.privSource.turnOn()}attach(p){return this.privSource.attach(p)}detach(p){return this.privSource.detach(p)}turnOff(){return this.privSource.turnOff()}get events(){return this.privSource.events}setProperty(p,d){if(t.Contracts.throwIfNull(d,"value"),this.privSource.setProperty!==void 0)this.privSource.setProperty(p,d);else throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(p,d){if(this.privSource.getProperty!==void 0)return this.privSource.getProperty(p,d);throw new Error("This AudioConfig instance does not support getting properties.")}get deviceInfo(){return this.privSource.deviceInfo}}re.AudioConfigImpl=r;class a extends s{constructor(p){super(),this.privDestination=p}set format(p){this.privDestination.format=p}write(p){this.privDestination.write(p)}close(){this.privDestination.close()}id(){return this.privDestination.id()}setProperty(){throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(){throw new Error("This AudioConfig instance does not support getting properties.")}}return re.AudioOutputConfigImpl=a,re}var mn={},Zo;function Ul(){return Zo||(Zo=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CancellationReason=void 0,(function(t){t[t.Error=0]="Error",t[t.EndOfStream=1]="EndOfStream"})(e.CancellationReason||(e.CancellationReason={}))})(mn)),mn}var Rt={},Yo;function Wl(){if(Yo)return Rt;Yo=1,Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.PullAudioInputStreamCallback=void 0;let e=class{};return Rt.PullAudioInputStreamCallback=e,Rt}var Pt={},$o;function Hl(){if($o)return Pt;$o=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.PushAudioOutputStreamCallback=void 0;let e=class{};return Pt.PushAudioOutputStreamCallback=e,Pt}var Et={},ea;function Kl(){if(ea)return Et;ea=1,Object.defineProperty(Et,"__esModule",{value:!0}),Et.KeywordRecognitionModel=void 0;const e=D();let t=class{constructor(){this.privDisposed=!1}static fromFile(u){throw e.Contracts.throwIfFileDoesNotExist(u,"fileName"),new Error("Not yet implemented.")}static fromStream(u){throw e.Contracts.throwIfNull(u,"file"),new Error("Not yet implemented.")}close(){this.privDisposed||(this.privDisposed=!0)}};return Et.KeywordRecognitionModel=t,Et}var Tt={},ta;function Vl(){if(ta)return Tt;ta=1,Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.SessionEventArgs=void 0;let e=class{constructor(i){this.privSessionId=i}get sessionId(){return this.privSessionId}};return Tt.SessionEventArgs=e,Tt}var At={},ra;function Jl(){if(ra)return At;ra=1,Object.defineProperty(At,"__esModule",{value:!0}),At.RecognitionEventArgs=void 0;const e=A();let t=class extends e.SessionEventArgs{constructor(u,n){super(n),this.privOffset=u}get offset(){return this.privOffset}};return At.RecognitionEventArgs=t,At}var Sn={},ia;function Gl(){return ia||(ia=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.OutputFormat=void 0,(function(t){t[t.Simple=0]="Simple",t[t.Detailed=1]="Detailed"})(e.OutputFormat||(e.OutputFormat={}))})(Sn)),Sn}var It={},na;function Ql(){if(na)return It;na=1,Object.defineProperty(It,"__esModule",{value:!0}),It.RecognitionResult=void 0;let e=class{constructor(i,u,n,o,s,r,a,c,p,d){this.privResultId=i,this.privReason=u,this.privText=n,this.privDuration=o,this.privOffset=s,this.privLanguage=r,this.privLanguageDetectionConfidence=a,this.privErrorDetails=c,this.privJson=p,this.privProperties=d}get resultId(){return this.privResultId}get reason(){return this.privReason}get text(){return this.privText}get duration(){return this.privDuration}get offset(){return this.privOffset}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}get errorDetails(){return this.privErrorDetails}get json(){return this.privJson}get properties(){return this.privProperties}};return It.RecognitionResult=e,It}var wt={},sa;function Xl(){if(sa)return wt;sa=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.SpeechRecognitionResult=void 0;const e=A();let t=class extends e.RecognitionResult{constructor(u,n,o,s,r,a,c,p,d,l,h){super(u,n,o,s,r,a,c,d,l,h),this.privSpeakerId=p}get speakerId(){return this.privSpeakerId}};return wt.SpeechRecognitionResult=t,wt}var ie={},oa;function Zl(){if(oa)return ie;oa=1,Object.defineProperty(ie,"__esModule",{value:!0}),ie.MeetingTranscriptionEventArgs=ie.ConversationTranscriptionEventArgs=ie.SpeechRecognitionEventArgs=void 0;const e=A();let t=class extends e.RecognitionEventArgs{constructor(o,s,r){super(s,r),this.privResult=o}get result(){return this.privResult}};ie.SpeechRecognitionEventArgs=t;class i extends e.RecognitionEventArgs{constructor(o,s,r){super(s,r),this.privResult=o}get result(){return this.privResult}}ie.ConversationTranscriptionEventArgs=i;class u extends t{}return ie.MeetingTranscriptionEventArgs=u,ie}var _t={},bt={},aa;function Di(){if(aa)return bt;aa=1,Object.defineProperty(bt,"__esModule",{value:!0}),bt.CancellationEventArgsBase=void 0;const e=A();let t=class extends e.RecognitionEventArgs{constructor(u,n,o,s,r){super(s,r),this.privReason=u,this.privErrorDetails=n,this.privErrorCode=o}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return bt.CancellationEventArgsBase=t,bt}var ca;function Yl(){if(ca)return _t;ca=1,Object.defineProperty(_t,"__esModule",{value:!0}),_t.SpeechRecognitionCanceledEventArgs=void 0;const e=Di();let t=class extends e.CancellationEventArgsBase{};return _t.SpeechRecognitionCanceledEventArgs=t,_t}var Mt={},ua;function $l(){if(ua)return Mt;ua=1,Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.TranslationRecognitionEventArgs=void 0;const e=A();let t=class extends e.RecognitionEventArgs{constructor(u,n,o){super(n,o),this.privResult=u}get result(){return this.privResult}};return Mt.TranslationRecognitionEventArgs=t,Mt}var Ot={},pa;function ev(){if(pa)return Ot;pa=1,Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.TranslationSynthesisEventArgs=void 0;const e=A();let t=class extends e.SessionEventArgs{constructor(u,n){super(n),this.privResult=u}get result(){return this.privResult}};return Ot.TranslationSynthesisEventArgs=t,Ot}var Dt={},da;function Np(){if(da)return Dt;da=1,Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.TranslationRecognitionResult=void 0;const e=A();let t=class kp extends e.SpeechRecognitionResult{constructor(u,n,o,s,r,a,c,p,d,l,h){super(n,o,s,r,a,c,p,void 0,d,l,h),this.privTranslations=u}static fromSpeechRecognitionResult(u){return new kp(void 0,u.resultId,u.reason,u.text,u.duration,u.offset,u.language,u.languageDetectionConfidence,u.errorDetails,u.json,u.properties)}get translations(){return this.privTranslations}};return Dt.TranslationRecognitionResult=t,Dt}var kt={},ha;function tv(){if(ha)return kt;ha=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.TranslationSynthesisResult=void 0;let e=class{constructor(i,u){this.privReason=i,this.privAudio=u}get audio(){return this.privAudio}get reason(){return this.privReason}};return kt.TranslationSynthesisResult=e,kt}var Cn={},la;function rv(){return la||(la=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ResultReason=void 0,(function(t){t[t.NoMatch=0]="NoMatch",t[t.Canceled=1]="Canceled",t[t.RecognizingSpeech=2]="RecognizingSpeech",t[t.RecognizedSpeech=3]="RecognizedSpeech",t[t.RecognizedKeyword=4]="RecognizedKeyword",t[t.TranslatingSpeech=5]="TranslatingSpeech",t[t.TranslatedSpeech=6]="TranslatedSpeech",t[t.SynthesizingAudio=7]="SynthesizingAudio",t[t.SynthesizingAudioCompleted=8]="SynthesizingAudioCompleted",t[t.SynthesizingAudioStarted=9]="SynthesizingAudioStarted",t[t.VoicesListRetrieved=10]="VoicesListRetrieved",t[t.TranslatingParticipantSpeech=11]="TranslatingParticipantSpeech",t[t.TranslatedParticipantSpeech=12]="TranslatedParticipantSpeech",t[t.TranslatedInstantMessage=13]="TranslatedInstantMessage",t[t.TranslatedParticipantInstantMessage=14]="TranslatedParticipantInstantMessage"})(e.ResultReason||(e.ResultReason={}))})(Cn)),Cn}var Se={},va;function iv(){if(va)return Se;va=1,Object.defineProperty(Se,"__esModule",{value:!0}),Se.SpeechConfigImpl=Se.SpeechConfig=void 0;const e=w(),t=D(),i=A();let u=class{constructor(){}static fromSubscription(s,r){t.Contracts.throwIfNullOrWhitespace(s,"subscriptionKey"),t.Contracts.throwIfNullOrWhitespace(r,"region");const a=new n;return a.setProperty(i.PropertyId.SpeechServiceConnection_Region,r),a.setProperty(i.PropertyId.SpeechServiceConnection_Key,s),a}static fromEndpoint(s,r){t.Contracts.throwIfNull(s,"endpoint");const a=typeof r=="string"&&r.trim().length>0,c=typeof r=="object"&&r!==null&&typeof r.getToken=="function",p=typeof r=="object"&&r!==null&&typeof r.key=="string";if(r!==void 0&&!a&&!c&&!p)throw new Error("Invalid 'auth' parameter: expected a non-empty API key string, a TokenCredential, or a KeyCredential.");let d;return typeof r=="string"?(d=new n,d.setProperty(i.PropertyId.SpeechServiceConnection_Key,r)):typeof r=="object"&&typeof r.getToken=="function"?d=new n(r):typeof r=="object"&&typeof r.key=="string"?(d=new n,d.setProperty(i.PropertyId.SpeechServiceConnection_Key,r.key)):d=new n,d.setProperty(i.PropertyId.SpeechServiceConnection_Endpoint,s.href),d}static fromHost(s,r){t.Contracts.throwIfNull(s,"hostName");const a=new n;return a.setProperty(i.PropertyId.SpeechServiceConnection_Host,s.protocol+"//"+s.hostname+(s.port===""?"":":"+s.port)),a.setProperty(i.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"1"),r!==void 0&&a.setProperty(i.PropertyId.SpeechServiceConnection_Key,r),a}static fromAuthorizationToken(s,r){t.Contracts.throwIfNull(s,"authorizationToken"),t.Contracts.throwIfNullOrWhitespace(r,"region");const a=new n;return a.setProperty(i.PropertyId.SpeechServiceConnection_Region,r),a.authorizationToken=s,a}close(){}};Se.SpeechConfig=u;class n extends u{constructor(s){super(),this.privProperties=new i.PropertyCollection,this.speechRecognitionLanguage="en-US",this.outputFormat=i.OutputFormat.Simple,this.privTokenCredential=s}get properties(){return this.privProperties}get endPoint(){return new URL(this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint))}get subscriptionKey(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_Key)}get region(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_Region)}get authorizationToken(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(s){this.privProperties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,s)}get speechRecognitionLanguage(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage)}set speechRecognitionLanguage(s){this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,s)}get autoDetectSourceLanguages(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)}set autoDetectSourceLanguages(s){this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,s)}get outputFormat(){return i.OutputFormat[this.privProperties.getProperty(e.OutputFormatPropertyName,void 0)]}set outputFormat(s){this.privProperties.setProperty(e.OutputFormatPropertyName,i.OutputFormat[s])}get endpointId(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(s){this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_EndpointId,s)}get tokenCredential(){return this.privTokenCredential}setProperty(s,r){t.Contracts.throwIfNull(r,"value"),this.privProperties.setProperty(s,r)}getProperty(s,r){return this.privProperties.getProperty(s,r)}setProxy(s,r,a,c){this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyHostName],s),this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyPort],r),this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyUserName],a),this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyPassword],c)}setServiceProperty(s,r){const a=JSON.parse(this.privProperties.getProperty(e.ServicePropertiesPropertyName,"{}"));a[s]=r,this.privProperties.setProperty(e.ServicePropertiesPropertyName,JSON.stringify(a))}setProfanity(s){this.privProperties.setProperty(i.PropertyId.SpeechServiceResponse_ProfanityOption,i.ProfanityOption[s])}enableAudioLogging(){this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privProperties.setProperty(i.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true"),this.privProperties.setProperty(e.OutputFormatPropertyName,i.OutputFormat[i.OutputFormat.Detailed])}enableDictation(){this.privProperties.setProperty(e.ForceDictationPropertyName,"true")}clone(){const s=new n(this.tokenCredential);return s.privProperties=this.privProperties.clone(),s}get speechSynthesisLanguage(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(s){this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_SynthLanguage,s)}get speechSynthesisVoiceName(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(s){this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_SynthVoice,s)}get speechSynthesisOutputFormat(){return i.SpeechSynthesisOutputFormat[this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(s){this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_SynthOutputFormat,i.SpeechSynthesisOutputFormat[s])}}return Se.SpeechConfigImpl=n,Se}var Ce={},fa;function nv(){if(fa)return Ce;fa=1,Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.SpeechTranslationConfigImpl=Ce.SpeechTranslationConfig=void 0;const e=w(),t=D(),i=A();let u=class extends i.SpeechConfig{constructor(){super()}static fromSubscription(s,r){t.Contracts.throwIfNullOrWhitespace(s,"subscriptionKey"),t.Contracts.throwIfNullOrWhitespace(r,"region");const a=new n;return a.properties.setProperty(i.PropertyId.SpeechServiceConnection_Key,s),a.properties.setProperty(i.PropertyId.SpeechServiceConnection_Region,r),a}static fromAuthorizationToken(s,r){t.Contracts.throwIfNullOrWhitespace(s,"authorizationToken"),t.Contracts.throwIfNullOrWhitespace(r,"region");const a=new n;return a.properties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,s),a.properties.setProperty(i.PropertyId.SpeechServiceConnection_Region,r),a}static fromHost(s,r){t.Contracts.throwIfNull(s,"hostName");const a=new n;return a.setProperty(i.PropertyId.SpeechServiceConnection_Host,s.protocol+"//"+s.hostname+(s.port===""?"":":"+s.port)),r!==void 0&&a.setProperty(i.PropertyId.SpeechServiceConnection_Key,r),a}static fromEndpoint(s,r){t.Contracts.throwIfNull(s,"endpoint");const a=typeof r=="string"&&r.trim().length>0,c=typeof r=="object"&&r!==null&&typeof r.getToken=="function",p=typeof r=="object"&&r!==null&&typeof r.key=="string";if(r!==void 0&&!a&&!c&&!p)throw new Error("Invalid 'auth' parameter: expected a non-empty API key string, a TokenCredential, or a KeyCredential.");let d;return typeof r=="string"?(d=new n,d.setProperty(i.PropertyId.SpeechServiceConnection_Key,r)):typeof r=="object"&&typeof r.getToken=="function"?d=new n(r):typeof r=="object"&&typeof r.key=="string"?(d=new n,d.setProperty(i.PropertyId.SpeechServiceConnection_Key,r.key)):d=new n,d.setProperty(i.PropertyId.SpeechServiceConnection_Endpoint,s.href),d}};Ce.SpeechTranslationConfig=u;class n extends u{constructor(s){super(),this.privSpeechProperties=new i.PropertyCollection,this.outputFormat=i.OutputFormat.Simple,this.privTokenCredential=s}set authorizationToken(s){t.Contracts.throwIfNullOrWhitespace(s,"value"),this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,s)}set speechRecognitionLanguage(s){t.Contracts.throwIfNullOrWhitespace(s,"value"),this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,s)}get speechRecognitionLanguage(){return this.privSpeechProperties.getProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_RecoLanguage])}get subscriptionKey(){return this.privSpeechProperties.getProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_Key])}get outputFormat(){return i.OutputFormat[this.privSpeechProperties.getProperty(e.OutputFormatPropertyName,void 0)]}set outputFormat(s){this.privSpeechProperties.setProperty(e.OutputFormatPropertyName,i.OutputFormat[s])}get endpointId(){return this.privSpeechProperties.getProperty(i.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(s){this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_EndpointId,s)}addTargetLanguage(s){t.Contracts.throwIfNullOrWhitespace(s,"value");const r=this.targetLanguages;r.includes(s)||(r.push(s),this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_TranslationToLanguages,r.join(",")))}get targetLanguages(){return this.privSpeechProperties.getProperty(i.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?this.privSpeechProperties.getProperty(i.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","):[]}get voiceName(){return this.getProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_TranslationVoice])}set voiceName(s){t.Contracts.throwIfNullOrWhitespace(s,"value"),this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_TranslationVoice,s)}get region(){return this.privSpeechProperties.getProperty(i.PropertyId.SpeechServiceConnection_Region)}get tokenCredential(){return this.privTokenCredential}setProxy(s,r,a,c){this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyHostName],s),this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyPort],r),this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyUserName],a),this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyPassword],c)}getProperty(s,r){return this.privSpeechProperties.getProperty(s,r)}setProperty(s,r){this.privSpeechProperties.setProperty(s,r)}get properties(){return this.privSpeechProperties}close(){}setServiceProperty(s,r){const a=JSON.parse(this.privSpeechProperties.getProperty(e.ServicePropertiesPropertyName,"{}"));a[s]=r,this.privSpeechProperties.setProperty(e.ServicePropertiesPropertyName,JSON.stringify(a))}setProfanity(s){this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceResponse_ProfanityOption,i.ProfanityOption[s])}enableAudioLogging(){this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privSpeechProperties.setProperty(e.ForceDictationPropertyName,"true")}get speechSynthesisLanguage(){return this.privSpeechProperties.getProperty(i.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(s){this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_SynthLanguage,s)}get speechSynthesisVoiceName(){return this.privSpeechProperties.getProperty(i.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(s){this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_SynthVoice,s)}get speechSynthesisOutputFormat(){return i.SpeechSynthesisOutputFormat[this.privSpeechProperties.getProperty(i.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(s){this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_SynthOutputFormat,i.SpeechSynthesisOutputFormat[s])}}return Ce.SpeechTranslationConfigImpl=n,Ce}var Nt={},ga;function jp(){if(ga)return Nt;ga=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.PropertyCollection=void 0;const e=A();let t=class zp{constructor(){this.privKeys=[],this.privValues=[]}getProperty(u,n){let o;typeof u=="string"?o=u:o=e.PropertyId[u];for(let s=0;s<this.privKeys.length;s++)if(this.privKeys[s]===o)return this.privValues[s];if(n!==void 0)return String(n)}setProperty(u,n){let o;typeof u=="string"?o=u:o=e.PropertyId[u];for(let s=0;s<this.privKeys.length;s++)if(this.privKeys[s]===o){this.privValues[s]=n;return}this.privKeys.push(o),this.privValues.push(n)}clone(){const u=new zp;for(let n=0;n<this.privKeys.length;n++)u.privKeys.push(this.privKeys[n]),u.privValues.push(this.privValues[n]);return u}mergeTo(u){this.privKeys.forEach(n=>{if(u.getProperty(n,void 0)===void 0){const o=this.getProperty(n);u.setProperty(n,o)}})}get keys(){return this.privKeys}};return Nt.PropertyCollection=t,Nt}var yn={},ma;function Ps(){return ma||(ma=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PropertyId=void 0,(function(t){t[t.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",t[t.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",t[t.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",t[t.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",t[t.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",t[t.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",t[t.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",t[t.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",t[t.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",t[t.SpeechServiceConnection_TranslationCategoryId=9]="SpeechServiceConnection_TranslationCategoryId",t[t.SpeechServiceConnection_ProxyHostName=10]="SpeechServiceConnection_ProxyHostName",t[t.SpeechServiceConnection_ProxyPort=11]="SpeechServiceConnection_ProxyPort",t[t.SpeechServiceConnection_ProxyUserName=12]="SpeechServiceConnection_ProxyUserName",t[t.SpeechServiceConnection_ProxyPassword=13]="SpeechServiceConnection_ProxyPassword",t[t.SpeechServiceConnection_RecoMode=14]="SpeechServiceConnection_RecoMode",t[t.SpeechServiceConnection_RecoLanguage=15]="SpeechServiceConnection_RecoLanguage",t[t.Speech_SessionId=16]="Speech_SessionId",t[t.SpeechServiceConnection_SynthLanguage=17]="SpeechServiceConnection_SynthLanguage",t[t.SpeechServiceConnection_SynthVoice=18]="SpeechServiceConnection_SynthVoice",t[t.SpeechServiceConnection_SynthOutputFormat=19]="SpeechServiceConnection_SynthOutputFormat",t[t.SpeechServiceConnection_AutoDetectSourceLanguages=20]="SpeechServiceConnection_AutoDetectSourceLanguages",t[t.SpeechServiceResponse_RequestDetailedResultTrueFalse=21]="SpeechServiceResponse_RequestDetailedResultTrueFalse",t[t.SpeechServiceResponse_RequestProfanityFilterTrueFalse=22]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",t[t.SpeechServiceResponse_JsonResult=23]="SpeechServiceResponse_JsonResult",t[t.SpeechServiceResponse_JsonErrorDetails=24]="SpeechServiceResponse_JsonErrorDetails",t[t.CancellationDetails_Reason=25]="CancellationDetails_Reason",t[t.CancellationDetails_ReasonText=26]="CancellationDetails_ReasonText",t[t.CancellationDetails_ReasonDetailedText=27]="CancellationDetails_ReasonDetailedText",t[t.SpeechServiceConnection_Url=28]="SpeechServiceConnection_Url",t[t.SpeechServiceConnection_InitialSilenceTimeoutMs=29]="SpeechServiceConnection_InitialSilenceTimeoutMs",t[t.SpeechServiceConnection_EndSilenceTimeoutMs=30]="SpeechServiceConnection_EndSilenceTimeoutMs",t[t.Speech_SegmentationSilenceTimeoutMs=31]="Speech_SegmentationSilenceTimeoutMs",t[t.Speech_SegmentationMaximumTimeMs=32]="Speech_SegmentationMaximumTimeMs",t[t.Speech_SegmentationStrategy=33]="Speech_SegmentationStrategy",t[t.Speech_StartEventSensitivity=34]="Speech_StartEventSensitivity",t[t.SpeechServiceConnection_EnableAudioLogging=35]="SpeechServiceConnection_EnableAudioLogging",t[t.SpeechServiceConnection_LanguageIdMode=36]="SpeechServiceConnection_LanguageIdMode",t[t.SpeechServiceConnection_RecognitionEndpointVersion=37]="SpeechServiceConnection_RecognitionEndpointVersion",t[t.SpeechServiceResponse_ProfanityOption=38]="SpeechServiceResponse_ProfanityOption",t[t.SpeechServiceResponse_PostProcessingOption=39]="SpeechServiceResponse_PostProcessingOption",t[t.SpeechServiceResponse_RequestWordLevelTimestamps=40]="SpeechServiceResponse_RequestWordLevelTimestamps",t[t.SpeechServiceResponse_StablePartialResultThreshold=41]="SpeechServiceResponse_StablePartialResultThreshold",t[t.SpeechServiceResponse_OutputFormatOption=42]="SpeechServiceResponse_OutputFormatOption",t[t.SpeechServiceResponse_TranslationRequestStablePartialResult=43]="SpeechServiceResponse_TranslationRequestStablePartialResult",t[t.SpeechServiceResponse_RequestWordBoundary=44]="SpeechServiceResponse_RequestWordBoundary",t[t.SpeechServiceResponse_RequestPunctuationBoundary=45]="SpeechServiceResponse_RequestPunctuationBoundary",t[t.SpeechServiceResponse_RequestSentenceBoundary=46]="SpeechServiceResponse_RequestSentenceBoundary",t[t.SpeechServiceResponse_DiarizeIntermediateResults=47]="SpeechServiceResponse_DiarizeIntermediateResults",t[t.Conversation_ApplicationId=48]="Conversation_ApplicationId",t[t.Conversation_DialogType=49]="Conversation_DialogType",t[t.Conversation_Initial_Silence_Timeout=50]="Conversation_Initial_Silence_Timeout",t[t.Conversation_From_Id=51]="Conversation_From_Id",t[t.Conversation_Conversation_Id=52]="Conversation_Conversation_Id",t[t.Conversation_Custom_Voice_Deployment_Ids=53]="Conversation_Custom_Voice_Deployment_Ids",t[t.Conversation_Speech_Activity_Template=54]="Conversation_Speech_Activity_Template",t[t.Conversation_Request_Bot_Status_Messages=55]="Conversation_Request_Bot_Status_Messages",t[t.Conversation_Agent_Connection_Id=56]="Conversation_Agent_Connection_Id",t[t.SpeechServiceConnection_Host=57]="SpeechServiceConnection_Host",t[t.ConversationTranslator_Host=58]="ConversationTranslator_Host",t[t.ConversationTranslator_Name=59]="ConversationTranslator_Name",t[t.ConversationTranslator_CorrelationId=60]="ConversationTranslator_CorrelationId",t[t.ConversationTranslator_Token=61]="ConversationTranslator_Token",t[t.PronunciationAssessment_ReferenceText=62]="PronunciationAssessment_ReferenceText",t[t.PronunciationAssessment_GradingSystem=63]="PronunciationAssessment_GradingSystem",t[t.PronunciationAssessment_Granularity=64]="PronunciationAssessment_Granularity",t[t.PronunciationAssessment_EnableMiscue=65]="PronunciationAssessment_EnableMiscue",t[t.PronunciationAssessment_Json=66]="PronunciationAssessment_Json",t[t.PronunciationAssessment_Params=67]="PronunciationAssessment_Params",t[t.WebWorkerLoadType=68]="WebWorkerLoadType",t[t.TalkingAvatarService_WebRTC_SDP=69]="TalkingAvatarService_WebRTC_SDP"})(e.PropertyId||(e.PropertyId={}))})(yn)),yn}var zt={},Sa;function sv(){if(Sa)return zt;Sa=1,Object.defineProperty(zt,"__esModule",{value:!0}),zt.Recognizer=void 0;const e=w(),t=b(),i=D(),u=A();let n=class Lp{constructor(s,r,a,c){this.audioConfig=s!==void 0?s:u.AudioConfig.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=r.clone(),this.privConnectionFactory=a,this.tokenCredential=c,this.implCommonRecognizerSetup()}close(s,r){i.Contracts.throwIfDisposed(this.privDisposed),(0,t.marshalPromiseToCallbacks)(this.dispose(!0),s,r)}get internalData(){return this.privReco}async dispose(s){this.privDisposed||(this.privDisposed=!0,s&&this.privReco&&(await this.privReco.audioSource.turnOff(),await this.privReco.dispose()))}static get telemetryEnabled(){return e.ServiceRecognizerBase.telemetryDataEnabled}static enableTelemetry(s){e.ServiceRecognizerBase.telemetryDataEnabled=s}implCommonRecognizerSetup(){let s=typeof window<"u"?"Browser":"Node",r="unknown",a="unknown";typeof navigator<"u"&&(s=s+"/"+navigator.platform,r=navigator.userAgent,a=navigator.appVersion);const c=this.createRecognizerConfig(new e.SpeechServiceConfig(new e.Context(new e.OS(s,r,a))));this.privReco=this.createServiceRecognizer(Lp.getAuth(this.privProperties,this.tokenCredential),this.privConnectionFactory,this.audioConfig,c)}async recognizeOnceAsyncImpl(s){i.Contracts.throwIfDisposed(this.privDisposed);const r=new t.Deferred;await this.implRecognizerStop(),await this.privReco.recognize(s,r.resolve,r.reject);const a=await r.promise;return await this.implRecognizerStop(),a}async startContinuousRecognitionAsyncImpl(s){i.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop(),await this.privReco.recognize(s,void 0,void 0)}async stopContinuousRecognitionAsyncImpl(){i.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop()}async implRecognizerStop(){this.privReco&&await this.privReco.stopRecognizing()}static getAuth(s,r){const a=s.getProperty(u.PropertyId.SpeechServiceConnection_Key,void 0);return a&&a!==""?new e.CognitiveSubscriptionKeyAuthentication(a):r?new e.CognitiveTokenAuthentication(async()=>{try{const c=await r.getToken("https://cognitiveservices.azure.com/.default");return(c==null?void 0:c.token)??""}catch(c){throw c}},async()=>{try{const c=await r.getToken("https://cognitiveservices.azure.com/.default");return(c==null?void 0:c.token)??""}catch(c){throw c}}):new e.CognitiveTokenAuthentication(()=>{const c=s.getProperty(u.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(c)},()=>{const c=s.getProperty(u.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(c)})}};return zt.Recognizer=n,zt}var jt={},Rn={},Ca;function Y(){return Ca||(Ca=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechStartEventSensitivity=e.RecognitionMode=void 0,(function(t){t.Interactive="Interactive",t.Dictation="Dictation",t.Conversation="Conversation",t.None="None"})(e.RecognitionMode||(e.RecognitionMode={})),(function(t){t.Low="low",t.Medium="medium",t.High="high"})(e.SpeechStartEventSensitivity||(e.SpeechStartEventSensitivity={}))})(Rn)),Rn}var ya;function ov(){if(ya)return jt;ya=1,Object.defineProperty(jt,"__esModule",{value:!0}),jt.SpeechRecognizer=void 0;const e=w(),t=Y(),i=b(),u=D(),n=A();let o=class qp extends n.Recognizer{constructor(r,a){const c=r;u.Contracts.throwIfNull(c,"speechConfig"),u.Contracts.throwIfNullOrWhitespace(c.properties.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage),n.PropertyId[n.PropertyId.SpeechServiceConnection_RecoLanguage]),super(a,c.properties,new e.SpeechConnectionFactory,r.tokenCredential),this.privDisposedRecognizer=!1}static FromConfig(r,a,c){const p=r;return a.properties.mergeTo(p.properties),new qp(r,c)}get endpointId(){return u.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(n.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(n.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(r){u.Contracts.throwIfNullOrWhitespace(r,"token"),this.properties.setProperty(n.PropertyId.SpeechServiceAuthorization_Token,r)}get speechRecognitionLanguage(){return u.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return u.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(e.OutputFormatPropertyName,n.OutputFormat[n.OutputFormat.Simple])===n.OutputFormat[n.OutputFormat.Simple]?n.OutputFormat.Simple:n.OutputFormat.Detailed}get properties(){return this.privProperties}recognizeOnceAsync(r,a){(0,i.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(t.RecognitionMode.Interactive),r,a)}startContinuousRecognitionAsync(r,a){(0,i.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(this.properties.getProperty(e.ForceDictationPropertyName,void 0)===void 0?t.RecognitionMode.Conversation:t.RecognitionMode.Dictation),r,a)}stopContinuousRecognitionAsync(r,a){(0,i.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),r,a)}startKeywordRecognitionAsync(r,a,c){u.Contracts.throwIfNull(r,"model"),c&&c("Not yet implemented.")}stopKeywordRecognitionAsync(r){r&&r()}close(r,a){u.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,i.marshalPromiseToCallbacks)(this.dispose(!0),r,a)}async dispose(r){this.privDisposedRecognizer||(r&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(r))}createRecognizerConfig(r){return new e.RecognizerConfig(r,this.privProperties)}createServiceRecognizer(r,a,c,p){const d=c;return new e.SpeechServiceRecognizer(r,a,d,p,this)}};return jt.SpeechRecognizer=o,jt}var Lt={},qt={},ye={},Ra;function Bp(){if(Ra)return ye;Ra=1,Object.defineProperty(ye,"__esModule",{value:!0}),ye.ConnectionMessageImpl=ye.ConnectionMessage=void 0;const e=V(),t=b(),i=jp(),u=Ps();let n=class{};ye.ConnectionMessage=n;class o{constructor(r){this.privConnectionMessage=r,this.privProperties=new i.PropertyCollection,this.privConnectionMessage.headers[e.HeaderNames.ConnectionId]&&this.privProperties.setProperty(u.PropertyId.Speech_SessionId,this.privConnectionMessage.headers[e.HeaderNames.ConnectionId]),Object.keys(this.privConnectionMessage.headers).forEach(a=>{this.privProperties.setProperty(a,this.privConnectionMessage.headers[a])})}get path(){return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find(r=>r.toLowerCase()==="path".toLowerCase())]}get isTextMessage(){return this.privConnectionMessage.messageType===t.MessageType.Text}get isBinaryMessage(){return this.privConnectionMessage.messageType===t.MessageType.Binary}get TextMessage(){return this.privConnectionMessage.textBody}get binaryMessage(){return this.privConnectionMessage.binaryBody}get properties(){return this.privProperties}toString(){return""}}return ye.ConnectionMessageImpl=o,ye}var Pa;function Fp(){if(Pa)return qt;Pa=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.Connection=void 0;const e=w(),t=b(),i=Bp(),u=D(),n=A();let o=class ls{static fromRecognizer(r){const a=r.internalData,c=new ls;return c.privInternalData=a,c.setupEvents(),c}static fromSynthesizer(r){const a=r.internalData,c=new ls;return c.privInternalData=a,c.setupEvents(),c}openConnection(r,a){(0,t.marshalPromiseToCallbacks)(this.privInternalData.connect(),r,a)}closeConnection(r,a){if(this.privInternalData instanceof e.SynthesisAdapterBase)throw new Error("Disconnecting a synthesizer's connection is currently not supported");(0,t.marshalPromiseToCallbacks)(this.privInternalData.disconnect(),r,a)}setMessageProperty(r,a,c){if(u.Contracts.throwIfNullOrWhitespace(a,"propertyName"),this.privInternalData instanceof e.ServiceRecognizerBase){if(r.toLowerCase()!=="speech.context")throw new Error("Only speech.context message property sets are currently supported for recognizer");{const p=this.privInternalData.speechContext.getContext();p[a]=c}}else if(this.privInternalData instanceof e.SynthesisAdapterBase){if(r.toLowerCase()!=="speech.config"&&r.toLowerCase()!=="synthesis.context")throw new Error("Only speech.config and synthesis.context message paths are currently supported for synthesizer");if(r.toLowerCase()==="speech.config"){if(a.toLowerCase()!=="context")throw new Error("Only context property is currently supported for speech.config message path for synthesizer");this.privInternalData.synthesizerConfig.setContextFromJson(c)}else this.privInternalData.synthesisContext.setSection(a,c)}}sendMessageAsync(r,a,c,p){(0,t.marshalPromiseToCallbacks)(this.privInternalData.sendNetworkMessage(r,a),c,p)}close(){}setupEvents(){this.privEventListener=this.privInternalData.connectionEvents.attach(r=>{r.name==="ConnectionEstablishedEvent"?this.connected&&this.connected(new n.ConnectionEventArgs(r.connectionId)):r.name==="ConnectionClosedEvent"?this.disconnected&&this.disconnected(new n.ConnectionEventArgs(r.connectionId)):r.name==="ConnectionMessageSentEvent"?this.messageSent&&this.messageSent(new n.ConnectionMessageEventArgs(new i.ConnectionMessageImpl(r.message))):r.name==="ConnectionMessageReceivedEvent"&&this.messageReceived&&this.messageReceived(new n.ConnectionMessageEventArgs(new i.ConnectionMessageImpl(r.message)))}),this.privServiceEventListener=this.privInternalData.serviceEvents.attach(r=>{this.receivedServiceMessage&&this.receivedServiceMessage(new n.ServiceEventArgs(r.jsonString,r.name))})}};return qt.Connection=o,qt}var Ea;function av(){if(Ea)return Lt;Ea=1,Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.TranslationRecognizer=void 0;const e=w(),t=Y(),i=b(),u=Fp(),n=D(),o=A();let s=class xp extends o.Recognizer{constructor(a,c,p){const d=a;n.Contracts.throwIfNull(d,"speechConfig"),super(c,d.properties,p||new e.TranslationConnectionFactory,a.tokenCredential),this.privDisposedTranslationRecognizer=!1,this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&n.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationVoice),o.PropertyId[o.PropertyId.SpeechServiceConnection_TranslationVoice]),n.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages),o.PropertyId[o.PropertyId.SpeechServiceConnection_TranslationToLanguages]),n.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(o.PropertyId.SpeechServiceConnection_RecoLanguage),o.PropertyId[o.PropertyId.SpeechServiceConnection_RecoLanguage])}static FromConfig(a,c,p){const d=a;return c.properties.mergeTo(d.properties),c.properties.getProperty(o.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)===e.AutoDetectSourceLanguagesOpenRangeOptionName&&d.properties.setProperty(o.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),new xp(a,p)}get speechRecognitionLanguage(){return n.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(o.PropertyId.SpeechServiceConnection_RecoLanguage)}get targetLanguages(){return n.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",")}get voiceName(){return n.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(o.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){this.properties.setProperty(o.PropertyId.SpeechServiceAuthorization_Token,a)}recognizeOnceAsync(a,c){n.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),(0,i.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(t.RecognitionMode.Interactive),a,c)}startContinuousRecognitionAsync(a,c){(0,i.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(t.RecognitionMode.Conversation),a,c)}stopContinuousRecognitionAsync(a,c){(0,i.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),a,c)}removeTargetLanguage(a){if(n.Contracts.throwIfNullOrUndefined(a,"language to be removed"),this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0){const c=this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),p=c.indexOf(a);p>-1&&(c.splice(p,1),this.properties.setProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages,c.join(",")),this.updateLanguages(c))}}addTargetLanguage(a){n.Contracts.throwIfNullOrUndefined(a,"language to be added");let c=[];this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?(c=this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),c.includes(a)||(c.push(a),this.properties.setProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages,c.join(",")))):(this.properties.setProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages,a),c=[a]),this.updateLanguages(c)}close(a,c){n.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),(0,i.marshalPromiseToCallbacks)(this.dispose(!0),a,c)}onConnection(){}async dispose(a){this.privDisposedTranslationRecognizer||(this.privDisposedTranslationRecognizer=!0,a&&(await this.implRecognizerStop(),await super.dispose(a)))}createRecognizerConfig(a){return new e.RecognizerConfig(a,this.privProperties)}createServiceRecognizer(a,c,p,d){const l=p;return new e.TranslationServiceRecognizer(a,c,l,d,this)}updateLanguages(a){const c=u.Connection.fromRecognizer(this);c&&(c.setMessageProperty("speech.context","translationcontext",{to:a}),c.sendMessageAsync("event",JSON.stringify({id:"translation",name:"updateLanguage",to:a})))}};return Lt.TranslationRecognizer=s,Lt}var Bt={},Ta;function cv(){if(Ta)return Bt;Ta=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.Translations=void 0;const e=A();let t=class{constructor(){this.privMap=new e.PropertyCollection}get languages(){return this.privMap.keys}get(u,n){return this.privMap.getProperty(u,n)}set(u,n){this.privMap.setProperty(u,n)}};return Bt.Translations=t,Bt}var Pn={},Aa;function uv(){return Aa||(Aa=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NoMatchReason=void 0,(function(t){t[t.NotRecognized=0]="NotRecognized",t[t.InitialSilenceTimeout=1]="InitialSilenceTimeout",t[t.InitialBabbleTimeout=2]="InitialBabbleTimeout"})(e.NoMatchReason||(e.NoMatchReason={}))})(Pn)),Pn}var Ft={},Ia;function pv(){if(Ia)return Ft;Ia=1,Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.NoMatchDetails=void 0;const e=w(),t=A();let i=class Up{constructor(n){this.privReason=n}static fromResult(n){const o=e.SimpleSpeechPhrase.fromJSON(n.json,0);let s=t.NoMatchReason.NotRecognized;switch(o.RecognitionStatus){case e.RecognitionStatus.BabbleTimeout:s=t.NoMatchReason.InitialBabbleTimeout;break;case e.RecognitionStatus.InitialSilenceTimeout:s=t.NoMatchReason.InitialSilenceTimeout;break;default:s=t.NoMatchReason.NotRecognized;break}return new Up(s)}get reason(){return this.privReason}};return Ft.NoMatchDetails=i,Ft}var xt={},wa;function dv(){if(wa)return xt;wa=1,Object.defineProperty(xt,"__esModule",{value:!0}),xt.TranslationRecognitionCanceledEventArgs=void 0;let e=class{constructor(i,u,n,o,s){this.privCancelReason=u,this.privErrorDetails=n,this.privResult=s,this.privSessionId=i,this.privErrorCode=o}get result(){return this.privResult}get sessionId(){return this.privSessionId}get reason(){return this.privCancelReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return xt.TranslationRecognitionCanceledEventArgs=e,xt}var Ut={},_a;function Wp(){if(_a)return Ut;_a=1,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.CancellationDetailsBase=void 0;let e=class{constructor(i,u,n){this.privReason=i,this.privErrorDetails=u,this.privErrorCode=n}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get ErrorCode(){return this.privErrorCode}};return Ut.CancellationDetailsBase=e,Ut}var Wt={},ba;function hv(){if(ba)return Wt;ba=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.CancellationDetails=void 0;const e=w(),t=Wp(),i=A();let u=class Hp extends t.CancellationDetailsBase{constructor(o,s,r){super(o,s,r)}static fromResult(o){let s=i.CancellationReason.Error,r=i.CancellationErrorCode.NoError;if(o instanceof i.RecognitionResult&&o.json){const a=e.SimpleSpeechPhrase.fromJSON(o.json,0);s=e.EnumTranslation.implTranslateCancelResult(a.RecognitionStatus)}return o.properties&&(r=i.CancellationErrorCode[o.properties.getProperty(e.CancellationErrorCodePropertyName,i.CancellationErrorCode[i.CancellationErrorCode.NoError])]),new Hp(s,o.errorDetails||e.EnumTranslation.implTranslateErrorDetails(r),r)}};return Wt.CancellationDetails=u,Wt}var En={},Ma;function lv(){return Ma||(Ma=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CancellationErrorCode=void 0,(function(t){t[t.NoError=0]="NoError",t[t.AuthenticationFailure=1]="AuthenticationFailure",t[t.BadRequestParameters=2]="BadRequestParameters",t[t.TooManyRequests=3]="TooManyRequests",t[t.ConnectionFailure=4]="ConnectionFailure",t[t.ServiceTimeout=5]="ServiceTimeout",t[t.ServiceError=6]="ServiceError",t[t.RuntimeError=7]="RuntimeError",t[t.Forbidden=8]="Forbidden"})(e.CancellationErrorCode||(e.CancellationErrorCode={}))})(En)),En}var Ht={},Oa;function vv(){if(Oa)return Ht;Oa=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.ConnectionEventArgs=void 0;const e=A();let t=class extends e.SessionEventArgs{};return Ht.ConnectionEventArgs=t,Ht}var Kt={},Da;function fv(){if(Da)return Kt;Da=1,Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.ServiceEventArgs=void 0;const e=A();let t=class extends e.SessionEventArgs{constructor(u,n,o){super(o),this.privJsonResult=u,this.privEventName=n}get jsonString(){return this.privJsonResult}get eventName(){return this.privEventName}};return Kt.ServiceEventArgs=t,Kt}var Vt={},ka;function gv(){if(ka)return Vt;ka=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.PhraseListGrammar=void 0;const e=D();let t=class Kp{constructor(u){this.privGrammerBuilder=u.dynamicGrammar}static fromRecognizer(u){const n=u.internalData;return new Kp(n)}addPhrase(u){this.privGrammerBuilder.addPhrase(u)}addPhrases(u){this.privGrammerBuilder.addPhrase(u)}clear(){this.privGrammerBuilder.clearPhrases()}setWeight(u){e.Contracts.throwIfNumberOutOfRange(u,"weight",0,2),this.privGrammerBuilder.setWeight(u)}};return Vt.PhraseListGrammar=t,Vt}var Re={},Na;function Es(){if(Na)return Re;Na=1,Object.defineProperty(Re,"__esModule",{value:!0}),Re.DialogServiceConfigImpl=Re.DialogServiceConfig=void 0;const e=D(),t=A();let i=class{constructor(){}set applicationId(o){}static get DialogTypes(){return{BotFramework:"bot_framework",CustomCommands:"custom_commands"}}};Re.DialogServiceConfig=i;class u extends i{constructor(){super(),this.privSpeechConfig=new t.SpeechConfigImpl}get properties(){return this.privSpeechConfig.properties}get speechRecognitionLanguage(){return this.privSpeechConfig.speechRecognitionLanguage}set speechRecognitionLanguage(o){e.Contracts.throwIfNullOrWhitespace(o,"value"),this.privSpeechConfig.speechRecognitionLanguage=o}get outputFormat(){return this.privSpeechConfig.outputFormat}set outputFormat(o){this.privSpeechConfig.outputFormat=o}setProperty(o,s){this.privSpeechConfig.setProperty(o,s)}getProperty(o,s){return this.privSpeechConfig.getProperty(o)}setProxy(o,s,r,a){this.setProperty(t.PropertyId.SpeechServiceConnection_ProxyHostName,o),this.setProperty(t.PropertyId.SpeechServiceConnection_ProxyPort,`${s}`),r&&this.setProperty(t.PropertyId.SpeechServiceConnection_ProxyUserName,r),a&&this.setProperty(t.PropertyId.SpeechServiceConnection_ProxyPassword,a)}setServiceProperty(o,s,r){this.privSpeechConfig.setServiceProperty(o,s)}close(){}}return Re.DialogServiceConfigImpl=u,Re}var Jt={},za;function mv(){if(za)return Jt;za=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.BotFrameworkConfig=void 0;const e=D(),t=Es(),i=A();let u=class extends t.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(o,s,r){e.Contracts.throwIfNullOrWhitespace(o,"subscription"),e.Contracts.throwIfNullOrWhitespace(s,"region");const a=new t.DialogServiceConfigImpl;return a.setProperty(i.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.BotFramework),a.setProperty(i.PropertyId.SpeechServiceConnection_Key,o),a.setProperty(i.PropertyId.SpeechServiceConnection_Region,s),r&&a.setProperty(i.PropertyId.Conversation_ApplicationId,r),a}static fromAuthorizationToken(o,s,r){e.Contracts.throwIfNullOrWhitespace(o,"authorizationToken"),e.Contracts.throwIfNullOrWhitespace(s,"region");const a=new t.DialogServiceConfigImpl;return a.setProperty(i.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.BotFramework),a.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,o),a.setProperty(i.PropertyId.SpeechServiceConnection_Region,s),r&&a.setProperty(i.PropertyId.Conversation_ApplicationId,r),a}static fromHost(o,s,r){e.Contracts.throwIfNullOrUndefined(o,"host");const a=o instanceof URL?o:new URL(`wss://${o}.convai.speech.azure.us`);e.Contracts.throwIfNullOrUndefined(a,"resolvedHost");const c=new t.DialogServiceConfigImpl;return c.setProperty(i.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.BotFramework),c.setProperty(i.PropertyId.SpeechServiceConnection_Host,a.toString()),s!==void 0&&c.setProperty(i.PropertyId.SpeechServiceConnection_Key,s),c}static fromEndpoint(o,s){e.Contracts.throwIfNull(o,"endpoint");const r=new t.DialogServiceConfigImpl;return r.setProperty(i.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.BotFramework),r.setProperty(i.PropertyId.SpeechServiceConnection_Endpoint,o.toString()),s!==void 0&&r.setProperty(i.PropertyId.SpeechServiceConnection_Key,s),r}};return Jt.BotFrameworkConfig=u,Jt}var Gt={},ja;function Sv(){if(ja)return Gt;ja=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.CustomCommandsConfig=void 0;const e=D(),t=Es(),i=A();let u=class extends t.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(o,s,r){e.Contracts.throwIfNullOrWhitespace(o,"applicationId"),e.Contracts.throwIfNullOrWhitespace(s,"subscription"),e.Contracts.throwIfNullOrWhitespace(r,"region");const a=new t.DialogServiceConfigImpl;return a.setProperty(i.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.CustomCommands),a.setProperty(i.PropertyId.Conversation_ApplicationId,o),a.setProperty(i.PropertyId.SpeechServiceConnection_Key,s),a.setProperty(i.PropertyId.SpeechServiceConnection_Region,r),a}static fromAuthorizationToken(o,s,r){e.Contracts.throwIfNullOrWhitespace(o,"applicationId"),e.Contracts.throwIfNullOrWhitespace(s,"authorizationToken"),e.Contracts.throwIfNullOrWhitespace(r,"region");const a=new t.DialogServiceConfigImpl;return a.setProperty(i.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.CustomCommands),a.setProperty(i.PropertyId.Conversation_ApplicationId,o),a.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,s),a.setProperty(i.PropertyId.SpeechServiceConnection_Region,r),a}set applicationId(o){e.Contracts.throwIfNullOrWhitespace(o,"value"),this.setProperty(i.PropertyId.Conversation_ApplicationId,o)}get applicationId(){return this.getProperty(i.PropertyId.Conversation_ApplicationId)}};return Gt.CustomCommandsConfig=u,Gt}var Qt={},Xt={},Zt={},Yt={},La;function pe(){if(La)return Yt;La=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.QueryParameterNames=void 0;let e=class{};return Yt.QueryParameterNames=e,e.BotId="botid",e.CustomSpeechDeploymentId="cid",e.CustomVoiceDeploymentId="deploymentId",e.EnableAudioLogging="storeAudio",e.EnableLanguageId="lidEnabled",e.EnableWordLevelTimestamps="wordLevelTimestamps",e.EndSilenceTimeoutMs="endSilenceTimeoutMs",e.SegmentationSilenceTimeoutMs="segmentationSilenceTimeoutMs",e.SegmentationMaximumTimeMs="segmentationMaximumTimeMs",e.SegmentationStrategy="segmentationStrategy",e.Format="format",e.InitialSilenceTimeoutMs="initialSilenceTimeoutMs",e.Language="language",e.Profanity="profanity",e.RequestBotStatusMessages="enableBotMessageStatus",e.StableIntermediateThreshold="stableIntermediateThreshold",e.StableTranslation="stableTranslation",e.TestHooks="testhooks",e.Postprocessing="postprocessing",e.CtsMeetingId="meetingId",e.CtsDeviceId="deviceId",e.CtsIsParticipant="isParticipant",e.EnableAvatar="enableTalkingAvatar",Yt}var qa;function se(){if(qa)return Zt;qa=1,Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.ConnectionFactoryBase=void 0;const e=w(),t=b(),i=A(),u=pe();let n=class{static getHostSuffix(s){if(s){if(s.toLowerCase().startsWith("china"))return".azure.cn";if(s.toLowerCase().startsWith("usgov"))return".azure.us"}return".microsoft.com"}setCommonUrlParams(s,r,a){new Map([[i.PropertyId.Speech_SegmentationSilenceTimeoutMs,u.QueryParameterNames.SegmentationSilenceTimeoutMs],[i.PropertyId.SpeechServiceConnection_EnableAudioLogging,u.QueryParameterNames.EnableAudioLogging],[i.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,u.QueryParameterNames.EndSilenceTimeoutMs],[i.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,u.QueryParameterNames.InitialSilenceTimeoutMs],[i.PropertyId.SpeechServiceResponse_PostProcessingOption,u.QueryParameterNames.Postprocessing],[i.PropertyId.SpeechServiceResponse_ProfanityOption,u.QueryParameterNames.Profanity],[i.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,u.QueryParameterNames.EnableWordLevelTimestamps],[i.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,u.QueryParameterNames.StableIntermediateThreshold]]).forEach((d,l)=>{this.setUrlParameter(l,d,s,r,a)});const p=JSON.parse(s.parameters.getProperty(e.ServicePropertiesPropertyName,"{}"));Object.keys(p).forEach(d=>{r[d]=p[d]})}setUrlParameter(s,r,a,c,p){const d=a.parameters.getProperty(s,void 0);d&&(!p||p.search(r)===-1)&&(c[r]=d.toLocaleLowerCase())}static async getRedirectUrlFromEndpoint(s){const r=new URL(s);r.protocol="https:",r.port="443",r.searchParams.append("GenerateRedirectResponse","true");const c=r.toString();t.Events.instance.onEvent(new t.ConnectionRedirectEvent("",c,void 0,"ConnectionFactoryBase: redirectUrl request"));const p=await fetch(c);if(p.status!==200)return s;const d=await p.text();t.Events.instance.onEvent(new t.ConnectionRedirectEvent("",d,s,"ConnectionFactoryBase: redirectUrlString"));try{return new URL(d.trim()).toString()}catch{return s}}};return Zt.ConnectionFactoryBase=n,Zt}var Ba;function Cv(){if(Ba)return Xt;Ba=1,Object.defineProperty(Xt,"__esModule",{value:!0}),Xt.DialogConnectionFactory=void 0;const e=U(),t=w(),i=A(),u=se(),n=w(),o=V(),s=pe();class r extends u.ConnectionFactoryBase{create(c,p,d){const l=c.parameters.getProperty(i.PropertyId.Conversation_ApplicationId,""),h=c.parameters.getProperty(i.PropertyId.Conversation_DialogType),g=c.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Region),f=c.parameters.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),m=c.parameters.getProperty(i.PropertyId.Conversation_Request_Bot_Status_Messages,"true"),v={};v[o.HeaderNames.ConnectionId]=d,v[s.QueryParameterNames.Format]=c.parameters.getProperty(t.OutputFormatPropertyName,i.OutputFormat[i.OutputFormat.Simple]).toLowerCase(),v[s.QueryParameterNames.Language]=f,v[s.QueryParameterNames.RequestBotStatusMessages]=m,l&&(v[s.QueryParameterNames.BotId]=l,h===i.DialogServiceConfig.DialogTypes.CustomCommands&&(v[o.HeaderNames.CustomCommandsAppId]=l));const S=h===i.DialogServiceConfig.DialogTypes.CustomCommands?"commands/":"",C=h===i.DialogServiceConfig.DialogTypes.CustomCommands?"v1":h===i.DialogServiceConfig.DialogTypes.BotFramework?"v3":"v0",y={};p.token!=null&&p.token!==""&&(y[p.headerName]=p.token);let R=c.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint,"");if(!R){const E=u.ConnectionFactoryBase.getHostSuffix(g),P=c.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Host,`wss://${g}.${r.BaseUrl}${E}`);R=`${P.endsWith("/")?P:P+"/"}${S}${r.ApiKey}/${C}`}this.setCommonUrlParams(c,v,R);const T=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new e.WebsocketConnection(R,v,y,new n.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(c),T,d))}}return Xt.DialogConnectionFactory=r,r.ApiKey="api",r.BaseUrl="convai.speech",Xt}var Fa;function yv(){if(Fa)return Qt;Fa=1,Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.DialogServiceConnector=void 0;const e=Cv(),t=w(),i=Y(),u=b(),n=D(),o=A(),s=Ps();let r=class extends o.Recognizer{constructor(c,p){const d=c;n.Contracts.throwIfNull(c,"dialogConfig"),super(p,d.properties,new e.DialogConnectionFactory),this.isTurnComplete=!0,this.privIsDisposed=!1,this.privProperties=d.properties.clone();const l=this.buildAgentConfig();this.privReco.agentConfig.set(l)}connect(c,p){(0,u.marshalPromiseToCallbacks)(this.privReco.connect(),c,p)}disconnect(c,p){(0,u.marshalPromiseToCallbacks)(this.privReco.disconnect(),c,p)}get authorizationToken(){return this.properties.getProperty(s.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(c){n.Contracts.throwIfNullOrWhitespace(c,"token"),this.properties.setProperty(s.PropertyId.SpeechServiceAuthorization_Token,c)}get properties(){return this.privProperties}get speechActivityTemplate(){return this.properties.getProperty(s.PropertyId.Conversation_Speech_Activity_Template)}set speechActivityTemplate(c){this.properties.setProperty(s.PropertyId.Conversation_Speech_Activity_Template,c)}listenOnceAsync(c,p){if(this.isTurnComplete){n.Contracts.throwIfDisposed(this.privIsDisposed);const l=(async()=>{await this.privReco.connect(),await this.implRecognizerStop(),this.isTurnComplete=!1;const h=new u.Deferred;await this.privReco.recognize(i.RecognitionMode.Conversation,h.resolve,h.reject);const g=await h.promise;return await this.implRecognizerStop(),g})();l.catch(()=>{this.dispose(!0).catch(()=>{})}),(0,u.marshalPromiseToCallbacks)(l.finally(()=>{this.isTurnComplete=!0}),c,p)}}sendActivityAsync(c,p,d){(0,u.marshalPromiseToCallbacks)(this.privReco.sendMessage(c),p,d)}close(c,p){n.Contracts.throwIfDisposed(this.privIsDisposed),(0,u.marshalPromiseToCallbacks)(this.dispose(!0),c,p)}async dispose(c){this.privIsDisposed||c&&(this.privIsDisposed=!0,await this.implRecognizerStop(),await super.dispose(c))}createRecognizerConfig(c){return new t.RecognizerConfig(c,this.privProperties)}createServiceRecognizer(c,p,d,l){const h=d;return new t.DialogServiceAdapter(c,p,h,l,this)}buildAgentConfig(){return{botInfo:{commType:this.properties.getProperty("Conversation_Communication_Type","Default"),commandsCulture:void 0,connectionId:this.properties.getProperty(s.PropertyId.Conversation_Agent_Connection_Id),conversationId:this.properties.getProperty(s.PropertyId.Conversation_Conversation_Id,void 0),fromId:this.properties.getProperty(s.PropertyId.Conversation_From_Id,void 0),ttsAudioFormat:this.properties.getProperty(s.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)},version:.2}}};return Qt.DialogServiceConnector=r,Qt}var $t={},xa;function Rv(){if(xa)return $t;xa=1,Object.defineProperty($t,"__esModule",{value:!0}),$t.ActivityReceivedEventArgs=void 0;let e=class{constructor(i,u){this.privActivity=i,this.privAudioStream=u}get activity(){return this.privActivity}get audioStream(){return this.privAudioStream}};return $t.ActivityReceivedEventArgs=e,$t}var er={},tr={},Ua;function Pv(){if(Ua)return tr;Ua=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.TurnStatusResponsePayload=void 0;class e{constructor(i){this.privMessageStatusResponse=JSON.parse(i)}static fromJSON(i){return new e(i)}get interactionId(){return this.privMessageStatusResponse.interactionId}get conversationId(){return this.privMessageStatusResponse.conversationId}get statusCode(){switch(this.privMessageStatusResponse.statusCode){case"Success":return 200;case"Failed":return 400;case"TimedOut":return 429;default:return this.privMessageStatusResponse.statusCode}}}return tr.TurnStatusResponsePayload=e,tr}var Wa;function Ev(){if(Wa)return er;Wa=1,Object.defineProperty(er,"__esModule",{value:!0}),er.TurnStatusReceivedEventArgs=void 0;const e=Pv();let t=class{constructor(u){this.privTurnStatus=e.TurnStatusResponsePayload.fromJSON(u)}get interactionId(){return this.privTurnStatus.interactionId}get conversationId(){return this.privTurnStatus.conversationId}get statusCode(){return this.privTurnStatus.statusCode}};return er.TurnStatusReceivedEventArgs=t,er}var Tn={},Ha;function Tv(){return Ha||(Ha=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ServicePropertyChannel=void 0,(function(t){t[t.UriQueryParameter=0]="UriQueryParameter"})(e.ServicePropertyChannel||(e.ServicePropertyChannel={}))})(Tn)),Tn}var An={},Ka;function Av(){return Ka||(Ka=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ProfanityOption=void 0,(function(t){t[t.Masked=0]="Masked",t[t.Removed=1]="Removed",t[t.Raw=2]="Raw"})(e.ProfanityOption||(e.ProfanityOption={}))})(An)),An}var rr={},Va;function Iv(){if(Va)return rr;Va=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.BaseAudioPlayer=void 0;const e=$(),t=A(),i=ke();let u=class{constructor(o){this.audioContext=null,this.gainNode=null,this.autoUpdateBufferTimer=0,o===void 0&&(o=t.AudioStreamFormat.getDefaultInputFormat()),this.init(o)}playAudioSample(o,s,r){try{this.ensureInitializedContext();const a=this.formatAudioData(o),c=new Float32Array(this.samples.length+a.length);c.set(this.samples,0),c.set(a,this.samples.length),this.samples=c,s&&s()}catch(a){r&&r(a)}}stopAudio(o,s){this.audioContext!==null&&(this.samples=new Float32Array,clearInterval(this.autoUpdateBufferTimer),this.audioContext.close().then(()=>{o&&o()},r=>{s&&s(r)}),this.audioContext=null)}init(o){this.audioFormat=o,this.samples=new Float32Array}ensureInitializedContext(){if(this.audioContext===null){this.createAudioContext();const o=200;this.autoUpdateBufferTimer=setInterval(()=>{this.updateAudioBuffer()},o)}}createAudioContext(){this.audioContext=i.AudioStreamFormatImpl.getAudioContext(),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioContext.destination),this.startTime=this.audioContext.currentTime}formatAudioData(o){switch(this.audioFormat.bitsPerSample){case 8:return this.formatArrayBuffer(new Int8Array(o),128);case 16:return this.formatArrayBuffer(new Int16Array(o),32768);case 32:return this.formatArrayBuffer(new Int32Array(o),2147483648);default:throw new e.InvalidOperationError("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}}formatArrayBuffer(o,s){const r=new Float32Array(o.length);for(let a=0;a<o.length;a++)r[a]=o[a]/s;return r}updateAudioBuffer(){if(this.samples.length===0)return;const o=this.audioFormat.channels,s=this.audioContext.createBufferSource(),r=this.samples.length/o,a=this.audioContext.createBuffer(o,r,this.audioFormat.samplesPerSec);for(let c=0;c<o;c++){let p=c;const d=a.getChannelData(c);for(let l=0;l<this.samples.length;l++,p+=o)d[l]=this.samples[p]}this.startTime<this.audioContext.currentTime&&(this.startTime=this.audioContext.currentTime),s.buffer=a,s.connect(this.gainNode),s.start(this.startTime),this.startTime+=a.duration,this.samples=new Float32Array}async playAudio(o){this.audioContext===null&&this.createAudioContext();const s=this.audioContext.createBufferSource(),r=this.audioContext.destination;await this.audioContext.decodeAudioData(o,a=>{s.buffer=a,s.connect(r),s.start(0)})}};return rr.BaseAudioPlayer=u,rr}var ir={},Ja;function wv(){if(Ja)return ir;Ja=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.ConnectionMessageEventArgs=void 0;let e=class{constructor(i){this.privConnectionMessage=i}get message(){return this.privConnectionMessage}toString(){return"Message: "+this.privConnectionMessage.toString()}};return ir.ConnectionMessageEventArgs=e,ir}var nr={},In={},Ga;function Vp(){return Ga||(Ga=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LanguageIdMode=void 0,(function(t){t[t.AtStart=0]="AtStart",t[t.Continuous=1]="Continuous"})(e.LanguageIdMode||(e.LanguageIdMode={}))})(In)),In}var Qa;function _v(){if(Qa)return nr;Qa=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.AutoDetectSourceLanguageConfig=void 0;const e=w(),t=D(),i=A(),u=Vp();let n=class ji{constructor(){this.privProperties=new i.PropertyCollection,this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart"),this.privLanguageIdMode=u.LanguageIdMode.AtStart}static fromOpenRange(){const s=new ji;return s.properties.setProperty(i.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,e.AutoDetectSourceLanguagesOpenRangeOptionName),s.properties.setProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),s}static fromLanguages(s){t.Contracts.throwIfArrayEmptyOrWhitespace(s,"languages");const r=new ji;return r.properties.setProperty(i.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,s.join()),r}static fromSourceLanguageConfigs(s){if(s.length<1)throw new Error("Expected non-empty SourceLanguageConfig array.");const r=new ji,a=[];return s.forEach(c=>{if(a.push(c.language),c.endpointId!==void 0&&c.endpointId!==""){const p=c.language+i.PropertyId.SpeechServiceConnection_EndpointId.toString();r.properties.setProperty(p,c.endpointId)}}),r.properties.setProperty(i.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,a.join()),r}get properties(){return this.privProperties}set mode(s){s===u.LanguageIdMode.Continuous?(this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_LanguageIdMode,"Continuous")):(this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"1"),this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart")),this.privLanguageIdMode=s}};return nr.AutoDetectSourceLanguageConfig=n,nr}var sr={},Xa;function bv(){if(Xa)return sr;Xa=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.AutoDetectSourceLanguageResult=void 0;const e=D();let t=class vs{constructor(u,n){e.Contracts.throwIfNullOrUndefined(u,"language"),e.Contracts.throwIfNullOrUndefined(n,"languageDetectionConfidence"),this.privLanguage=u,this.privLanguageDetectionConfidence=n}static fromResult(u){return new vs(u.language,u.languageDetectionConfidence)}static fromConversationTranscriptionResult(u){return new vs(u.language,u.languageDetectionConfidence)}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}};return sr.AutoDetectSourceLanguageResult=t,sr}var or={},Za;function Mv(){if(Za)return or;Za=1,Object.defineProperty(or,"__esModule",{value:!0}),or.SourceLanguageConfig=void 0;const e=D();let t=class Jp{constructor(u,n){e.Contracts.throwIfNullOrUndefined(u,"language"),this.privLanguage=u,this.privEndpointId=n}static fromLanguage(u,n){return new Jp(u,n)}get language(){return this.privLanguage}get endpointId(){return this.privEndpointId}};return or.SourceLanguageConfig=t,or}var wn={},Pe={},Ya;function Gp(){if(Ya)return Pe;Ya=1,Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.ConversationImpl=Pe.Conversation=void 0;const e=w(),t=b(),i=D(),u=A();let n=class{constructor(){}static createConversationAsync(r,a,c,p){i.Contracts.throwIfNullOrUndefined(r,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),i.Contracts.throwIfNullOrUndefined(r.region,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),!r.subscriptionKey&&!r.getProperty(u.PropertyId[u.PropertyId.SpeechServiceAuthorization_Token])&&i.Contracts.throwIfNullOrUndefined(r.subscriptionKey,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));let d,l,h;return typeof a=="string"?(d=new o(r,a),(0,t.marshalPromiseToCallbacks)((async()=>{})(),c,p)):(d=new o(r),l=a,h=c,d.createConversationAsync((()=>{l&&l()}),g=>{h&&h(g)})),d}};Pe.Conversation=n;class o extends n{constructor(r,a){if(super(),this.privErrors=e.ConversationConnectionConfig.restErrors,this.onConnected=d=>{var l;this.privIsConnected=!0;try{(l=this.privConversationTranslator)!=null&&l.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,d)}catch{}},this.onDisconnected=d=>{var l;try{(l=this.privConversationTranslator)!=null&&l.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,d)}catch{}finally{this.close(!1)}},this.onCanceled=(d,l)=>{var h;try{(h=this.privConversationTranslator)!=null&&h.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,l)}catch{}},this.onParticipantUpdateCommandReceived=(d,l)=>{try{const h=this.privParticipants.getParticipant(l.id);if(h!==void 0){switch(l.key){case e.ConversationTranslatorCommandTypes.changeNickname:h.displayName=l.value;break;case e.ConversationTranslatorCommandTypes.setUseTTS:h.isUsingTts=l.value;break;case e.ConversationTranslatorCommandTypes.setProfanityFiltering:h.profanity=l.value;break;case e.ConversationTranslatorCommandTypes.setMute:h.isMuted=l.value;break;case e.ConversationTranslatorCommandTypes.setTranslateToLanguages:h.translateToLanguages=l.value;break}this.privParticipants.addOrUpdateParticipant(h),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.Updated,[this.toParticipant(h)],l.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(d,l)=>{try{this.privParticipants.participants.forEach(h=>h.isMuted=h.isHost?!1:l.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.Updated,this.toParticipants(!1),l.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(d,l)=>{try{const h=this.privParticipants.addOrUpdateParticipant(l.participant);h!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.JoinedConversation,[this.toParticipant(h)],l.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(d,l)=>{try{const h=this.privParticipants.getParticipant(l.participant.id);h!==void 0&&(this.privParticipants.deleteParticipant(l.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.LeftConversation,[this.toParticipant(h)],l.sessionId)))}catch{}},this.onTranslationReceived=(d,l)=>{try{switch(l.command){case e.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new u.ConversationTranslationEventArgs(l.payload,void 0,l.sessionId));break;case e.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new u.ConversationTranslationEventArgs(l.payload,void 0,l.sessionId));break;case e.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new u.ConversationTranslationEventArgs(l.payload,void 0,l.sessionId));break}}catch{}},this.onParticipantsListReceived=(d,l)=>{var h;try{if(l.sessionToken!==void 0&&l.sessionToken!==null&&(this.privRoom.token=l.sessionToken),this.privParticipants.participants=[...l.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),l.sessionId)),this.me.isHost){const g=(h=this.privConversationTranslator)==null?void 0:h.properties.getProperty(u.PropertyId.ConversationTranslator_Name);g!==void 0&&g.length>0&&g!==this.me.displayName&&this.changeNicknameAsync(g)}}catch{}},this.onConversationExpiration=(d,l)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,l)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new u.PropertyCollection,this.privManager=new e.ConversationManager,r.getProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage])||r.setProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage],e.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=r.getProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage]),a)this.privConversationId=a;else{r.targetLanguages.length===0&&r.addTargetLanguage(this.privLanguage),r.getProperty(u.PropertyId[u.PropertyId.SpeechServiceResponse_ProfanityOption])||r.setProfanity(u.ProfanityOption.Masked);let l=r.getProperty(u.PropertyId[u.PropertyId.ConversationTranslator_Name]);l==null&&(l="Host"),i.Contracts.throwIfNullOrTooLong(l,"nickname",50),i.Contracts.throwIfNullOrTooShort(l,"nickname",2),r.setProperty(u.PropertyId[u.PropertyId.ConversationTranslator_Name],l)}this.privConfig=r;const p=r;i.Contracts.throwIfNull(p,"speechConfig"),this.privProperties=p.properties.clone(),this.privIsConnected=!1,this.privParticipants=new e.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get conversationId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){var r,a;return(r=this.privParticipants.me)!=null&&r.isHost?!1:(a=this.privParticipants.me)==null?void 0:a.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get conversationInfo(){const r=this.conversationId,a=this.participants.map(d=>({id:d.id,preferredLanguage:d.preferredLanguage,voice:d.voice})),c={};for(const d of e.ConversationConnectionConfig.transcriptionEventKeys){const l=this.properties.getProperty(d,"");l!==""&&(c[d]=l)}return{id:r,participants:a,conversationProperties:c}}get canSend(){var r;return this.privIsConnected&&!((r=this.privParticipants.me)!=null&&r.isMuted)}get canSendAsHost(){var r;return this.privIsConnected&&((r=this.privParticipants.me)==null?void 0:r.isHost)}get authorizationToken(){return this.privToken}set authorizationToken(r){i.Contracts.throwIfNullOrWhitespace(r,"authorizationToken"),this.privToken=r}set conversationTranslator(r){this.privConversationTranslator=r}onToken(r){this.privConversationTranslator.onToken(r)}createConversationAsync(r,a){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),a),this.privManager.createOrJoin(this.privProperties,void 0,(c=>{c||this.handleError(new Error(this.privErrors.permissionDeniedConnect),a),this.privRoom=c,this.handleCallback(r,a)}),(c=>{this.handleError(c,a)}))}catch(c){this.handleError(c,a)}}startConversationAsync(r,a){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),a),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer=e.ConversationRecognizerFactory.fromConfig(this,this.privConfig),this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,(()=>{this.handleCallback(r,a)}),(c=>{this.handleError(c,a)}))}catch(c){this.handleError(c,a)}}addParticipantAsync(r,a,c){i.Contracts.throwIfNullOrUndefined(r,"Participant"),(0,t.marshalPromiseToCallbacks)(this.addParticipantImplAsync(r),a,c)}joinConversationAsync(r,a,c,p,d){try{i.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","conversationId")),i.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","nickname")),i.Contracts.throwIfNullOrWhitespace(c,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,r,(l=>{i.Contracts.throwIfNullOrUndefined(l,this.privErrors.permissionDeniedConnect),this.privRoom=l,this.privConfig.authorizationToken=l.cognitiveSpeechAuthToken,p&&p(l.cognitiveSpeechAuthToken)}),(l=>{this.handleError(l,d)}))}catch(l){this.handleError(l,d)}}deleteConversationAsync(r,a){(0,t.marshalPromiseToCallbacks)(this.deleteConversationImplAsync(),r,a)}async deleteConversationImplAsync(){i.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),i.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endConversationAsync(r,a){(0,t.marshalPromiseToCallbacks)(this.endConversationImplAsync(),r,a)}endConversationImplAsync(){return this.close(!0)}lockConversationAsync(r,a){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),a),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),(()=>{this.handleCallback(r,a)}),(c=>{this.handleError(c,a)}))}catch(c){this.handleError(c,a)}}muteAllParticipantsAsync(r,a){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),a),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),(()=>{this.handleCallback(r,a)}),(c=>{this.handleError(c,a)}))}catch(c){this.handleError(c,a)}}muteParticipantAsync(r,a,c){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","userId")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),!this.me.isHost&&this.me.id!==r&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),c),this.privParticipants.getParticipantIndex(r)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(r,!0),(()=>{this.handleCallback(a,c)}),(d=>{this.handleError(d,c)}))}catch(p){this.handleError(p,c)}}removeParticipantAsync(r,a,c){try{if(i.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&r.hasOwnProperty("id"))(0,t.marshalPromiseToCallbacks)(this.removeParticipantImplAsync(r),a,c);else{i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),c);let p="";typeof r=="string"?p=r:r.hasOwnProperty("id")?p=r.id:r.hasOwnProperty("userId")&&(p=r.userId),i.Contracts.throwIfNullOrWhitespace(p,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(l=>l.id===p)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(p),(()=>{this.handleCallback(a,c)}),(l=>{this.handleError(l,c)}))}}catch(p){this.handleError(p,c)}}unlockConversationAsync(r,a){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),a),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),(()=>{this.handleCallback(r,a)}),(c=>{this.handleError(c,a)}))}catch(c){this.handleError(c,a)}}unmuteAllParticipantsAsync(r,a){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),a),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),(()=>{this.handleCallback(r,a)}),(c=>{this.handleError(c,a)}))}catch(c){this.handleError(c,a)}}unmuteParticipantAsync(r,a,c){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","userId")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),!this.me.isHost&&this.me.id!==r&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),c),this.privParticipants.getParticipantIndex(r)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(r,!1),(()=>{this.handleCallback(a,c)}),(d=>{this.handleError(d,c)}))}catch(p){this.handleError(p,c)}}sendTextMessageAsync(r,a,c){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","message")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),r.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(r),(()=>{this.handleCallback(a,c)}),(p=>{this.handleError(p,c)}))}catch(p){this.handleError(p,c)}}setTranslatedLanguagesAsync(r,a,c){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfArrayEmptyOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","languages")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(r),(()=>{this.handleCallback(a,c)}),(p=>{this.handleError(p,c)}))}catch(p){this.handleError(p,c)}}changeNicknameAsync(r,a,c){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","nickname")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(r),(()=>{this.handleCallback(a,c)}),(p=>{this.handleError(p,c)}))}catch(p){this.handleError(p,c)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(r){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await r.enforceAudioGating(),this.privTranscriberRecognizer=r,this.privTranscriberRecognizer.conversation=this}getKeepAlive(){const r=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:r,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(r){if(this.privParticipants.addOrUpdateParticipant(r)!==void 0&&this.privTranscriberRecognizer){const c=this.conversationInfo;return c.participants=[r],this.privTranscriberRecognizer.pushConversationEvent(c,"join")}}removeParticipantImplAsync(r){this.privParticipants.deleteParticipant(r.id);const a=this.conversationInfo;return a.participants=[r],this.privTranscriberRecognizer.pushConversationEvent(a,"leave")}async close(r){var a;try{this.privIsConnected=!1,await((a=this.privConversationRecognizer)==null?void 0:a.close()),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(c){throw c}r&&this.dispose()}handleCallback(r,a){if(r){try{r()}catch(c){a&&a(c)}r=void 0}}handleError(r,a){if(a)if(r instanceof Error){const c=r;a(c.name+": "+c.message)}else a(r)}toParticipants(r){const a=this.privParticipants.participants.map(c=>this.toParticipant(c));return r?a:a.filter(c=>c.isHost===!1)}toParticipant(r){return new u.Participant(r.id,r.avatar,r.displayName,r.isHost,r.isMuted,r.isUsingTts,r.preferredLanguage,r.voice)}getMuteAllCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:r})}getMuteCommand(r,a){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(r,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setMute,participantId:r,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:a})}getLockCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:r})}getEjectCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(r,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.ejectParticipant,participantId:r,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:r})}getChangeNicknameCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(r,"nickname"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.changeNickname,nickname:r,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:r})}getMessageCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),i.Contracts.throwIfNullOrWhitespace(r,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:r,type:e.ConversationTranslatorMessageTypes.instantMessage})}}return Pe.ConversationImpl=o,Pe}var ar={},$a;function Ov(){if($a)return ar;$a=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.ConversationCommon=void 0;let e=class{constructor(i){this.privAudioConfig=i}handleCallback(i,u){if(i){try{i()}catch(n){u&&u(n)}i=void 0}}handleError(i,u){if(u)if(i instanceof Error){const n=i;u(n.name+": "+n.message)}else u(i)}};return ar.ConversationCommon=e,ar}var cr={},ec;function Dv(){if(ec)return cr;ec=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.ConversationExpirationEventArgs=void 0;const e=A();let t=class extends e.SessionEventArgs{constructor(u,n){super(n),this.privExpirationTime=u}get expirationTime(){return this.privExpirationTime}};return cr.ConversationExpirationEventArgs=t,cr}var ur={},tc;function kv(){if(tc)return ur;tc=1,Object.defineProperty(ur,"__esModule",{value:!0}),ur.ConversationParticipantsChangedEventArgs=void 0;const e=A();let t=class extends e.SessionEventArgs{constructor(u,n,o){super(o),this.privReason=u,this.privParticipant=n}get reason(){return this.privReason}get participants(){return this.privParticipant}};return ur.ConversationParticipantsChangedEventArgs=t,ur}var pr={},rc;function Nv(){if(rc)return pr;rc=1,Object.defineProperty(pr,"__esModule",{value:!0}),pr.ConversationTranslationCanceledEventArgs=void 0;const e=Di();let t=class extends e.CancellationEventArgsBase{};return pr.ConversationTranslationCanceledEventArgs=t,pr}var dr={},ic;function zv(){if(ic)return dr;ic=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.ConversationTranslationEventArgs=void 0;const e=A();let t=class extends e.RecognitionEventArgs{constructor(u,n,o){super(n,o),this.privResult=u}get result(){return this.privResult}};return dr.ConversationTranslationEventArgs=t,dr}var hr={},nc;function jv(){if(nc)return hr;nc=1,Object.defineProperty(hr,"__esModule",{value:!0}),hr.ConversationTranslationResult=void 0;const e=Np();let t=class extends e.TranslationRecognitionResult{constructor(u,n,o,s,r,a,c,p,d,l,h){super(n,s,r,a,c,p,void 0,void 0,d,l,h),this.privId=u,this.privOrigLang=o}get participantId(){return this.privId}get originalLang(){return this.privOrigLang}};return hr.ConversationTranslationResult=t,hr}var _n={},lr={},vr={},sc;function Qp(){if(sc)return vr;sc=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.StringUtils=void 0;let e=class{static formatString(i,u){if(!i)return"";if(!u)return i;let n="",o="";const s=c=>{n+=c},r=c=>{o+=c};let a=s;for(let c=0;c<i.length;c++){const p=i[c],d=c+1<i.length?i[c+1]:"";switch(p){case"{":d==="{"?(a("{"),c++):a=r;break;case"}":d==="}"?(a("}"),c++):(u.hasOwnProperty(o)&&(n+=u[o]),a=s,o="");break;default:a(p);break}}return n}};return vr.StringUtils=e,vr}var oc;function Lv(){if(oc)return lr;oc=1,Object.defineProperty(lr,"__esModule",{value:!0}),lr.ConversationTranslatorConnectionFactory=void 0;const e=U(),t=Qp(),i=D(),u=A(),n=V(),o=pe(),s=se(),r=w();let a=class Xp extends s.ConnectionFactoryBase{constructor(p){super(),i.Contracts.throwIfNullOrUndefined(p,"convGetter"),this.privConvGetter=p}create(p,d,l){const h=p.parameters.getProperty("ConversationTranslator_MultiChannelAudio","").toUpperCase()==="TRUE",g=this.privConvGetter().room,f=g.cognitiveSpeechRegion||p.parameters.getProperty(u.PropertyId.SpeechServiceConnection_Region,""),m={hostSuffix:s.ConnectionFactoryBase.getHostSuffix(f),path:Xp.CTS_VIRT_MIC_PATH,region:encodeURIComponent(f)};m[o.QueryParameterNames.Language]=encodeURIComponent(p.parameters.getProperty(u.PropertyId.SpeechServiceConnection_RecoLanguage,"")),m[o.QueryParameterNames.CtsMeetingId]=encodeURIComponent(g.roomId),m[o.QueryParameterNames.CtsDeviceId]=encodeURIComponent(g.participantId),m[o.QueryParameterNames.CtsIsParticipant]=g.isHost?"":"&"+o.QueryParameterNames.CtsIsParticipant;let v="";const S={},C={};if(h){v=p.parameters.getProperty(u.PropertyId.SpeechServiceConnection_Endpoint),v||(v="wss://"+p.parameters.getProperty(u.PropertyId.SpeechServiceConnection_Host,"transcribe.{region}.cts.speech{hostSuffix}")+"{path}"),v=t.StringUtils.formatString(v,m);const R=new URL(v);R.searchParams.forEach((E,P)=>{S[P]=E}),new r.TranscriberConnectionFactory().setQueryParams(S,p,v),S[o.QueryParameterNames.CtsMeetingId]=m[o.QueryParameterNames.CtsMeetingId],S[o.QueryParameterNames.CtsDeviceId]=m[o.QueryParameterNames.CtsDeviceId],g.isHost||(S[o.QueryParameterNames.CtsIsParticipant]=""),o.QueryParameterNames.Format in S||(S[o.QueryParameterNames.Format]="simple"),R.searchParams.forEach((E,P)=>{R.searchParams.set(P,S[P]),delete S[P]}),v=R.toString()}else{const R=new r.TranslationConnectionFactory;v=R.getEndpointUrl(p,!0),v=t.StringUtils.formatString(v,m),R.setQueryParams(S,p,v)}C[n.HeaderNames.ConnectionId]=l,C[e.RestConfigBase.configParams.token]=g.token,d.token&&(C[d.headerName]=d.token);const y=p.parameters.getProperty("SPEECH-EnableWebsocketCompression","").toUpperCase()==="TRUE";return Promise.resolve(new e.WebsocketConnection(v,S,C,new r.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(p),y,l))}};return lr.ConversationTranslatorConnectionFactory=a,a.CTS_VIRT_MIC_PATH="/speech/recognition/dynamicaudio",lr}var ac;function qv(){return ac||(ac=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationTranslator=e.SpeechState=void 0;const t=w(),i=Lv(),u=b(),n=D(),o=A(),s=Gp(),r=Ts();var a;(function(d){d[d.Inactive=0]="Inactive",d[d.Connecting=1]="Connecting",d[d.Connected=2]="Connected"})(a=e.SpeechState||(e.SpeechState={}));class c extends o.TranslationRecognizer{constructor(l,h,g,f){super(l,h,new i.ConversationTranslatorConnectionFactory(f)),this.privSpeechState=a.Inactive,g&&(this.privTranslator=g,this.sessionStarted=()=>{this.privSpeechState=a.Connected},this.sessionStopped=()=>{this.privSpeechState=a.Inactive},this.recognizing=(m,v)=>{this.privTranslator.recognizing&&this.privTranslator.recognizing(this.privTranslator,v)},this.recognized=async(m,v)=>{var S;(S=v.result)!=null&&S.errorDetails?(await this.cancelSpeech(),this.fireCancelEvent(v.result.errorDetails)):this.privTranslator.recognized&&this.privTranslator.recognized(this.privTranslator,v)},this.canceled=async()=>{if(this.privSpeechState!==a.Inactive)try{await this.cancelSpeech()}catch{this.privSpeechState=a.Inactive}})}get state(){return this.privSpeechState}set state(l){this.privSpeechState=l}set authentication(l){this.privReco.authentication=l}onConnection(){this.privSpeechState=a.Connected}async onCancelSpeech(){this.privSpeechState=a.Inactive,await this.cancelSpeech()}fireCancelEvent(l){try{if(this.privTranslator.canceled){const h=new r.ConversationTranslationCanceledEventArgs(o.CancellationReason.Error,l,o.CancellationErrorCode.RuntimeError);this.privTranslator.canceled(this.privTranslator,h)}}catch{}}async cancelSpeech(){var l;try{this.stopContinuousRecognitionAsync(),await((l=this.privReco)==null?void 0:l.disconnect()),this.privSpeechState=a.Inactive}catch{}}}class p extends r.ConversationCommon{constructor(l){super(l),this.privErrors=t.ConversationConnectionConfig.restErrors,this.privIsDisposed=!1,this.privIsSpeaking=!1,this.privPlaceholderKey="abcdefghijklmnopqrstuvwxyz012345",this.privPlaceholderRegion="westus",this.privProperties=new o.PropertyCollection}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get participants(){var l;return(l=this.privConversation)==null?void 0:l.participants}get canSpeak(){return!(!this.privConversation.isConnected||!this.privCTRecognizer||this.privIsSpeaking||this.privCTRecognizer.state===a.Connected||this.privCTRecognizer.state===a.Connecting||this.privConversation.isMutedByHost)}onToken(l){this.privCTRecognizer.authentication=l}setServiceProperty(l,h){const g=JSON.parse(this.privProperties.getProperty(t.ServicePropertiesPropertyName,"{}"));g[l]=h,this.privProperties.setProperty(t.ServicePropertiesPropertyName,JSON.stringify(g))}joinConversationAsync(l,h,g,f,m){try{if(typeof l=="string"){n.Contracts.throwIfNullOrUndefined(l,this.privErrors.invalidArgs.replace("{arg}","conversation id")),n.Contracts.throwIfNullOrWhitespace(h,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privConversation&&this.handleError(new Error(this.privErrors.permissionDeniedStart),m);let v=g;(v==null||v==="")&&(v=t.ConversationConnectionConfig.defaultLanguageCode),this.privSpeechTranslationConfig=o.SpeechTranslationConfig.fromSubscription(this.privPlaceholderKey,this.privPlaceholderRegion),this.privSpeechTranslationConfig.setProfanity(o.ProfanityOption.Masked),this.privSpeechTranslationConfig.addTargetLanguage(v),this.privSpeechTranslationConfig.setProperty(o.PropertyId[o.PropertyId.SpeechServiceConnection_RecoLanguage],v),this.privSpeechTranslationConfig.setProperty(o.PropertyId[o.PropertyId.ConversationTranslator_Name],h);const S=[o.PropertyId.SpeechServiceConnection_Host,o.PropertyId.ConversationTranslator_Host,o.PropertyId.SpeechServiceConnection_Endpoint,o.PropertyId.SpeechServiceConnection_ProxyHostName,o.PropertyId.SpeechServiceConnection_ProxyPassword,o.PropertyId.SpeechServiceConnection_ProxyPort,o.PropertyId.SpeechServiceConnection_ProxyUserName,"ConversationTranslator_MultiChannelAudio","ConversationTranslator_Region"];for(const y of S){const R=this.privProperties.getProperty(y);if(R){const T=typeof y=="string"?y:o.PropertyId[y];this.privSpeechTranslationConfig.setProperty(T,R)}}const C=JSON.parse(this.privProperties.getProperty(t.ServicePropertiesPropertyName,"{}"));for(const y of Object.keys(C))this.privSpeechTranslationConfig.setServiceProperty(y,C[y],o.ServicePropertyChannel.UriQueryParameter);this.privConversation=new s.ConversationImpl(this.privSpeechTranslationConfig),this.privConversation.conversationTranslator=this,this.privConversation.joinConversationAsync(l,h,v,(y=>{y||this.handleError(new Error(this.privErrors.permissionDeniedConnect),m),this.privSpeechTranslationConfig.authorizationToken=y,this.privConversation.room.isHost=!1,this.privConversation.startConversationAsync((()=>{this.handleCallback(f,m)}),(R=>{this.handleError(R,m)}))}),(y=>{this.handleError(y,m)}))}else typeof l=="object"?(n.Contracts.throwIfNullOrUndefined(l,this.privErrors.invalidArgs.replace("{arg}","conversation id")),n.Contracts.throwIfNullOrWhitespace(h,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privProperties.setProperty(o.PropertyId.ConversationTranslator_Name,h),this.privConversation=l,this.privConversation.conversationTranslator=this,this.privConversation.room.isHost=!0,n.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedConnect),n.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privSpeechTranslationConfig=l.config,this.handleCallback(g,f)):this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","invalid conversation type")),f)}catch(v){this.handleError(v,typeof g=="string"?m:f)}}leaveConversationAsync(l,h){(0,u.marshalPromiseToCallbacks)((async()=>{await this.cancelSpeech(),await this.privConversation.endConversationImplAsync(),await this.privConversation.deleteConversationImplAsync(),this.dispose()})(),l,h)}sendTextMessageAsync(l,h,g){try{n.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),n.Contracts.throwIfNullOrWhitespace(l,this.privErrors.invalidArgs.replace("{arg}",l)),this.privConversation.sendTextMessageAsync(l,h,g)}catch(f){this.handleError(f,g)}}startTranscribingAsync(l,h){(0,u.marshalPromiseToCallbacks)((async()=>{try{n.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),n.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privCTRecognizer===void 0&&await this.connectTranslatorRecognizer(),n.Contracts.throwIfNullOrUndefined(this.privCTRecognizer,this.privErrors.permissionDeniedSend),this.canSpeak||this.handleError(new Error(this.privErrors.permissionDeniedSend),h),await this.startContinuousRecognition(),this.privIsSpeaking=!0}catch(g){throw this.privIsSpeaking=!1,await this.cancelSpeech(),g}})(),l,h)}stopTranscribingAsync(l,h){(0,u.marshalPromiseToCallbacks)((async()=>{try{if(!this.privIsSpeaking){await this.cancelSpeech();return}this.privIsSpeaking=!1,await new Promise((g,f)=>{this.privCTRecognizer.stopContinuousRecognitionAsync(g,f)})}catch{await this.cancelSpeech()}})(),l,h)}isDisposed(){return this.privIsDisposed}dispose(l,h,g){(0,u.marshalPromiseToCallbacks)((async()=>{this.isDisposed&&!this.privIsSpeaking||(await this.cancelSpeech(),this.privIsDisposed=!0,this.privSpeechTranslationConfig.close(),this.privSpeechRecognitionLanguage=void 0,this.privProperties=void 0,this.privAudioConfig=void 0,this.privSpeechTranslationConfig=void 0,this.privConversation.dispose(),this.privConversation=void 0)})(),h,g)}async cancelSpeech(){var l;try{this.privIsSpeaking=!1,await((l=this.privCTRecognizer)==null?void 0:l.onCancelSpeech()),this.privCTRecognizer=void 0}catch{}}async connectTranslatorRecognizer(){try{this.privAudioConfig===void 0&&(this.privAudioConfig=o.AudioConfig.fromDefaultMicrophoneInput()),this.privSpeechTranslationConfig.getProperty(o.PropertyId[o.PropertyId.SpeechServiceConnection_Key])===this.privPlaceholderKey&&this.privSpeechTranslationConfig.setProperty(o.PropertyId[o.PropertyId.SpeechServiceConnection_Key],"");const l=()=>this.privConversation;this.privCTRecognizer=new c(this.privSpeechTranslationConfig,this.privAudioConfig,this,l)}catch(l){throw await this.cancelSpeech(),l}}startContinuousRecognition(){return new Promise((l,h)=>{this.privCTRecognizer.startContinuousRecognitionAsync(l,h)})}}e.ConversationTranslator=p})(_n)),_n}var fr={},cc;function Bv(){if(cc)return fr;cc=1,Object.defineProperty(fr,"__esModule",{value:!0}),fr.ConversationTranscriber=void 0;const e=w(),t=Y(),i=b(),u=D(),n=A();let o=class Zp extends n.Recognizer{constructor(r,a){const c=r;u.Contracts.throwIfNull(c,"speechConfig"),u.Contracts.throwIfNullOrWhitespace(c.properties.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage),n.PropertyId[n.PropertyId.SpeechServiceConnection_RecoLanguage]),super(a,c.properties,new e.ConversationTranscriberConnectionFactory,r.tokenCredential),this.privProperties.setProperty(n.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privDisposedRecognizer=!1}static FromConfig(r,a,c){const p=r;return a.properties.mergeTo(p.properties),new Zp(r,c)}get endpointId(){return u.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(n.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(n.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(r){u.Contracts.throwIfNullOrWhitespace(r,"token"),this.properties.setProperty(n.PropertyId.SpeechServiceAuthorization_Token,r)}get speechRecognitionLanguage(){return u.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return u.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(e.OutputFormatPropertyName,n.OutputFormat[n.OutputFormat.Simple])===n.OutputFormat[n.OutputFormat.Simple]?n.OutputFormat.Simple:n.OutputFormat.Detailed}get properties(){return this.privProperties}startTranscribingAsync(r,a){(0,i.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(t.RecognitionMode.Conversation),r,a)}stopTranscribingAsync(r,a){(0,i.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),r,a)}close(r,a){u.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,i.marshalPromiseToCallbacks)(this.dispose(!0),r,a)}async dispose(r){this.privDisposedRecognizer||(r&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(r))}createRecognizerConfig(r){return new e.RecognizerConfig(r,this.privProperties)}createServiceRecognizer(r,a,c,p){const d=c;return p.isSpeakerDiarizationEnabled=!0,new e.ConversationTranscriptionServiceRecognizer(r,a,d,p,this)}};return fr.ConversationTranscriber=o,fr}var Ee={},uc;function Fv(){if(uc)return Ee;uc=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.Participant=Ee.User=void 0;const e=A();class t{constructor(n){this.privUserId=n}get userId(){return this.privUserId}}Ee.User=t;class i{constructor(n,o,s,r,a,c,p,d){this.privId=n,this.privAvatar=o,this.privDisplayName=s,this.privIsHost=r,this.privIsMuted=a,this.privIsUsingTts=c,this.privPreferredLanguage=p,this.privVoice=d,this.privProperties=new e.PropertyCollection}get avatar(){return this.privAvatar}get displayName(){return this.privDisplayName}get id(){return this.privId}get preferredLanguage(){return this.privPreferredLanguage}get isHost(){return this.privIsHost}get isMuted(){return this.privIsMuted}get isUsingTts(){return this.privIsUsingTts}get voice(){return this.privVoice}get properties(){return this.privProperties}static From(n,o,s){return new i(n,"",n,!1,!1,!1,o,s)}}return Ee.Participant=i,Ee}var bn={},pc;function xv(){return pc||(pc=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ParticipantChangedReason=void 0,(function(t){t[t.JoinedConversation=0]="JoinedConversation",t[t.LeftConversation=1]="LeftConversation",t[t.Updated=2]="Updated"})(e.ParticipantChangedReason||(e.ParticipantChangedReason={}))})(bn)),bn}var Te={},dc;function Uv(){if(dc)return Te;dc=1,Object.defineProperty(Te,"__esModule",{value:!0}),Te.MeetingImpl=Te.Meeting=void 0;const e=w(),t=b(),i=D(),u=A();let n=class{constructor(){}static createMeetingAsync(r,a,c,p){if(i.Contracts.throwIfNullOrUndefined(r,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),i.Contracts.throwIfNullOrUndefined(r.region,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),i.Contracts.throwIfNull(a,"meetingId"),a.length===0)throw new Error("meetingId cannot be empty");!r.subscriptionKey&&!r.getProperty(u.PropertyId[u.PropertyId.SpeechServiceAuthorization_Token])&&i.Contracts.throwIfNullOrUndefined(r.subscriptionKey,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));const d=new o(r,a);return(0,t.marshalPromiseToCallbacks)((async()=>{})(),c,p),d}};Te.Meeting=n;class o extends n{constructor(r,a){super(),this.privErrors=e.ConversationConnectionConfig.restErrors,this.onConnected=d=>{var l;this.privIsConnected=!0;try{(l=this.privConversationTranslator)!=null&&l.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,d)}catch{}},this.onDisconnected=d=>{var l;try{(l=this.privConversationTranslator)!=null&&l.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,d)}catch{}finally{this.close(!1)}},this.onCanceled=(d,l)=>{var h;try{(h=this.privConversationTranslator)!=null&&h.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,l)}catch{}},this.onParticipantUpdateCommandReceived=(d,l)=>{try{const h=this.privParticipants.getParticipant(l.id);if(h!==void 0){switch(l.key){case e.ConversationTranslatorCommandTypes.changeNickname:h.displayName=l.value;break;case e.ConversationTranslatorCommandTypes.setUseTTS:h.isUsingTts=l.value;break;case e.ConversationTranslatorCommandTypes.setProfanityFiltering:h.profanity=l.value;break;case e.ConversationTranslatorCommandTypes.setMute:h.isMuted=l.value;break;case e.ConversationTranslatorCommandTypes.setTranslateToLanguages:h.translateToLanguages=l.value;break}this.privParticipants.addOrUpdateParticipant(h),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.Updated,[this.toParticipant(h)],l.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(d,l)=>{try{this.privParticipants.participants.forEach(h=>h.isMuted=h.isHost?!1:l.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.Updated,this.toParticipants(!1),l.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(d,l)=>{try{const h=this.privParticipants.addOrUpdateParticipant(l.participant);h!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.JoinedConversation,[this.toParticipant(h)],l.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(d,l)=>{try{const h=this.privParticipants.getParticipant(l.participant.id);h!==void 0&&(this.privParticipants.deleteParticipant(l.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.LeftConversation,[this.toParticipant(h)],l.sessionId)))}catch{}},this.onTranslationReceived=(d,l)=>{try{switch(l.command){case e.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new u.ConversationTranslationEventArgs(l.payload,void 0,l.sessionId));break;case e.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new u.ConversationTranslationEventArgs(l.payload,void 0,l.sessionId));break;case e.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new u.ConversationTranslationEventArgs(l.payload,void 0,l.sessionId));break}}catch{}},this.onParticipantsListReceived=(d,l)=>{var h;try{if(l.sessionToken!==void 0&&l.sessionToken!==null&&(this.privRoom.token=l.sessionToken),this.privParticipants.participants=[...l.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),l.sessionId)),this.me.isHost){const g=(h=this.privConversationTranslator)==null?void 0:h.properties.getProperty(u.PropertyId.ConversationTranslator_Name);g!==void 0&&g.length>0&&g!==this.me.displayName&&this.changeNicknameAsync(g)}}catch{}},this.onConversationExpiration=(d,l)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,l)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new u.PropertyCollection,this.privManager=new e.ConversationManager,r.getProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage])||r.setProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage],e.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=r.getProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage]),this.privConversationId=a,this.privConfig=r;const p=r;i.Contracts.throwIfNull(p,"speechConfig"),this.privProperties=p.properties.clone(),this.privIsConnected=!1,this.privParticipants=new e.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get meetingId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){var r,a;return(r=this.privParticipants.me)!=null&&r.isHost?!1:(a=this.privParticipants.me)==null?void 0:a.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get meetingInfo(){const r=this.meetingId,a=this.participants.map(d=>({id:d.id,preferredLanguage:d.preferredLanguage,voice:d.voice})),c={};for(const d of e.ConversationConnectionConfig.transcriptionEventKeys){const l=this.properties.getProperty(d,"");l!==""&&(c[d]=l)}return{id:r,participants:a,meetingProperties:c}}get canSend(){var r;return this.privIsConnected&&!((r=this.privParticipants.me)!=null&&r.isMuted)}get canSendAsHost(){var r;return this.privIsConnected&&((r=this.privParticipants.me)==null?void 0:r.isHost)}get authorizationToken(){return this.privToken}set authorizationToken(r){i.Contracts.throwIfNullOrWhitespace(r,"authorizationToken"),this.privToken=r}createMeetingAsync(r,a){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),a),this.privManager.createOrJoin(this.privProperties,void 0,(c=>{c||this.handleError(new Error(this.privErrors.permissionDeniedConnect),a),this.privRoom=c,this.handleCallback(r,a)}),(c=>{this.handleError(c,a)}))}catch(c){this.handleError(c,a)}}startMeetingAsync(r,a){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),a),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,(()=>{this.handleCallback(r,a)}),(c=>{this.handleError(c,a)}))}catch(c){this.handleError(c,a)}}addParticipantAsync(r,a,c){i.Contracts.throwIfNullOrUndefined(r,"Participant"),(0,t.marshalPromiseToCallbacks)(this.addParticipantImplAsync(r),a,c)}joinMeetingAsync(r,a,c,p,d){try{i.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","conversationId")),i.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","nickname")),i.Contracts.throwIfNullOrWhitespace(c,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,r,(l=>{i.Contracts.throwIfNullOrUndefined(l,this.privErrors.permissionDeniedConnect),this.privRoom=l,this.privConfig.authorizationToken=l.cognitiveSpeechAuthToken,p&&p(l.cognitiveSpeechAuthToken)}),(l=>{this.handleError(l,d)}))}catch(l){this.handleError(l,d)}}deleteMeetingAsync(r,a){(0,t.marshalPromiseToCallbacks)(this.deleteMeetingImplAsync(),r,a)}async deleteMeetingImplAsync(){i.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),i.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endMeetingAsync(r,a){(0,t.marshalPromiseToCallbacks)(this.endMeetingImplAsync(),r,a)}endMeetingImplAsync(){return this.close(!0)}lockMeetingAsync(r,a){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),a),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),(()=>{this.handleCallback(r,a)}),(c=>{this.handleError(c,a)}))}catch(c){this.handleError(c,a)}}muteAllParticipantsAsync(r,a){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),a),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),(()=>{this.handleCallback(r,a)}),(c=>{this.handleError(c,a)}))}catch(c){this.handleError(c,a)}}muteParticipantAsync(r,a,c){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","userId")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),!this.me.isHost&&this.me.id!==r&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),c),this.privParticipants.getParticipantIndex(r)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(r,!0),(()=>{this.handleCallback(a,c)}),(d=>{this.handleError(d,c)}))}catch(p){this.handleError(p,c)}}removeParticipantAsync(r,a,c){try{if(i.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&r.hasOwnProperty("id"))(0,t.marshalPromiseToCallbacks)(this.removeParticipantImplAsync(r),a,c);else{i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),c);let p="";typeof r=="string"?p=r:r.hasOwnProperty("id")?p=r.id:r.hasOwnProperty("userId")&&(p=r.userId),i.Contracts.throwIfNullOrWhitespace(p,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(l=>l.id===p)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(p),(()=>{this.handleCallback(a,c)}),(l=>{this.handleError(l,c)}))}}catch(p){this.handleError(p,c)}}unlockMeetingAsync(r,a){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),a),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),(()=>{this.handleCallback(r,a)}),(c=>{this.handleError(c,a)}))}catch(c){this.handleError(c,a)}}unmuteAllParticipantsAsync(r,a){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),a),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),(()=>{this.handleCallback(r,a)}),(c=>{this.handleError(c,a)}))}catch(c){this.handleError(c,a)}}unmuteParticipantAsync(r,a,c){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","userId")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),!this.me.isHost&&this.me.id!==r&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),c),this.privParticipants.getParticipantIndex(r)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(r,!1),(()=>{this.handleCallback(a,c)}),(d=>{this.handleError(d,c)}))}catch(p){this.handleError(p,c)}}sendTextMessageAsync(r,a,c){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","message")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),r.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(r),(()=>{this.handleCallback(a,c)}),(p=>{this.handleError(p,c)}))}catch(p){this.handleError(p,c)}}setTranslatedLanguagesAsync(r,a,c){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfArrayEmptyOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","languages")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(r),(()=>{this.handleCallback(a,c)}),(p=>{this.handleError(p,c)}))}catch(p){this.handleError(p,c)}}changeNicknameAsync(r,a,c){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","nickname")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(r),(()=>{this.handleCallback(a,c)}),(p=>{this.handleError(p,c)}))}catch(p){this.handleError(p,c)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(r){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await r.enforceAudioGating(),this.privTranscriberRecognizer=r,this.privTranscriberRecognizer.meeting=this}getKeepAlive(){const r=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:r,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(r){if(this.privParticipants.addOrUpdateParticipant(r)!==void 0&&this.privTranscriberRecognizer){const c=this.meetingInfo;return c.participants=[r],this.privTranscriberRecognizer.pushMeetingEvent(c,"join")}}removeParticipantImplAsync(r){this.privParticipants.deleteParticipant(r.id);const a=this.meetingInfo;return a.participants=[r],this.privTranscriberRecognizer.pushMeetingEvent(a,"leave")}async close(r){var a;try{this.privIsConnected=!1,await((a=this.privConversationRecognizer)==null?void 0:a.close()),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(c){throw c}r&&this.dispose()}handleCallback(r,a){if(r){try{r()}catch(c){a&&a(c)}r=void 0}}handleError(r,a){if(a)if(r instanceof Error){const c=r;a(c.name+": "+c.message)}else a(r)}toParticipants(r){const a=this.privParticipants.participants.map(c=>this.toParticipant(c));return r?a:a.filter(c=>c.isHost===!1)}toParticipant(r){return new u.Participant(r.id,r.avatar,r.displayName,r.isHost,r.isMuted,r.isUsingTts,r.preferredLanguage,r.voice)}getMuteAllCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingd"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:r})}getMuteCommand(r,a){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(r,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setMute,participantId:r,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:a})}getLockCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:r})}getEjectCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),i.Contracts.throwIfNullOrWhitespace(r,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.ejectParticipant,participantId:r,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:r})}getChangeNicknameCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),i.Contracts.throwIfNullOrWhitespace(r,"nickname"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.changeNickname,nickname:r,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:r})}getMessageCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),i.Contracts.throwIfNullOrWhitespace(r,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:r,type:e.ConversationTranslatorMessageTypes.instantMessage})}}return Te.MeetingImpl=o,Te}var gr={},hc;function Wv(){if(hc)return gr;hc=1,Object.defineProperty(gr,"__esModule",{value:!0}),gr.MeetingTranscriptionCanceledEventArgs=void 0;const e=Di();class t extends e.CancellationEventArgsBase{}return gr.MeetingTranscriptionCanceledEventArgs=t,gr}var mr={},lc;function Hv(){if(lc)return mr;lc=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.MeetingTranscriber=void 0;const e=w(),t=b(),i=D(),u=A(),n=Ts();let o=class{constructor(r){this.privAudioConfig=r,this.privProperties=new u.PropertyCollection,this.privRecognizer=void 0,this.privDisposedRecognizer=!1}get speechRecognitionLanguage(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(u.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get internalData(){return this.privRecognizer.internalData}get connection(){return u.Connection.fromRecognizer(this.privRecognizer)}get authorizationToken(){return this.properties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(r){i.Contracts.throwIfNullOrWhitespace(r,"token"),this.properties.setProperty(u.PropertyId.SpeechServiceAuthorization_Token,r)}joinMeetingAsync(r,a,c){const p=r;i.Contracts.throwIfNullOrUndefined(n.MeetingImpl,"Meeting"),this.privRecognizer=new e.TranscriberRecognizer(r.config,this.privAudioConfig),i.Contracts.throwIfNullOrUndefined(this.privRecognizer,"Recognizer"),this.privRecognizer.connectMeetingCallbacks(this),(0,t.marshalPromiseToCallbacks)(p.connectTranscriberRecognizer(this.privRecognizer),a,c)}startTranscribingAsync(r,a){this.privRecognizer.startContinuousRecognitionAsync(r,a)}stopTranscribingAsync(r,a){this.privRecognizer.stopContinuousRecognitionAsync(r,a)}leaveMeetingAsync(r,a){this.privRecognizer.disconnectCallbacks(),(0,t.marshalPromiseToCallbacks)((async()=>{})(),r,a)}close(r,a){i.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,t.marshalPromiseToCallbacks)(this.dispose(!0),r,a)}async dispose(r){this.privDisposedRecognizer||(this.privRecognizer&&(await this.privRecognizer.close(),this.privRecognizer=void 0),r&&(this.privDisposedRecognizer=!0))}};return mr.MeetingTranscriber=o,mr}var Sr={},vc;function Kv(){if(vc)return Sr;vc=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.ConversationTranscriptionResult=void 0;const e=A();let t=class extends e.RecognitionResult{constructor(u,n,o,s,r,a,c,p,d,l,h){super(u,n,o,s,r,a,c,d,l,h),this.privSpeakerId=p}get speakerId(){return this.privSpeakerId}};return Sr.ConversationTranscriptionResult=t,Sr}var fc;function Ts(){return fc||(fc=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationTranscriptionResult=e.MeetingTranscriber=e.MeetingTranscriptionCanceledEventArgs=e.MeetingImpl=e.Meeting=e.ParticipantChangedReason=e.User=e.Participant=e.ConversationTranscriber=e.ConversationTranslator=e.ConversationTranslationResult=e.ConversationTranslationEventArgs=e.ConversationTranslationCanceledEventArgs=e.ConversationParticipantsChangedEventArgs=e.ConversationExpirationEventArgs=e.ConversationCommon=e.ConversationImpl=e.Conversation=void 0;var t=Gp();Object.defineProperty(e,"Conversation",{enumerable:!0,get:function(){return t.Conversation}}),Object.defineProperty(e,"ConversationImpl",{enumerable:!0,get:function(){return t.ConversationImpl}});var i=Ov();Object.defineProperty(e,"ConversationCommon",{enumerable:!0,get:function(){return i.ConversationCommon}});var u=Dv();Object.defineProperty(e,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return u.ConversationExpirationEventArgs}});var n=kv();Object.defineProperty(e,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return n.ConversationParticipantsChangedEventArgs}});var o=Nv();Object.defineProperty(e,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return o.ConversationTranslationCanceledEventArgs}});var s=zv();Object.defineProperty(e,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return s.ConversationTranslationEventArgs}});var r=jv();Object.defineProperty(e,"ConversationTranslationResult",{enumerable:!0,get:function(){return r.ConversationTranslationResult}});var a=qv();Object.defineProperty(e,"ConversationTranslator",{enumerable:!0,get:function(){return a.ConversationTranslator}});var c=Bv();Object.defineProperty(e,"ConversationTranscriber",{enumerable:!0,get:function(){return c.ConversationTranscriber}});var p=Fv();Object.defineProperty(e,"Participant",{enumerable:!0,get:function(){return p.Participant}}),Object.defineProperty(e,"User",{enumerable:!0,get:function(){return p.User}});var d=xv();Object.defineProperty(e,"ParticipantChangedReason",{enumerable:!0,get:function(){return d.ParticipantChangedReason}});var l=Uv();Object.defineProperty(e,"Meeting",{enumerable:!0,get:function(){return l.Meeting}}),Object.defineProperty(e,"MeetingImpl",{enumerable:!0,get:function(){return l.MeetingImpl}});var h=Wv();Object.defineProperty(e,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return h.MeetingTranscriptionCanceledEventArgs}});var g=Hv();Object.defineProperty(e,"MeetingTranscriber",{enumerable:!0,get:function(){return g.MeetingTranscriber}});var f=Kv();Object.defineProperty(e,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return f.ConversationTranscriptionResult}})})(wn)),wn}var Ae={},gc;function As(){if(gc)return Ae;gc=1,Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.SynthesisRequest=Ae.Synthesizer=void 0;const e=w(),t=b(),i=D(),u=A();let n=class Yp{constructor(r){const a=r;i.Contracts.throwIfNull(a,"speechConfig"),this.privProperties=a.properties.clone(),this.privDisposed=!1,this.privSynthesizing=!1,this.synthesisRequestQueue=new t.Queue,this.tokenCredential=r.tokenCredential}get authorizationToken(){return this.properties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(r){i.Contracts.throwIfNullOrWhitespace(r,"token"),this.properties.setProperty(u.PropertyId.SpeechServiceAuthorization_Token,r)}get properties(){return this.privProperties}get autoDetectSourceLanguage(){return this.properties.getProperty(u.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)===e.AutoDetectSourceLanguagesOpenRangeOptionName}buildSsml(r){const a={"af-ZA":"af-ZA-AdriNeural","am-ET":"am-ET-AmehaNeural","ar-AE":"ar-AE-FatimaNeural","ar-BH":"ar-BH-AliNeural","ar-DZ":"ar-DZ-AminaNeural","ar-EG":"ar-EG-SalmaNeural","ar-IQ":"ar-IQ-BasselNeural","ar-JO":"ar-JO-SanaNeural","ar-KW":"ar-KW-FahedNeural","ar-LY":"ar-LY-ImanNeural","ar-MA":"ar-MA-JamalNeural","ar-QA":"ar-QA-AmalNeural","ar-SA":"ar-SA-HamedNeural","ar-SY":"ar-SY-AmanyNeural","ar-TN":"ar-TN-HediNeural","ar-YE":"ar-YE-MaryamNeural","bg-BG":"bg-BG-BorislavNeural","bn-BD":"bn-BD-NabanitaNeural","bn-IN":"bn-IN-BashkarNeural","ca-ES":"ca-ES-JoanaNeural","cs-CZ":"cs-CZ-AntoninNeural","cy-GB":"cy-GB-AledNeural","da-DK":"da-DK-ChristelNeural","de-AT":"de-AT-IngridNeural","de-CH":"de-CH-JanNeural","de-DE":"de-DE-KatjaNeural","el-GR":"el-GR-AthinaNeural","en-AU":"en-AU-NatashaNeural","en-CA":"en-CA-ClaraNeural","en-GB":"en-GB-LibbyNeural","en-HK":"en-HK-SamNeural","en-IE":"en-IE-ConnorNeural","en-IN":"en-IN-NeerjaNeural","en-KE":"en-KE-AsiliaNeural","en-NG":"en-NG-AbeoNeural","en-NZ":"en-NZ-MitchellNeural","en-PH":"en-PH-JamesNeural","en-SG":"en-SG-LunaNeural","en-TZ":"en-TZ-ElimuNeural","en-US":"en-US-AvaMultilingualNeural","en-ZA":"en-ZA-LeahNeural","es-AR":"es-AR-ElenaNeural","es-BO":"es-BO-MarceloNeural","es-CL":"es-CL-CatalinaNeural","es-CO":"es-CO-GonzaloNeural","es-CR":"es-CR-JuanNeural","es-CU":"es-CU-BelkysNeural","es-DO":"es-DO-EmilioNeural","es-EC":"es-EC-AndreaNeural","es-ES":"es-ES-AlvaroNeural","es-GQ":"es-GQ-JavierNeural","es-GT":"es-GT-AndresNeural","es-HN":"es-HN-CarlosNeural","es-MX":"es-MX-DaliaNeural","es-NI":"es-NI-FedericoNeural","es-PA":"es-PA-MargaritaNeural","es-PE":"es-PE-AlexNeural","es-PR":"es-PR-KarinaNeural","es-PY":"es-PY-MarioNeural","es-SV":"es-SV-LorenaNeural","es-US":"es-US-AlonsoNeural","es-UY":"es-UY-MateoNeural","es-VE":"es-VE-PaolaNeural","et-EE":"et-EE-AnuNeural","fa-IR":"fa-IR-DilaraNeural","fi-FI":"fi-FI-SelmaNeural","fil-PH":"fil-PH-AngeloNeural","fr-BE":"fr-BE-CharlineNeural","fr-CA":"fr-CA-SylvieNeural","fr-CH":"fr-CH-ArianeNeural","fr-FR":"fr-FR-DeniseNeural","ga-IE":"ga-IE-ColmNeural","gl-ES":"gl-ES-RoiNeural","gu-IN":"gu-IN-DhwaniNeural","he-IL":"he-IL-AvriNeural","hi-IN":"hi-IN-MadhurNeural","hr-HR":"hr-HR-GabrijelaNeural","hu-HU":"hu-HU-NoemiNeural","id-ID":"id-ID-ArdiNeural","is-IS":"is-IS-GudrunNeural","it-IT":"it-IT-IsabellaNeural","ja-JP":"ja-JP-NanamiNeural","jv-ID":"jv-ID-DimasNeural","kk-KZ":"kk-KZ-AigulNeural","km-KH":"km-KH-PisethNeural","kn-IN":"kn-IN-GaganNeural","ko-KR":"ko-KR-SunHiNeural","lo-LA":"lo-LA-ChanthavongNeural","lt-LT":"lt-LT-LeonasNeural","lv-LV":"lv-LV-EveritaNeural","mk-MK":"mk-MK-AleksandarNeural","ml-IN":"ml-IN-MidhunNeural","mr-IN":"mr-IN-AarohiNeural","ms-MY":"ms-MY-OsmanNeural","mt-MT":"mt-MT-GraceNeural","my-MM":"my-MM-NilarNeural","nb-NO":"nb-NO-PernilleNeural","nl-BE":"nl-BE-ArnaudNeural","nl-NL":"nl-NL-ColetteNeural","pl-PL":"pl-PL-AgnieszkaNeural","ps-AF":"ps-AF-GulNawazNeural","pt-BR":"pt-BR-FranciscaNeural","pt-PT":"pt-PT-DuarteNeural","ro-RO":"ro-RO-AlinaNeural","ru-RU":"ru-RU-SvetlanaNeural","si-LK":"si-LK-SameeraNeural","sk-SK":"sk-SK-LukasNeural","sl-SI":"sl-SI-PetraNeural","so-SO":"so-SO-MuuseNeural","sr-RS":"sr-RS-NicholasNeural","su-ID":"su-ID-JajangNeural","sv-SE":"sv-SE-SofieNeural","sw-KE":"sw-KE-RafikiNeural","sw-TZ":"sw-TZ-DaudiNeural","ta-IN":"ta-IN-PallaviNeural","ta-LK":"ta-LK-KumarNeural","ta-SG":"ta-SG-AnbuNeural","te-IN":"te-IN-MohanNeural","th-TH":"th-TH-PremwadeeNeural","tr-TR":"tr-TR-AhmetNeural","uk-UA":"uk-UA-OstapNeural","ur-IN":"ur-IN-GulNeural","ur-PK":"ur-PK-AsadNeural","uz-UZ":"uz-UZ-MadinaNeural","vi-VN":"vi-VN-HoaiMyNeural","zh-CN":"zh-CN-XiaoxiaoNeural","zh-HK":"zh-HK-HiuMaanNeural","zh-TW":"zh-TW-HsiaoChenNeural","zu-ZA":"zu-ZA-ThandoNeural"};let c=this.properties.getProperty(u.PropertyId.SpeechServiceConnection_SynthLanguage,"en-US"),p=this.properties.getProperty(u.PropertyId.SpeechServiceConnection_SynthVoice,""),d=Yp.XMLEncode(r);return this.autoDetectSourceLanguage?c="en-US":p=p||a[c],p&&(d=`<voice name='${p}'>${d}</voice>`),d=`<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='${c}'>${d}</speak>`,d}async dispose(r){this.privDisposed||(r&&this.privAdapter&&await this.privAdapter.dispose(),this.privDisposed=!0)}async adapterSpeak(){if(!this.privDisposed&&!this.privSynthesizing){this.privSynthesizing=!0;const r=await this.synthesisRequestQueue.dequeue();return this.privAdapter.Speak(r.text,r.isSSML,r.requestId,r.cb,r.err,r.dataStream)}}createSynthesizerConfig(r){return new e.SynthesizerConfig(r,this.privProperties)}implCommonSynthesizeSetup(){let r=typeof window<"u"?"Browser":"Node",a="unknown",c="unknown";typeof navigator<"u"&&(r=r+"/"+navigator.platform,a=navigator.userAgent,c=navigator.appVersion);const p=this.createSynthesizerConfig(new e.SpeechServiceConfig(new e.Context(new e.OS(r,a,c)))),d=this.privProperties.getProperty(u.PropertyId.SpeechServiceConnection_Key,void 0),l=d&&d!==""?new e.CognitiveSubscriptionKeyAuthentication(d):this.tokenCredential?new e.CognitiveTokenAuthentication(async()=>{try{const h=await this.tokenCredential.getToken("https://cognitiveservices.azure.com/.default");return(h==null?void 0:h.token)??""}catch(h){throw h}},async()=>{try{const h=await this.tokenCredential.getToken("https://cognitiveservices.azure.com/.default");return(h==null?void 0:h.token)??""}catch(h){throw h}}):new e.CognitiveTokenAuthentication(()=>{const h=this.privProperties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(h)},()=>{const h=this.privProperties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(h)});this.privAdapter=this.createSynthesisAdapter(l,this.privConnectionFactory,p),this.privRestAdapter=this.createRestSynthesisAdapter(l,p)}static XMLEncode(r){return r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}};Ae.Synthesizer=n;class o{constructor(r,a,c,p,d,l){this.requestId=r,this.text=a,this.isSSML=c,this.cb=p,this.err=d,this.dataStream=l}}return Ae.SynthesisRequest=o,Ae}var Cr={},mc;function Vv(){if(mc)return Cr;mc=1,Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.SpeechSynthesizer=void 0;const e=w(),t=b(),i=bp(),u=Oi(),n=Le(),o=D(),s=A(),r=As();let a=class $p extends s.Synthesizer{constructor(p,d){super(p),d!==null&&(d===void 0?this.audioConfig=typeof window>"u"?void 0:s.AudioConfig.fromDefaultSpeakerOutput():this.audioConfig=d),this.privConnectionFactory=new e.SpeechSynthesisConnectionFactory,this.implCommonSynthesizeSetup()}static FromConfig(p,d,l){const h=p;return d.properties.mergeTo(h.properties),new $p(p,l)}speakTextAsync(p,d,l,h){this.speakImpl(p,!1,d,l,h)}speakSsmlAsync(p,d,l,h){this.speakImpl(p,!0,d,l,h)}async getVoicesAsync(p=""){return this.getVoices(p)}close(p,d){o.Contracts.throwIfDisposed(this.privDisposed),(0,t.marshalPromiseToCallbacks)(this.dispose(!0),p,d)}get internalData(){return this.privAdapter}createSynthesisAdapter(p,d,l){return new e.SpeechSynthesisAdapter(p,d,l,this,this.audioConfig)}createRestSynthesisAdapter(p,d){return new e.SynthesisRestAdapter(d,p)}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=u.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(s.SpeechSynthesisOutputFormat[this.properties.getProperty(s.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)])}speakImpl(p,d,l,h,g){try{o.Contracts.throwIfDisposed(this.privDisposed);const f=(0,t.createNoDashGuid)();let m;g instanceof s.PushAudioOutputStreamCallback?m=new n.PushAudioOutputStreamImpl(g):g instanceof s.PullAudioOutputStream?m=g:g!==void 0?m=new i.AudioFileWriter(g):m=void 0,this.synthesisRequestQueue.enqueue(new r.SynthesisRequest(f,p,d,v=>{if(this.privSynthesizing=!1,l)try{l(v)}catch(S){h&&h(S)}l=void 0,this.adapterSpeak().catch(()=>{})},v=>{h&&h(v)},m)),this.adapterSpeak().catch(()=>{})}catch(f){if(h)if(f instanceof Error){const m=f;h(m.name+": "+m.message)}else h(f);this.dispose(!0).catch(()=>{})}}async getVoices(p){const d=(0,t.createNoDashGuid)(),l=await this.privRestAdapter.getVoicesList(d);if(l.ok&&Array.isArray(l.json)){let h=l.json;return p&&p.length>0&&(h=h.filter(g=>!!g.Locale&&g.Locale.toLowerCase()===p.toLowerCase())),new s.SynthesisVoicesResult(d,h,void 0)}else return new s.SynthesisVoicesResult(d,void 0,`Error: ${l.status}: ${l.statusText}`)}};return Cr.SpeechSynthesizer=a,Cr}var yr={},Sc;function Jv(){if(Sc)return yr;Sc=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.SynthesisResult=void 0;let e=class{constructor(i,u,n,o){this.privResultId=i,this.privReason=u,this.privErrorDetails=n,this.privProperties=o}get resultId(){return this.privResultId}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get properties(){return this.privProperties}};return yr.SynthesisResult=e,yr}var Rr={},Cc;function Gv(){if(Cc)return Rr;Cc=1,Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.SpeechSynthesisResult=void 0;const e=A();let t=class extends e.SynthesisResult{constructor(u,n,o,s,r,a){super(u,n,s,r),this.privAudioData=o,this.privAudioDuration=a}get audioData(){return this.privAudioData}get audioDuration(){return this.privAudioDuration}};return Rr.SpeechSynthesisResult=t,Rr}var Pr={},yc;function Qv(){if(yc)return Pr;yc=1,Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.SpeechSynthesisEventArgs=void 0;let e=class{constructor(i){this.privResult=i}get result(){return this.privResult}};return Pr.SpeechSynthesisEventArgs=e,Pr}var Er={},Rc;function Xv(){if(Rc)return Er;Rc=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.SpeechSynthesisWordBoundaryEventArgs=void 0;let e=class{constructor(i,u,n,o,s,r){this.privAudioOffset=i,this.privDuration=u,this.privText=n,this.privWordLength=o,this.privTextOffset=s,this.privBoundaryType=r}get audioOffset(){return this.privAudioOffset}get duration(){return this.privDuration}get text(){return this.privText}get wordLength(){return this.privWordLength}get textOffset(){return this.privTextOffset}get boundaryType(){return this.privBoundaryType}};return Er.SpeechSynthesisWordBoundaryEventArgs=e,Er}var Tr={},Pc;function Zv(){if(Pc)return Tr;Pc=1,Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.SpeechSynthesisBookmarkEventArgs=void 0;let e=class{constructor(i,u){this.privAudioOffset=i,this.privText=u}get audioOffset(){return this.privAudioOffset}get text(){return this.privText}};return Tr.SpeechSynthesisBookmarkEventArgs=e,Tr}var Ar={},Ec;function Yv(){if(Ec)return Ar;Ec=1,Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.SpeechSynthesisVisemeEventArgs=void 0;let e=class{constructor(i,u,n){this.privAudioOffset=i,this.privVisemeId=u,this.privAnimation=n}get audioOffset(){return this.privAudioOffset}get visemeId(){return this.privVisemeId}get animation(){return this.privAnimation}};return Ar.SpeechSynthesisVisemeEventArgs=e,Ar}var Mn={},Tc;function $v(){return Tc||(Tc=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechSynthesisBoundaryType=void 0,(function(t){t.Word="WordBoundary",t.Punctuation="PunctuationBoundary",t.Sentence="SentenceBoundary"})(e.SpeechSynthesisBoundaryType||(e.SpeechSynthesisBoundaryType={}))})(Mn)),Mn}var Ir={},Ac;function ef(){if(Ac)return Ir;Ac=1,Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.SynthesisVoicesResult=void 0;const e=A();let t=class extends e.SynthesisResult{constructor(u,n,o){if(Array.isArray(n)){super(u,e.ResultReason.VoicesListRetrieved,void 0,new e.PropertyCollection),this.privVoices=[];for(const s of n)this.privVoices.push(new e.VoiceInfo(s))}else super(u,e.ResultReason.Canceled,o||"Error information unavailable",new e.PropertyCollection)}get voices(){return this.privVoices}};return Ir.SynthesisVoicesResult=t,Ir}var On={},Ic;function tf(){return Ic||(Ic=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.VoiceInfo=e.SynthesisVoiceType=e.SynthesisVoiceGender=void 0;var t;(function(s){s[s.Unknown=0]="Unknown",s[s.Female=1]="Female",s[s.Male=2]="Male",s[s.Neutral=3]="Neutral"})(t=e.SynthesisVoiceGender||(e.SynthesisVoiceGender={}));var i;(function(s){s[s.Unknown=0]="Unknown",s[s.OnlineNeural=1]="OnlineNeural",s[s.OnlineStandard=2]="OnlineStandard",s[s.OfflineNeural=3]="OfflineNeural",s[s.OfflineStandard=4]="OfflineStandard",s[s.OnlineNeuralHD=5]="OnlineNeuralHD"})(i=e.SynthesisVoiceType||(e.SynthesisVoiceType={}));const u={[t[t.Neutral]]:t.Neutral,[t[t.Male]]:t.Male,[t[t.Female]]:t.Female},n={Neural:i.OnlineNeural,NeuralHD:i.OnlineNeuralHD};class o{constructor(r){if(this.privStyleList=[],r){if(this.privName=r.Name,this.privLocale=r.Locale,this.privShortName=r.ShortName,this.privLocaleName=r.LocaleName,this.privDisplayName=r.DisplayName,this.privLocalName=r.LocalName,this.privVoiceType=n[r.VoiceType]||i.Unknown,this.privGender=u[r.Gender]||t.Unknown,r.StyleList&&Array.isArray(r.StyleList))for(const a of r.StyleList)this.privStyleList.push(a);this.privSampleRateHertz=r.SampleRateHertz,this.privStatus=r.Status,r.ExtendedPropertyMap&&(this.privExtendedPropertyMap=r.ExtendedPropertyMap),this.privWordsPerMinute=r.WordsPerMinute,Array.isArray(r.SecondaryLocaleList)&&(this.privSecondaryLocaleList=[...r.SecondaryLocaleList]),Array.isArray(r.RolePlayList)&&(this.privRolePlayList=[...r.RolePlayList]),r.VoiceTag&&(this.privVoiceTag=r.VoiceTag)}}get name(){return this.privName}get locale(){return this.privLocale}get shortName(){return this.privShortName}get displayName(){return this.privDisplayName}get localName(){return this.privLocalName}get localeName(){return this.privLocaleName}get gender(){return this.privGender}get voiceType(){return this.privVoiceType}get styleList(){return this.privStyleList}get sampleRateHertz(){return this.privSampleRateHertz}get status(){return this.privStatus}get extendedPropertyMap(){return this.privExtendedPropertyMap}get wordsPerMinute(){return this.privWordsPerMinute}get secondaryLocaleList(){return this.privSecondaryLocaleList}get rolePlayList(){return this.privRolePlayList}get voiceTag(){return this.privVoiceTag}}e.VoiceInfo=o})(On)),On}var wr={},wc;function rf(){if(wc)return wr;wc=1,Object.defineProperty(wr,"__esModule",{value:!0}),wr.SpeakerAudioDestination=void 0;const e=b(),t=Le(),i=ke(),u=1800,n={[i.AudioFormatTag.PCM]:"audio/wav",[i.AudioFormatTag.MuLaw]:"audio/x-wav",[i.AudioFormatTag.MP3]:"audio/mpeg",[i.AudioFormatTag.OGG_OPUS]:"audio/ogg",[i.AudioFormatTag.WEBM_OPUS]:"audio/webm; codecs=opus",[i.AudioFormatTag.ALaw]:"audio/x-wav",[i.AudioFormatTag.FLAC]:"audio/flac",[i.AudioFormatTag.AMR_WB]:"audio/amr-wb",[i.AudioFormatTag.G722]:"audio/G722"};let o=class{constructor(r){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=r||(0,e.createNoDashGuid)(),this.privIsPaused=!1,this.privIsClosed=!1}id(){return this.privId}write(r,a,c){this.privAudioBuffer!==void 0?(this.privAudioBuffer.push(r),this.updateSourceBuffer().then(()=>{a&&a()},p=>{c&&c(p)})):this.privAudioOutputStream!==void 0&&(this.privAudioOutputStream.write(r),this.privBytesReceived+=r.byteLength)}close(r,a){if(this.privIsClosed=!0,this.privSourceBuffer!==void 0)this.handleSourceBufferUpdateEnd().then(()=>{r&&r()},c=>{a&&a(c)});else if(this.privAudioOutputStream!==void 0&&typeof window<"u")if((this.privFormat.formatTag===i.AudioFormatTag.PCM||this.privFormat.formatTag===i.AudioFormatTag.MuLaw||this.privFormat.formatTag===i.AudioFormatTag.ALaw)&&this.privFormat.hasHeader===!1)console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header."),this.onAudioEnd&&this.onAudioEnd(this);else{let c=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(c).then(()=>{c=this.privFormat.addHeader(c);const p=new Blob([c],{type:n[this.privFormat.formatTag]});this.privAudio.src=window.URL.createObjectURL(p),this.notifyPlayback().then(()=>{r&&r()},d=>{a&&a(d)})},p=>{a&&a(p)})}else this.onAudioEnd&&this.onAudioEnd(this)}set format(r){if(typeof AudioContext<"u"||typeof window<"u"&&typeof window.webkitAudioContext<"u"){this.privFormat=r;const a=n[this.privFormat.formatTag];a===void 0?console.warn(`Unknown mimeType for format ${i.AudioFormatTag[this.privFormat.formatTag]}; playback is not supported.`):typeof MediaSource<"u"&&MediaSource.isTypeSupported(a)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=()=>{this.privMediaSourceOpened=!0,this.privMediaSource.duration=u,this.privSourceBuffer=this.privMediaSource.addSourceBuffer(a),this.privSourceBuffer.onupdate=()=>{this.updateSourceBuffer().catch(c=>{e.Events.instance.onEvent(new e.BackgroundEvent(c))})},this.privSourceBuffer.onupdateend=()=>{this.handleSourceBufferUpdateEnd().catch(c=>{e.Events.instance.onEvent(new e.BackgroundEvent(c))})},this.privSourceBuffer.onupdatestart=()=>{this.privAppendingToBuffer=!1}},this.updateSourceBuffer().catch(c=>{e.Events.instance.onEvent(new e.BackgroundEvent(c))})):(console.warn(`Format ${i.AudioFormatTag[this.privFormat.formatTag]} could not be played by MSE, streaming playback is not enabled.`),this.privAudioOutputStream=new t.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}}get volume(){var r;return((r=this.privAudio)==null?void 0:r.volume)??-1}set volume(r){this.privAudio&&(this.privAudio.volume=r)}mute(){this.privAudio&&(this.privAudio.muted=!0)}unmute(){this.privAudio&&(this.privAudio.muted=!1)}get isClosed(){return this.privIsClosed}get currentTime(){return this.privAudio!==void 0?this.privAudio.currentTime:-1}pause(){!this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.pause(),this.privIsPaused=!0)}resume(r,a){this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.play().then(()=>{r&&r()},c=>{a&&a(c)}),this.privIsPaused=!1)}get internalAudio(){return this.privAudio}async updateSourceBuffer(){if(this.privAudioBuffer!==void 0&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()){this.privAppendingToBuffer=!0;const r=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(r)}catch{this.privAudioBuffer.unshift(r),console.log("buffer filled, pausing addition of binaries until space is made");return}await this.notifyPlayback()}else this.canEndStream()&&await this.handleSourceBufferUpdateEnd()}async handleSourceBufferUpdateEnd(){this.canEndStream()&&this.sourceBufferAvailable()&&(this.privMediaSource.endOfStream(),await this.notifyPlayback())}async notifyPlayback(){!this.privPlaybackStarted&&this.privAudio!==void 0&&(this.privPlaybackStarted=!0,this.onAudioStart&&this.onAudioStart(this),this.privAudio.onended=()=>{this.onAudioEnd&&this.onAudioEnd(this)},this.privIsPaused||await this.privAudio.play())}canEndStream(){return this.isClosed&&this.privSourceBuffer!==void 0&&this.privAudioBuffer.length===0&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&this.privMediaSource.readyState==="open"}sourceBufferAvailable(){return this.privSourceBuffer!==void 0&&!this.privSourceBuffer.updating}};return wr.SpeakerAudioDestination=o,wr}var _r={},_c;function nf(){if(_c)return _r;_c=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.ConversationTranscriptionCanceledEventArgs=void 0;const e=Di();let t=class extends e.CancellationEventArgsBase{};return _r.ConversationTranscriptionCanceledEventArgs=t,_r}var br={},bc;function sf(){if(bc)return br;bc=1,Object.defineProperty(br,"__esModule",{value:!0}),br.MeetingTranscriptionCanceledEventArgs=void 0;const e=Di();let t=class extends e.CancellationEventArgsBase{};return br.MeetingTranscriptionCanceledEventArgs=t,br}var Dn={},Mc;function of(){return Mc||(Mc=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PronunciationAssessmentGradingSystem=void 0,(function(t){t[t.FivePoint=1]="FivePoint",t[t.HundredMark=2]="HundredMark"})(e.PronunciationAssessmentGradingSystem||(e.PronunciationAssessmentGradingSystem={}))})(Dn)),Dn}var kn={},Oc;function af(){return Oc||(Oc=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PronunciationAssessmentGranularity=void 0,(function(t){t[t.Phoneme=1]="Phoneme",t[t.Word=2]="Word",t[t.FullText=3]="FullText"})(e.PronunciationAssessmentGranularity||(e.PronunciationAssessmentGranularity={}))})(kn)),kn}var Mr={},Dc;function cf(){if(Dc)return Mr;Dc=1,Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.PronunciationAssessmentConfig=void 0;const e=D(),t=A();let i=class ed{constructor(n,o=t.PronunciationAssessmentGradingSystem.FivePoint,s=t.PronunciationAssessmentGranularity.Phoneme,r=!1){e.Contracts.throwIfNullOrUndefined(n,"referenceText"),this.privProperties=new t.PropertyCollection,this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_ReferenceText,n),this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_GradingSystem,t.PronunciationAssessmentGradingSystem[o]),this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_Granularity,t.PronunciationAssessmentGranularity[s]),this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_EnableMiscue,String(r))}static fromJSON(n){e.Contracts.throwIfNullOrUndefined(n,"json");const o=new ed("");return o.privProperties=new t.PropertyCollection,o.properties.setProperty(t.PropertyId.PronunciationAssessment_Json,n),o}toJSON(){return this.updateJson(),this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_Params)}applyTo(n){this.updateJson();const o=n.internalData;o.speechContext.setPronunciationAssessmentParams(this.properties.getProperty(t.PropertyId.PronunciationAssessment_Params),o.isSpeakerDiarizationEnabled)}get referenceText(){return this.properties.getProperty(t.PropertyId.PronunciationAssessment_ReferenceText)}set referenceText(n){e.Contracts.throwIfNullOrWhitespace(n,"referenceText"),this.properties.setProperty(t.PropertyId.PronunciationAssessment_ReferenceText,n)}set phonemeAlphabet(n){e.Contracts.throwIfNullOrWhitespace(n,"phonemeAlphabet"),this.privPhonemeAlphabet=n}set enableMiscue(n){const o=n?"true":"false";this.properties.setProperty(t.PropertyId.PronunciationAssessment_EnableMiscue,o)}get enableMiscue(){return this.properties.getProperty(t.PropertyId.PronunciationAssessment_EnableMiscue,"false").toLowerCase()==="true"}set nbestPhonemeCount(n){this.privNBestPhonemeCount=n}set enableProsodyAssessment(n){this.privEnableProsodyAssessment=n}get properties(){return this.privProperties}updateJson(){const n=this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_Json,"{}"),o=JSON.parse(n),s=this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_ReferenceText);s&&(o.referenceText=s);const r=this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_GradingSystem);r&&(o.gradingSystem=r);const a=this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_Granularity);a&&(o.granularity=a),this.privPhonemeAlphabet&&(o.phonemeAlphabet=this.privPhonemeAlphabet),this.privNBestPhonemeCount&&(o.nbestPhonemeCount=this.privNBestPhonemeCount),o.enableProsodyAssessment=this.privEnableProsodyAssessment,o.dimension="Comprehensive",this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_EnableMiscue)&&(o.enableMiscue=this.enableMiscue),this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_Params,JSON.stringify(o))}};return Mr.PronunciationAssessmentConfig=i,Mr}var Or={},kc;function uf(){if(kc)return Or;kc=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.PronunciationAssessmentResult=void 0;const e=D(),t=A();let i=class td{constructor(n){const o=JSON.parse(n);e.Contracts.throwIfNullOrUndefined(o.NBest[0],"NBest"),this.privPronJson=o.NBest[0]}static fromResult(n){e.Contracts.throwIfNullOrUndefined(n,"result");const o=n.properties.getProperty(t.PropertyId.SpeechServiceResponse_JsonResult);return e.Contracts.throwIfNullOrUndefined(o,"json"),new td(o)}get detailResult(){return this.privPronJson}get accuracyScore(){var n;return(n=this.detailResult.PronunciationAssessment)==null?void 0:n.AccuracyScore}get pronunciationScore(){var n;return(n=this.detailResult.PronunciationAssessment)==null?void 0:n.PronScore}get completenessScore(){var n;return(n=this.detailResult.PronunciationAssessment)==null?void 0:n.CompletenessScore}get fluencyScore(){var n;return(n=this.detailResult.PronunciationAssessment)==null?void 0:n.FluencyScore}get prosodyScore(){var n;return(n=this.detailResult.PronunciationAssessment)==null?void 0:n.ProsodyScore}};return Or.PronunciationAssessmentResult=i,Or}var Dr={},Nc;function pf(){if(Nc)return Dr;Nc=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.AvatarConfig=void 0;const e=D(),t=A();let i=class{constructor(n,o,s){this.privCustomized=!1,this.privUseBuiltInVoice=!1,e.Contracts.throwIfNullOrWhitespace(n,"character"),this.character=n,this.style=o,s===void 0&&(s=new t.AvatarVideoFormat),this.videoFormat=s}get customized(){return this.privCustomized}set customized(n){this.privCustomized=n}get useBuiltInVoice(){return this.privUseBuiltInVoice}set useBuiltInVoice(n){this.privUseBuiltInVoice=n}get photoAvatarBaseModel(){return this.privPhotoAvatarBaseModel}set photoAvatarBaseModel(n){this.privPhotoAvatarBaseModel=n}get backgroundColor(){return this.privBackgroundColor}set backgroundColor(n){this.privBackgroundColor=n}get backgroundImage(){return this.privBackgroundImage}set backgroundImage(n){this.privBackgroundImage=n}get remoteIceServers(){return this.privRemoteIceServers}set remoteIceServers(n){this.privRemoteIceServers=n}};return Dr.AvatarConfig=i,Dr}var Nn={},zc;function df(){return zc||(zc=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.AvatarEventArgs=e.AvatarEventTypes=void 0,(function(i){i.SwitchedToSpeaking="SwitchedToSpeaking",i.SwitchedToIdle="SwitchedToIdle",i.SessionClosed="SessionClosed"})(e.AvatarEventTypes||(e.AvatarEventTypes={}));class t{constructor(u,n){this.privOffset=u,this.privDescription=n}get type(){return this.privType}get offset(){return this.privOffset}get description(){return this.privDescription}}e.AvatarEventArgs=t})(Nn)),Nn}var kr={},Nr={},jc;function rd(){if(jc)return Nr;jc=1,Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.SpeechSynthesisConnectionFactory=void 0;const e=U(),t=A(),i=se(),u=w(),n=V(),o=pe();let s=class{constructor(){this.synthesisUri="/tts/cognitiveservices/websocket/v1"}async create(a,c,p){let d=a.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);const l=a.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,void 0),h=i.ConnectionFactoryBase.getHostSuffix(l),g=a.parameters.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId,void 0),f=g===void 0?"tts":"voice",m=a.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,"wss://"+l+"."+f+".speech"+h),v={},S={};if(c.token!==void 0&&c.token!==""&&(S[c.headerName]=c.token),S[n.HeaderNames.ConnectionId]=p,g!==void 0&&g!==""&&(!d||d.search(o.QueryParameterNames.CustomVoiceDeploymentId)===-1)&&(v[o.QueryParameterNames.CustomVoiceDeploymentId]=g),a.avatarEnabled&&(!d||d.search(o.QueryParameterNames.EnableAvatar)===-1)&&(v[o.QueryParameterNames.EnableAvatar]="true"),d){const y=new URL(d),R=y.pathname;(R===""||R==="/")&&(y.pathname=this.synthesisUri,d=await i.ConnectionFactoryBase.getRedirectUrlFromEndpoint(y.toString()))}d||(d=m+this.synthesisUri),a.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,d);const C=a.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new e.WebsocketConnection(d,v,S,new u.WebsocketMessageFormatter,e.ProxyInfo.fromParameters(a.parameters),C,p)}};return Nr.SpeechSynthesisConnectionFactory=s,Nr}var Lc;function hf(){if(Lc)return kr;Lc=1,Object.defineProperty(kr,"__esModule",{value:!0}),kr.AvatarSynthesizer=void 0;const e=rd(),t=w(),i=b(),u=Oi(),n=A(),o=D(),s=As();let r=class extends n.Synthesizer{constructor(c,p){super(c),o.Contracts.throwIfNullOrUndefined(p,"avatarConfig"),this.privConnectionFactory=new e.SpeechSynthesisConnectionFactory,this.privAvatarConfig=p,this.implCommonSynthesizeSetup()}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=u.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(n.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm)}async startAvatarAsync(c){o.Contracts.throwIfNullOrUndefined(c,"peerConnection"),this.privIceServers=c.getConfiguration().iceServers,o.Contracts.throwIfNullOrUndefined(this.privIceServers,"Ice servers must be set.");const p=new i.Deferred;c.onicegatheringstatechange=()=>{i.Events.instance.onEvent(new i.PlatformEvent("peer connection: ice gathering state: "+c.iceGatheringState,i.EventType.Debug)),c.iceGatheringState==="complete"&&(i.Events.instance.onEvent(new i.PlatformEvent("peer connection: ice gathering complete.",i.EventType.Info)),p.resolve())},c.onicecandidate=f=>{f.candidate?i.Events.instance.onEvent(new i.PlatformEvent("peer connection: ice candidate: "+f.candidate.candidate,i.EventType.Debug)):(i.Events.instance.onEvent(new i.PlatformEvent("peer connection: ice candidate: complete",i.EventType.Debug)),p.resolve())},setTimeout(()=>{c.iceGatheringState!=="complete"&&(i.Events.instance.onEvent(new i.PlatformEvent("peer connection: ice gathering timeout.",i.EventType.Warning)),p.resolve())},2e3);const d=await c.createOffer();await c.setLocalDescription(d),await p.promise,i.Events.instance.onEvent(new i.PlatformEvent("peer connection: got local SDP.",i.EventType.Info)),this.privProperties.setProperty(n.PropertyId.TalkingAvatarService_WebRTC_SDP,JSON.stringify(c.localDescription));const l=await this.speak("",!1);if(l.reason!==n.ResultReason.SynthesizingAudioCompleted)return new n.SynthesisResult(l.resultId,l.reason,l.errorDetails,l.properties);const h=atob(l.properties.getProperty(n.PropertyId.TalkingAvatarService_WebRTC_SDP)),g=new RTCSessionDescription(JSON.parse(h));return await c.setRemoteDescription(g),new n.SynthesisResult(l.resultId,l.reason,void 0,l.properties)}async speakTextAsync(c){const p=await this.speak(c,!1);return new n.SynthesisResult(p.resultId,p.reason,p.errorDetails,p.properties)}async speakSsmlAsync(c){const p=await this.speak(c,!0);return new n.SynthesisResult(p.resultId,p.reason,p.errorDetails,p.properties)}async stopSpeakingAsync(){for(;this.synthesisRequestQueue.length()>0;)(await this.synthesisRequestQueue.dequeue()).err("Synthesis is canceled by user.");return this.privAdapter.stopSpeaking()}async stopAvatarAsync(){return o.Contracts.throwIfDisposed(this.privDisposed),this.dispose(!0)}async close(){if(!this.privDisposed)return this.dispose(!0)}get iceServers(){return this.privIceServers}createSynthesisAdapter(c,p,d){return new t.AvatarSynthesisAdapter(c,p,d,this,this.privAvatarConfig)}createRestSynthesisAdapter(c,p){}createSynthesizerConfig(c){const p=super.createSynthesizerConfig(c);return p.avatarEnabled=!0,p}async speak(c,p){const d=(0,i.createNoDashGuid)(),l=new i.Deferred;return this.synthesisRequestQueue.enqueue(new s.SynthesisRequest(d,c,p,h=>{l.resolve(h),this.privSynthesizing=!1,this.adapterSpeak()},h=>{l.reject(h),this.privSynthesizing=!1})),this.adapterSpeak(),l.promise}};return kr.AvatarSynthesizer=r,kr}var Ie={},qc;function lf(){if(qc)return Ie;qc=1,Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.AvatarVideoFormat=Ie.Coordinate=void 0;class e{constructor(u,n){this.x=u,this.y=n}}Ie.Coordinate=e;let t=class{constructor(u="H264",n=2e6,o=1920,s=1080){this.codec=u,this.bitrate=n,this.width=o,this.height=s}setCropRange(u,n){this.cropRange={bottomRight:n,topLeft:u}}};return Ie.AvatarVideoFormat=t,Ie}var zr={},Bc;function vf(){if(Bc)return zr;Bc=1,Object.defineProperty(zr,"__esModule",{value:!0}),zr.AvatarWebRTCConnectionResult=void 0;const e=A();let t=class extends e.SynthesisResult{constructor(u,n,o,s,r){super(n,o,s,r),this.privSDPAnswer=u}get SDPAnswer(){return this.privSDPAnswer}};return zr.AvatarWebRTCConnectionResult=t,zr}var jr={},Fc;function ff(){if(Fc)return jr;Fc=1,Object.defineProperty(jr,"__esModule",{value:!0}),jr.Diagnostics=void 0;const e=U(),t=b();let i=class{static SetLoggingLevel(n){this.privListener=new e.ConsoleLoggingListener(n),t.Events.instance.attachConsoleListener(this.privListener)}static StartConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!0)}static StopConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!1)}static SetLogOutputPath(n){if(typeof window>"u")this.privListener&&(this.privListener.logPath=n);else throw new Error("File system logging not available in browser.")}static set onLogOutput(n){this.privListener&&(this.privListener.logCallback=n)}};return jr.Diagnostics=i,i.privListener=void 0,jr}var xc;function A(){return xc||(xc=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CustomCommandsConfig=e.BotFrameworkConfig=e.DialogServiceConfig=e.PhraseListGrammar=e.Connection=e.ServiceEventArgs=e.ConnectionEventArgs=e.CancellationErrorCode=e.CancellationDetails=e.CancellationDetailsBase=e.TranslationRecognitionCanceledEventArgs=e.NoMatchDetails=e.NoMatchReason=e.Translations=e.TranslationRecognizer=e.SpeechRecognizer=e.Recognizer=e.PropertyId=e.PropertyCollection=e.SpeechTranslationConfigImpl=e.SpeechTranslationConfig=e.SpeechConfigImpl=e.SpeechConfig=e.ResultReason=e.TranslationSynthesisResult=e.TranslationRecognitionResult=e.TranslationSynthesisEventArgs=e.TranslationRecognitionEventArgs=e.SpeechRecognitionCanceledEventArgs=e.MeetingTranscriptionEventArgs=e.ConversationTranscriptionEventArgs=e.SpeechRecognitionEventArgs=e.SpeechRecognitionResult=e.RecognitionResult=e.OutputFormat=e.RecognitionEventArgs=e.SessionEventArgs=e.KeywordRecognitionModel=e.PushAudioOutputStreamCallback=e.PullAudioInputStreamCallback=e.CancellationReason=e.PushAudioOutputStream=e.PullAudioOutputStream=e.AudioOutputStream=e.PushAudioInputStream=e.PullAudioInputStream=e.AudioInputStream=e.AudioFormatTag=e.AudioStreamFormat=e.AudioConfig=void 0,e.AvatarSynthesizer=e.AvatarEventArgs=e.AvatarConfig=e.LanguageIdMode=e.PronunciationAssessmentResult=e.PronunciationAssessmentConfig=e.PronunciationAssessmentGranularity=e.PronunciationAssessmentGradingSystem=e.MeetingTranscriptionCanceledEventArgs=e.ConversationTranscriptionCanceledEventArgs=e.SpeakerAudioDestination=e.VoiceInfo=e.SynthesisVoiceType=e.SynthesisVoiceGender=e.SynthesisVoicesResult=e.SpeechSynthesisBoundaryType=e.SpeechSynthesisVisemeEventArgs=e.SpeechSynthesisBookmarkEventArgs=e.SpeechSynthesisWordBoundaryEventArgs=e.SpeechSynthesisEventArgs=e.SpeechSynthesisResult=e.SynthesisResult=e.SpeechSynthesizer=e.SpeechSynthesisOutputFormat=e.Synthesizer=e.User=e.ParticipantChangedReason=e.Participant=e.MeetingTranscriber=e.Meeting=e.ConversationTranscriptionResult=e.ConversationTranscriber=e.ConversationTranslator=e.ConversationTranslationResult=e.ConversationTranslationEventArgs=e.ConversationTranslationCanceledEventArgs=e.ConversationParticipantsChangedEventArgs=e.ConversationExpirationEventArgs=e.Conversation=e.SourceLanguageConfig=e.AutoDetectSourceLanguageResult=e.AutoDetectSourceLanguageConfig=e.ConnectionMessage=e.ConnectionMessageEventArgs=e.BaseAudioPlayer=e.ProfanityOption=e.ServicePropertyChannel=e.TurnStatusReceivedEventArgs=e.ActivityReceivedEventArgs=e.DialogServiceConnector=void 0,e.LogLevel=e.Diagnostics=e.AvatarWebRTCConnectionResult=e.Coordinate=e.AvatarVideoFormat=void 0;var t=xl();Object.defineProperty(e,"AudioConfig",{enumerable:!0,get:function(){return t.AudioConfig}});var i=ke();Object.defineProperty(e,"AudioStreamFormat",{enumerable:!0,get:function(){return i.AudioStreamFormat}}),Object.defineProperty(e,"AudioFormatTag",{enumerable:!0,get:function(){return i.AudioFormatTag}});var u=Mp();Object.defineProperty(e,"AudioInputStream",{enumerable:!0,get:function(){return u.AudioInputStream}}),Object.defineProperty(e,"PullAudioInputStream",{enumerable:!0,get:function(){return u.PullAudioInputStream}}),Object.defineProperty(e,"PushAudioInputStream",{enumerable:!0,get:function(){return u.PushAudioInputStream}});var n=Le();Object.defineProperty(e,"AudioOutputStream",{enumerable:!0,get:function(){return n.AudioOutputStream}}),Object.defineProperty(e,"PullAudioOutputStream",{enumerable:!0,get:function(){return n.PullAudioOutputStream}}),Object.defineProperty(e,"PushAudioOutputStream",{enumerable:!0,get:function(){return n.PushAudioOutputStream}});var o=Ul();Object.defineProperty(e,"CancellationReason",{enumerable:!0,get:function(){return o.CancellationReason}});var s=Wl();Object.defineProperty(e,"PullAudioInputStreamCallback",{enumerable:!0,get:function(){return s.PullAudioInputStreamCallback}});var r=Hl();Object.defineProperty(e,"PushAudioOutputStreamCallback",{enumerable:!0,get:function(){return r.PushAudioOutputStreamCallback}});var a=Kl();Object.defineProperty(e,"KeywordRecognitionModel",{enumerable:!0,get:function(){return a.KeywordRecognitionModel}});var c=Vl();Object.defineProperty(e,"SessionEventArgs",{enumerable:!0,get:function(){return c.SessionEventArgs}});var p=Jl();Object.defineProperty(e,"RecognitionEventArgs",{enumerable:!0,get:function(){return p.RecognitionEventArgs}});var d=Gl();Object.defineProperty(e,"OutputFormat",{enumerable:!0,get:function(){return d.OutputFormat}});var l=Ql();Object.defineProperty(e,"RecognitionResult",{enumerable:!0,get:function(){return l.RecognitionResult}});var h=Xl();Object.defineProperty(e,"SpeechRecognitionResult",{enumerable:!0,get:function(){return h.SpeechRecognitionResult}});var g=Zl();Object.defineProperty(e,"SpeechRecognitionEventArgs",{enumerable:!0,get:function(){return g.SpeechRecognitionEventArgs}}),Object.defineProperty(e,"ConversationTranscriptionEventArgs",{enumerable:!0,get:function(){return g.ConversationTranscriptionEventArgs}}),Object.defineProperty(e,"MeetingTranscriptionEventArgs",{enumerable:!0,get:function(){return g.MeetingTranscriptionEventArgs}});var f=Yl();Object.defineProperty(e,"SpeechRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return f.SpeechRecognitionCanceledEventArgs}});var m=$l();Object.defineProperty(e,"TranslationRecognitionEventArgs",{enumerable:!0,get:function(){return m.TranslationRecognitionEventArgs}});var v=ev();Object.defineProperty(e,"TranslationSynthesisEventArgs",{enumerable:!0,get:function(){return v.TranslationSynthesisEventArgs}});var S=Np();Object.defineProperty(e,"TranslationRecognitionResult",{enumerable:!0,get:function(){return S.TranslationRecognitionResult}});var C=tv();Object.defineProperty(e,"TranslationSynthesisResult",{enumerable:!0,get:function(){return C.TranslationSynthesisResult}});var y=rv();Object.defineProperty(e,"ResultReason",{enumerable:!0,get:function(){return y.ResultReason}});var R=iv();Object.defineProperty(e,"SpeechConfig",{enumerable:!0,get:function(){return R.SpeechConfig}}),Object.defineProperty(e,"SpeechConfigImpl",{enumerable:!0,get:function(){return R.SpeechConfigImpl}});var T=nv();Object.defineProperty(e,"SpeechTranslationConfig",{enumerable:!0,get:function(){return T.SpeechTranslationConfig}}),Object.defineProperty(e,"SpeechTranslationConfigImpl",{enumerable:!0,get:function(){return T.SpeechTranslationConfigImpl}});var E=jp();Object.defineProperty(e,"PropertyCollection",{enumerable:!0,get:function(){return E.PropertyCollection}});var P=Ps();Object.defineProperty(e,"PropertyId",{enumerable:!0,get:function(){return P.PropertyId}});var I=sv();Object.defineProperty(e,"Recognizer",{enumerable:!0,get:function(){return I.Recognizer}});var M=ov();Object.defineProperty(e,"SpeechRecognizer",{enumerable:!0,get:function(){return M.SpeechRecognizer}});var k=av();Object.defineProperty(e,"TranslationRecognizer",{enumerable:!0,get:function(){return k.TranslationRecognizer}});var ee=cv();Object.defineProperty(e,"Translations",{enumerable:!0,get:function(){return ee.Translations}});var _=uv();Object.defineProperty(e,"NoMatchReason",{enumerable:!0,get:function(){return _.NoMatchReason}});var Ne=pv();Object.defineProperty(e,"NoMatchDetails",{enumerable:!0,get:function(){return Ne.NoMatchDetails}});var ki=dv();Object.defineProperty(e,"TranslationRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return ki.TranslationRecognitionCanceledEventArgs}});var Ui=Wp();Object.defineProperty(e,"CancellationDetailsBase",{enumerable:!0,get:function(){return Ui.CancellationDetailsBase}});var de=hv();Object.defineProperty(e,"CancellationDetails",{enumerable:!0,get:function(){return de.CancellationDetails}});var N=lv();Object.defineProperty(e,"CancellationErrorCode",{enumerable:!0,get:function(){return N.CancellationErrorCode}});var qe=vv();Object.defineProperty(e,"ConnectionEventArgs",{enumerable:!0,get:function(){return qe.ConnectionEventArgs}});var Wi=fv();Object.defineProperty(e,"ServiceEventArgs",{enumerable:!0,get:function(){return Wi.ServiceEventArgs}});var yd=Fp();Object.defineProperty(e,"Connection",{enumerable:!0,get:function(){return yd.Connection}});var Rd=gv();Object.defineProperty(e,"PhraseListGrammar",{enumerable:!0,get:function(){return Rd.PhraseListGrammar}});var Pd=Es();Object.defineProperty(e,"DialogServiceConfig",{enumerable:!0,get:function(){return Pd.DialogServiceConfig}});var Ed=mv();Object.defineProperty(e,"BotFrameworkConfig",{enumerable:!0,get:function(){return Ed.BotFrameworkConfig}});var Td=Sv();Object.defineProperty(e,"CustomCommandsConfig",{enumerable:!0,get:function(){return Td.CustomCommandsConfig}});var Ad=yv();Object.defineProperty(e,"DialogServiceConnector",{enumerable:!0,get:function(){return Ad.DialogServiceConnector}});var Id=Rv();Object.defineProperty(e,"ActivityReceivedEventArgs",{enumerable:!0,get:function(){return Id.ActivityReceivedEventArgs}});var wd=Ev();Object.defineProperty(e,"TurnStatusReceivedEventArgs",{enumerable:!0,get:function(){return wd.TurnStatusReceivedEventArgs}});var _d=Tv();Object.defineProperty(e,"ServicePropertyChannel",{enumerable:!0,get:function(){return _d.ServicePropertyChannel}});var bd=Av();Object.defineProperty(e,"ProfanityOption",{enumerable:!0,get:function(){return bd.ProfanityOption}});var Md=Iv();Object.defineProperty(e,"BaseAudioPlayer",{enumerable:!0,get:function(){return Md.BaseAudioPlayer}});var Od=wv();Object.defineProperty(e,"ConnectionMessageEventArgs",{enumerable:!0,get:function(){return Od.ConnectionMessageEventArgs}});var Dd=Bp();Object.defineProperty(e,"ConnectionMessage",{enumerable:!0,get:function(){return Dd.ConnectionMessage}});var kd=_v();Object.defineProperty(e,"AutoDetectSourceLanguageConfig",{enumerable:!0,get:function(){return kd.AutoDetectSourceLanguageConfig}});var Nd=bv();Object.defineProperty(e,"AutoDetectSourceLanguageResult",{enumerable:!0,get:function(){return Nd.AutoDetectSourceLanguageResult}});var zd=Mv();Object.defineProperty(e,"SourceLanguageConfig",{enumerable:!0,get:function(){return zd.SourceLanguageConfig}});var x=Ts();Object.defineProperty(e,"Conversation",{enumerable:!0,get:function(){return x.Conversation}}),Object.defineProperty(e,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return x.ConversationExpirationEventArgs}}),Object.defineProperty(e,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return x.ConversationParticipantsChangedEventArgs}}),Object.defineProperty(e,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return x.ConversationTranslationCanceledEventArgs}}),Object.defineProperty(e,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return x.ConversationTranslationEventArgs}}),Object.defineProperty(e,"ConversationTranslationResult",{enumerable:!0,get:function(){return x.ConversationTranslationResult}}),Object.defineProperty(e,"ConversationTranslator",{enumerable:!0,get:function(){return x.ConversationTranslator}}),Object.defineProperty(e,"ConversationTranscriber",{enumerable:!0,get:function(){return x.ConversationTranscriber}}),Object.defineProperty(e,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return x.ConversationTranscriptionResult}}),Object.defineProperty(e,"Meeting",{enumerable:!0,get:function(){return x.Meeting}}),Object.defineProperty(e,"MeetingTranscriber",{enumerable:!0,get:function(){return x.MeetingTranscriber}}),Object.defineProperty(e,"Participant",{enumerable:!0,get:function(){return x.Participant}}),Object.defineProperty(e,"ParticipantChangedReason",{enumerable:!0,get:function(){return x.ParticipantChangedReason}}),Object.defineProperty(e,"User",{enumerable:!0,get:function(){return x.User}});var jd=As();Object.defineProperty(e,"Synthesizer",{enumerable:!0,get:function(){return jd.Synthesizer}});var Ld=Op();Object.defineProperty(e,"SpeechSynthesisOutputFormat",{enumerable:!0,get:function(){return Ld.SpeechSynthesisOutputFormat}});var qd=Vv();Object.defineProperty(e,"SpeechSynthesizer",{enumerable:!0,get:function(){return qd.SpeechSynthesizer}});var Bd=Jv();Object.defineProperty(e,"SynthesisResult",{enumerable:!0,get:function(){return Bd.SynthesisResult}});var Fd=Gv();Object.defineProperty(e,"SpeechSynthesisResult",{enumerable:!0,get:function(){return Fd.SpeechSynthesisResult}});var xd=Qv();Object.defineProperty(e,"SpeechSynthesisEventArgs",{enumerable:!0,get:function(){return xd.SpeechSynthesisEventArgs}});var Ud=Xv();Object.defineProperty(e,"SpeechSynthesisWordBoundaryEventArgs",{enumerable:!0,get:function(){return Ud.SpeechSynthesisWordBoundaryEventArgs}});var Wd=Zv();Object.defineProperty(e,"SpeechSynthesisBookmarkEventArgs",{enumerable:!0,get:function(){return Wd.SpeechSynthesisBookmarkEventArgs}});var Hd=Yv();Object.defineProperty(e,"SpeechSynthesisVisemeEventArgs",{enumerable:!0,get:function(){return Hd.SpeechSynthesisVisemeEventArgs}});var Kd=$v();Object.defineProperty(e,"SpeechSynthesisBoundaryType",{enumerable:!0,get:function(){return Kd.SpeechSynthesisBoundaryType}});var Vd=ef();Object.defineProperty(e,"SynthesisVoicesResult",{enumerable:!0,get:function(){return Vd.SynthesisVoicesResult}});var Hi=tf();Object.defineProperty(e,"SynthesisVoiceGender",{enumerable:!0,get:function(){return Hi.SynthesisVoiceGender}}),Object.defineProperty(e,"SynthesisVoiceType",{enumerable:!0,get:function(){return Hi.SynthesisVoiceType}}),Object.defineProperty(e,"VoiceInfo",{enumerable:!0,get:function(){return Hi.VoiceInfo}});var Jd=rf();Object.defineProperty(e,"SpeakerAudioDestination",{enumerable:!0,get:function(){return Jd.SpeakerAudioDestination}});var Gd=nf();Object.defineProperty(e,"ConversationTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return Gd.ConversationTranscriptionCanceledEventArgs}});var Qd=sf();Object.defineProperty(e,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return Qd.MeetingTranscriptionCanceledEventArgs}});var Xd=of();Object.defineProperty(e,"PronunciationAssessmentGradingSystem",{enumerable:!0,get:function(){return Xd.PronunciationAssessmentGradingSystem}});var Zd=af();Object.defineProperty(e,"PronunciationAssessmentGranularity",{enumerable:!0,get:function(){return Zd.PronunciationAssessmentGranularity}});var Yd=cf();Object.defineProperty(e,"PronunciationAssessmentConfig",{enumerable:!0,get:function(){return Yd.PronunciationAssessmentConfig}});var $d=uf();Object.defineProperty(e,"PronunciationAssessmentResult",{enumerable:!0,get:function(){return $d.PronunciationAssessmentResult}});var eh=Vp();Object.defineProperty(e,"LanguageIdMode",{enumerable:!0,get:function(){return eh.LanguageIdMode}});var th=pf();Object.defineProperty(e,"AvatarConfig",{enumerable:!0,get:function(){return th.AvatarConfig}});var rh=df();Object.defineProperty(e,"AvatarEventArgs",{enumerable:!0,get:function(){return rh.AvatarEventArgs}});var ih=hf();Object.defineProperty(e,"AvatarSynthesizer",{enumerable:!0,get:function(){return ih.AvatarSynthesizer}});var ws=lf();Object.defineProperty(e,"AvatarVideoFormat",{enumerable:!0,get:function(){return ws.AvatarVideoFormat}}),Object.defineProperty(e,"Coordinate",{enumerable:!0,get:function(){return ws.Coordinate}});var nh=vf();Object.defineProperty(e,"AvatarWebRTCConnectionResult",{enumerable:!0,get:function(){return nh.AvatarWebRTCConnectionResult}});var sh=ff();Object.defineProperty(e,"Diagnostics",{enumerable:!0,get:function(){return sh.Diagnostics}});var oh=wp();Object.defineProperty(e,"LogLevel",{enumerable:!0,get:function(){return oh.LogLevel}})})(fn)),fn}var Uc;function gf(){if(Uc)return Ct;Uc=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.ProxyInfo=void 0;const e=A();let t=class id{constructor(u,n,o,s){this.privProxyHostName=u,this.privProxyPort=n,this.privProxyUserName=o,this.privProxyPassword=s}static fromParameters(u){return new id(u.getProperty(e.PropertyId.SpeechServiceConnection_ProxyHostName),parseInt(u.getProperty(e.PropertyId.SpeechServiceConnection_ProxyPort),10),u.getProperty(e.PropertyId.SpeechServiceConnection_ProxyUserName),u.getProperty(e.PropertyId.SpeechServiceConnection_ProxyPassword))}static fromRecognizerConfig(u){return this.fromParameters(u.parameters)}get HostName(){return this.privProxyHostName}get Port(){return this.privProxyPort}get UserName(){return this.privProxyUserName}get Password(){return this.privProxyPassword}};return Ct.ProxyInfo=t,Ct}var Lr={},zn,Wc;function mf(){if(Wc)return zn;Wc=1;const e=new Set(["json","buffer","string"]);return zn=t=>(...i)=>{const u=new Set;let n,o,s,r="";return i.forEach(a=>{if(typeof a=="string")if(a.toUpperCase()===a)if(n){const c=`Can't set method to ${a}, already set to ${n}.`;throw new Error(c)}else n=a;else if(a.startsWith("http:")||a.startsWith("https:"))r=a;else if(e.has(a))o=a;else throw new Error(`Unknown encoding, ${a}`);else if(typeof a=="number")u.add(a);else if(typeof a=="object")if(Array.isArray(a)||a instanceof Set)a.forEach(c=>u.add(c));else{if(s)throw new Error("Cannot set headers twice.");s=a}else throw new Error(`Unknown type: ${typeof a}`)}),n||(n="GET"),u.size===0&&u.add(200),t(u,n,o,s,r)},zn}var jn,Hc;function Sf(){if(Hc)return jn;Hc=1;const e=mf();class t extends Error{constructor(n,...o){super(...o),Error.captureStackTrace&&Error.captureStackTrace(this,t),this.name="StatusError",this.message=n.statusMessage,this.statusCode=n.status,this.res=n,this.json=n.json.bind(n),this.text=n.text.bind(n),this.arrayBuffer=n.arrayBuffer.bind(n);let s;Object.defineProperty(this,"responseBody",{get:()=>(s||(s=this.arrayBuffer()),s)}),this.headers={};for(const[a,c]of n.headers.entries())this.headers[a.toLowerCase()]=c}}return jn=e((u,n,o,s,r)=>async(a,c,p={})=>{a=r+(a||"");let d=new URL(a);if(s||(s={}),d.username&&(s.Authorization="Basic "+btoa(d.username+":"+d.password),d=new URL(d.protocol+"//"+d.host+d.pathname+d.search)),d.protocol!=="https:"&&d.protocol!=="http:")throw new Error(`Unknown protocol, ${d.protocol}`);if(c&&!(c instanceof ArrayBuffer||ArrayBuffer.isView(c)||typeof c=="string"))if(typeof c=="object")c=JSON.stringify(c),s["Content-Type"]="application/json";else throw new Error("Unknown body type.");p=new Headers({...s||{},...p});const l=await fetch(d,{method:n,headers:p,body:c});if(l.statusCode=l.status,!u.has(l.status))throw new t(l);return o==="json"?l.json():o==="buffer"?l.arrayBuffer():o==="string"?l.text():l}),jn}var Kc;function Cf(){return Kc||(Kc=1,(function(e){var t=Lr&&Lr.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(e,"__esModule",{value:!0}),e.RestMessageAdapter=e.RestRequestType=void 0;const i=t(Sf()),u=b();var n;(function(s){s.Get="GET",s.Post="POST",s.Delete="DELETE",s.File="file"})(n=e.RestRequestType||(e.RestRequestType={}));let o=class{constructor(r){if(!r)throw new u.ArgumentNullError("configParams");this.privHeaders=r.headers,this.privIgnoreCache=r.ignoreCache}static extractHeaderValue(r,a){let c="";try{const p=a.trim().split(/[\r\n]+/),d={};p.forEach(l=>{const h=l.split(": "),g=h.shift().toLowerCase(),f=h.join(": ");d[g]=f}),c=d[r.toLowerCase()]}catch{}return c}set options(r){this.privHeaders=r.headers,this.privIgnoreCache=r.ignoreCache}setHeaders(r,a){this.privHeaders[r]=a}request(r,a,c={},p=null){const d=new u.Deferred,l=r===n.File?"POST":r,h=(f,m={})=>{const v=f;return{data:JSON.stringify(m),headers:JSON.stringify(f.headers),json:m,ok:f.statusCode>=200&&f.statusCode<300,status:f.statusCode,statusText:m.error?m.error.message:v.statusText?v.statusText:v.statusMessage}},g=f=>{const m=(0,i.default)(a,l,this.privHeaders,200,201,202,204,400,401,402,403,404),v=this.queryParams(c)===""?"":`?${this.queryParams(c)}`;m(v,f).then(async S=>{if(r===n.Delete||S.statusCode===204)d.resolve(h(S));else try{const C=await S.json();d.resolve(h(S,C))}catch{d.resolve(h(S))}}).catch(S=>{d.reject(S)})};return this.privIgnoreCache&&(this.privHeaders["Cache-Control"]="no-cache"),r===n.Post&&p&&(this.privHeaders["content-type"]="application/json",this.privHeaders["Content-Type"]="application/json"),g(p),d.promise}queryParams(r={}){return Object.keys(r).map(a=>encodeURIComponent(a)+"="+encodeURIComponent(r[a])).join("&")}};e.RestMessageAdapter=o})(Lr)),Lr}var qr={},Vc;function nd(){if(Vc)return qr;Vc=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.RestConfigBase=void 0;let e=class Li{static get requestOptions(){return Li.privDefaultRequestOptions}static get configParams(){return Li.privDefaultParams}static get restErrors(){return Li.privRestErrors}};return qr.RestConfigBase=e,e.privDefaultRequestOptions={headers:{Accept:"application/json"},ignoreCache:!1,timeout:1e4},e.privRestErrors={authInvalidSubscriptionKey:"You must specify either an authentication token to use, or a Cognitive Speech subscription key.",authInvalidSubscriptionRegion:"You must specify the Cognitive Speech region to use.",invalidArgs:"Required input not found: {arg}.",invalidCreateJoinConversationResponse:"Creating/Joining conversation failed with HTTP {status}.",invalidParticipantRequest:"The requested participant was not found.",permissionDeniedConnect:"Required credentials not found.",permissionDeniedConversation:"Invalid operation: only the host can {command} the conversation.",permissionDeniedParticipant:"Invalid operation: only the host can {command} a participant.",permissionDeniedSend:"Invalid operation: the conversation is not in a connected state.",permissionDeniedStart:"Invalid operation: there is already an active conversation."},e.privDefaultParams={apiVersion:"api-version",authorization:"Authorization",clientAppId:"X-ClientAppId",contentTypeKey:"Content-Type",correlationId:"X-CorrelationId",languageCode:"language",nickname:"nickname",profanity:"profanity",requestId:"X-RequestId",roomId:"roomid",sessionToken:"token",subscriptionKey:"Ocp-Apim-Subscription-Key",subscriptionRegion:"Ocp-Apim-Subscription-Region",token:"X-CapitoToken"},qr}var Jc;function U(){return Jc||(Jc=1,(function(e){var t=me&&me.__createBinding||(Object.create?(function(u,n,o,s){s===void 0&&(s=o),Object.defineProperty(u,s,{enumerable:!0,get:function(){return n[o]}})}):(function(u,n,o,s){s===void 0&&(s=o),u[s]=n[o]})),i=me&&me.__exportStar||function(u,n){for(var o in u)o!=="default"&&!Object.prototype.hasOwnProperty.call(n,o)&&t(n,u,o)};Object.defineProperty(e,"__esModule",{value:!0}),i(Nl(),e),i(zl(),e),i(jl(),e),i(Ll(),e),i(ql(),e),i(Bl(),e),i(_p(),e),i(Fl(),e),i(gf(),e),i(Cf(),e),i(nd(),e)})(me)),me}var Br={},Gc;function xi(){if(Gc)return Br;Gc=1,Object.defineProperty(Br,"__esModule",{value:!0}),Br.SpeechConnectionMessage=void 0;const e=b(),t=V();class i extends e.ConnectionMessage{constructor(n,o,s,r,a,c,p,d){if(!o)throw new e.ArgumentNullError("path");if(!s)throw new e.ArgumentNullError("requestId");const l={};if(l[t.HeaderNames.Path]=o,l[t.HeaderNames.RequestId]=s,l[t.HeaderNames.RequestTimestamp]=new Date().toISOString(),r&&(l[t.HeaderNames.ContentType]=r),c&&(l[t.HeaderNames.RequestStreamId]=c),p)for(const h in p)h&&(l[h]=p[h]);d?super(n,a,l,d):super(n,a,l),this.privPath=o,this.privRequestId=s,this.privContentType=r,this.privStreamId=c,this.privAdditionalHeaders=p}get path(){return this.privPath}get requestId(){return this.privRequestId}get contentType(){return this.privContentType}get streamId(){return this.privStreamId}get additionalHeaders(){return this.privAdditionalHeaders}static fromConnectionMessage(n){let o=null,s=null,r=null,a=null;const c={};if(n.headers)for(const p in n.headers)p&&(p.toLowerCase()===t.HeaderNames.Path.toLowerCase()?o=n.headers[p]:p.toLowerCase()===t.HeaderNames.RequestId.toLowerCase()?s=n.headers[p]:p.toLowerCase()===t.HeaderNames.ContentType.toLowerCase()?r=n.headers[p]:p.toLowerCase()===t.HeaderNames.RequestStreamId.toLowerCase()?a=n.headers[p]:c[p]=n.headers[p]);return new i(n.messageType,o,s,r,n.body,a,c,n.id)}}return Br.SpeechConnectionMessage=i,Br}var Ln={},Qc;function yf(){return Qc||(Qc=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SegmentationMode=void 0,(function(t){t.Normal="Normal",t.Disabled="Disabled",t.Custom="Custom",t.Semantic="Semantic"})(e.SegmentationMode||(e.SegmentationMode={}))})(Ln)),Ln}var qn={},Xc;function Rf(){return Xc||(Xc=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NextAction=void 0,(function(t){t.None="None",t.Synthesize="Synthesize"})(e.NextAction||(e.NextAction={}))})(qn)),qn}var Bn={},Zc;function Pf(){return Zc||(Zc=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Mode=void 0,(function(t){t.None="None",t.Always="Always"})(e.Mode||(e.Mode={}))})(Bn)),Bn}var Fn={},Yc;function Ef(){return Yc||(Yc=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LanguageIdDetectionPriority=e.LanguageIdDetectionMode=void 0,(function(t){t.DetectAtAudioStart="DetectAtAudioStart",t.DetectContinuous="DetectContinuous",t.DetectSegments="DetectSegments"})(e.LanguageIdDetectionMode||(e.LanguageIdDetectionMode={})),(function(t){t.Auto="Auto",t.PrioritizeLatency="PrioritizeLatency",t.PrioritizeAccuracy="PrioritizeAccuracy"})(e.LanguageIdDetectionPriority||(e.LanguageIdDetectionPriority={}))})(Fn)),Fn}var xn={},$c;function Tf(){return $c||($c=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NextAction=void 0,(function(t){t.Recognize="Recognize",t.None="None"})(e.NextAction||(e.NextAction={}))})(xn)),xn}var Un={},eu;function Af(){return eu||(eu=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.OnUnknownAction=void 0,(function(t){t.RecognizeWithDefaultLanguage="RecognizeWithDefaultLanguage",t.None="None"})(e.OnUnknownAction||(e.OnUnknownAction={}))})(Un)),Un}var Wn={},tu;function If(){return tu||(tu=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ResultType=void 0,(function(t){t.Auto="Auto",t.StableFragment="StableFragment",t.Hypothesis="Hypothesis",t.None="None"})(e.ResultType||(e.ResultType={}))})(Wn)),Wn}var Hn={},ru;function wf(){return ru||(ru=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PhraseResultOutputType=void 0,(function(t){t.Always="Always",t.None="None"})(e.PhraseResultOutputType||(e.PhraseResultOutputType={}))})(Hn)),Hn}var Kn={},iu;function _f(){return iu||(iu=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NextAction=void 0,(function(t){t.None="None",t.Translate="Translate"})(e.NextAction||(e.NextAction={}))})(Kn)),Kn}var nu;function bf(){if(nu)return lt;nu=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.ServiceRecognizerBase=void 0;const e=U(),t=b(),i=A(),u=w(),n=xi(),o=yf(),s=Y(),r=Rf(),a=Pf(),c=Ef(),p=Tf(),d=Af(),l=If(),h=wf(),g=_f();let f=class _i{constructor(v,S,C,y,R){if(this.privConnectionConfigurationPromise=void 0,this.privConnectionPromise=void 0,this.privSetTimeout=setTimeout,this.privIsLiveAudio=!1,this.privAverageBytesPerMs=0,this.privEnableSpeakerId=!1,this.privExpectContentAssessmentResponse=!1,this.recognizeOverride=void 0,this.disconnectOverride=void 0,this.receiveMessageOverride=void 0,this.sendPrePayloadJSONOverride=void 0,this.postConnectImplOverride=void 0,this.configConnectionOverride=void 0,this.handleSpeechPhraseMessage=void 0,this.handleSpeechHypothesisMessage=void 0,!v)throw new t.ArgumentNullError("authentication");if(!S)throw new t.ArgumentNullError("connectionFactory");if(!C)throw new t.ArgumentNullError("audioSource");if(!y)throw new t.ArgumentNullError("recognizerConfig");this.privEnableSpeakerId=y.isSpeakerDiarizationEnabled,this.privMustReportEndOfStream=!1,this.privAuthentication=v,this.privConnectionFactory=S,this.privAudioSource=C,this.privRecognizerConfig=y,this.privIsDisposed=!1,this.privRecognizer=R,this.privRequestSession=new u.RequestSession(this.privAudioSource.id()),this.privConnectionEvents=new t.EventSource,this.privServiceEvents=new t.EventSource,this.privDynamicGrammar=new u.DynamicGrammarBuilder,this.privSpeechContext=new u.SpeechContext(this.privDynamicGrammar),this.privAgentConfig=new u.AgentConfig,this.privRecognizerConfig.parameters.getProperty(i.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?this.privSetTimeout=t.Timeout.setTimeout:(typeof window<"u"&&(this.privSetTimeout=window.setTimeout.bind(window)),typeof globalThis<"u"&&(this.privSetTimeout=globalThis.setTimeout.bind(globalThis))),this.connectionEvents.attach(E=>{if(E.name==="ConnectionClosedEvent"){const P=E;(P.statusCode===1003||P.statusCode===1007||P.statusCode===1002||P.statusCode===4e3||this.privRequestSession.numConnectionAttempts>this.privRecognizerConfig.maxRetryCount)&&this.cancelRecognitionLocal(i.CancellationReason.Error,P.statusCode===1007?i.CancellationErrorCode.BadRequestParameters:i.CancellationErrorCode.ConnectionFailure,`${P.reason} websocket error code: ${P.statusCode}`)}}),this.privEnableSpeakerId&&(this.privDiarizationSessionId=(0,t.createNoDashGuid)())}setTranslationJson(){const v=this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0);if(v!==void 0){const S=v.split(","),C=this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationVoice,void 0),y=this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationCategoryId,void 0),R=C!==void 0?r.NextAction.Synthesize:r.NextAction.None;if(this.privSpeechContext.getContext().translation={onPassthrough:{action:R},onSuccess:{action:R},output:{includePassThroughResults:!0,interimResults:{mode:a.Mode.Always}},targetLanguages:S},y!==void 0&&(this.privSpeechContext.getContext().translation.category=y),C!==void 0){const E={};for(const P of S)E[P]=C;this.privSpeechContext.getContext().synthesis={defaultVoices:E}}const T=this.privSpeechContext.getContext().phraseDetection||{};T.onSuccess={action:g.NextAction.Translate},T.onInterim={action:g.NextAction.Translate},this.privSpeechContext.getContext().phraseDetection=T}}setSpeechSegmentationTimeoutJson(){const v=this.privRecognizerConfig.parameters.getProperty(i.PropertyId.Speech_SegmentationSilenceTimeoutMs,void 0),S=this.privRecognizerConfig.parameters.getProperty(i.PropertyId.Speech_SegmentationMaximumTimeMs,void 0),C=this.privRecognizerConfig.parameters.getProperty(i.PropertyId.Speech_SegmentationStrategy,void 0),y={mode:o.SegmentationMode.Normal};let R=!1;if(C!==void 0){R=!0;let T=o.SegmentationMode.Normal;switch(C.toLowerCase()){case"default":break;case"time":T=o.SegmentationMode.Custom;break;case"semantic":T=o.SegmentationMode.Semantic;break}y.mode=T}if(v!==void 0){R=!0;const T=parseInt(v,10);y.mode=o.SegmentationMode.Custom,y.segmentationSilenceTimeoutMs=T}if(S!==void 0){R=!0;const T=parseInt(S,10);y.mode=o.SegmentationMode.Custom,y.segmentationForcedTimeoutMs=T}if(R){const T=this.privSpeechContext.getContext().phraseDetection||{};switch(T.mode=this.recognitionMode,this.recognitionMode){case s.RecognitionMode.Conversation:T.conversation=T.conversation??{segmentation:{}},T.conversation.segmentation=y;break;case s.RecognitionMode.Interactive:T.interactive=T.interactive??{segmentation:{}},T.interactive.segmentation=y;break;case s.RecognitionMode.Dictation:T.dictation=T.dictation??{},T.dictation.segmentation=y;break}this.privSpeechContext.getContext().phraseDetection=T}}setLanguageIdJson(){const v=this.privSpeechContext.getContext().phraseDetection||{};if(this.privRecognizerConfig.autoDetectSourceLanguages!==void 0){const S=this.privRecognizerConfig.autoDetectSourceLanguages.split(",");S.length===1&&S[0]===u.AutoDetectSourceLanguagesOpenRangeOptionName&&(S[0]="UND");let C;this.privRecognizerConfig.languageIdMode==="Continuous"?C=c.LanguageIdDetectionMode.DetectContinuous:C=c.LanguageIdDetectionMode.DetectAtAudioStart,this.privSpeechContext.getContext().languageId={languages:S,mode:C,onSuccess:{action:p.NextAction.Recognize},onUnknown:{action:d.OnUnknownAction.None},priority:c.LanguageIdDetectionPriority.PrioritizeLatency},this.privSpeechContext.getContext().phraseOutput={interimResults:{resultType:l.ResultType.Auto},phraseResults:{resultType:h.PhraseResultOutputType.Always}};const y=this.privRecognizerConfig.sourceLanguageModels;y!==void 0&&(v.customModels=y,v.onInterim={action:g.NextAction.None},v.onSuccess={action:g.NextAction.None})}this.privSpeechContext.getContext().phraseDetection=v}setOutputDetailLevelJson(){this.privEnableSpeakerId&&(this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true"?this.privSpeechContext.setWordLevelTimings():this.privRecognizerConfig.parameters.getProperty(u.OutputFormatPropertyName,i.OutputFormat[i.OutputFormat.Simple]).toLowerCase()===i.OutputFormat[i.OutputFormat.Detailed].toLocaleLowerCase()&&this.privSpeechContext.setDetailedOutputFormat())}setSpeechStartEventSensitivityJson(){const v=this.privRecognizerConfig.parameters.getProperty(i.PropertyId.Speech_StartEventSensitivity,void 0);if(v!==void 0){let S=!1;switch(v.toLowerCase()){case s.SpeechStartEventSensitivity.Low:case s.SpeechStartEventSensitivity.Medium:case s.SpeechStartEventSensitivity.High:S=!0;break}if(S){const C=this.privSpeechContext.getContext().phraseDetection||{};C.voiceOnsetSensitivity=v.toLowerCase(),this.privSpeechContext.getContext().phraseDetection=C}}}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}get audioSource(){return this.privAudioSource}get speechContext(){return this.privSpeechContext}get dynamicGrammar(){return this.privDynamicGrammar}get agentConfig(){return this.privAgentConfig}set conversationTranslatorToken(v){this.privRecognizerConfig.parameters.setProperty(i.PropertyId.ConversationTranslator_Token,v)}set authentication(v){this.privAuthentication=v}isDisposed(){return this.privIsDisposed}async dispose(v){if(this.privIsDisposed=!0,this.privConnectionPromise!==void 0)try{await(await this.privConnectionPromise).dispose(v)}catch{return}}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}get recognitionMode(){return this.privRecognizerConfig.recognitionMode}async recognize(v,S,C){if(this.recognizeOverride!==void 0){await this.recognizeOverride(v,S,C);return}if(this.privConnectionConfigurationPromise=void 0,this.privRecognizerConfig.recognitionMode=v,this.privRecognizerConfig.recognitionEndpointVersion==="2"){const P=this.privSpeechContext.getContext().phraseDetection||{};P.mode=v,this.privSpeechContext.getContext().phraseDetection=P}this.setLanguageIdJson(),this.setTranslationJson(),this.privRecognizerConfig.autoDetectSourceLanguages!==void 0&&this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0&&this.setupTranslationWithLanguageId(),this.setSpeechSegmentationTimeoutJson(),this.setOutputDetailLevelJson(),this.setSpeechStartEventSensitivityJson(),this.privSuccessCallback=S,this.privErrorCallback=C,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events);const y=this.connectImpl();let R;try{const P=await this.audioSource.attach(this.privRequestSession.audioNodeId),I=await this.audioSource.format,M=await this.audioSource.deviceInfo;this.privIsLiveAudio=M.type&&M.type===u.type.Microphones,R=new e.ReplayableAudioNode(P,I.avgBytesPerSec),await this.privRequestSession.onAudioSourceAttachCompleted(R,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:M}}catch(P){throw await this.privRequestSession.onStopRecognizing(),P}try{await y}catch(P){await this.cancelRecognitionLocal(i.CancellationReason.Error,i.CancellationErrorCode.ConnectionFailure,P);return}const T=new i.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,T),this.receiveMessage(),this.sendAudio(R).catch(async P=>{await this.cancelRecognitionLocal(i.CancellationReason.Error,i.CancellationErrorCode.RuntimeError,P)})}async stopRecognizing(){if(this.privRequestSession.isRecognizing)try{await this.audioSource.turnOff(),await this.sendFinalAudio(),await this.privRequestSession.onStopRecognizing(),await this.privRequestSession.turnCompletionPromise}finally{await this.privRequestSession.dispose()}}async connect(){return await this.connectImpl(),Promise.resolve()}connectAsync(v,S){this.connectImpl().then(()=>{try{v&&v()}catch(C){S&&S(C)}},C=>{try{S&&S(C)}catch{}})}async disconnect(){if(await this.cancelRecognitionLocal(i.CancellationReason.Error,i.CancellationErrorCode.NoError,"Disconnecting"),this.disconnectOverride!==void 0&&await this.disconnectOverride(),this.privConnectionPromise!==void 0)try{await(await this.privConnectionPromise).dispose()}catch{}this.privConnectionPromise=void 0}sendMessage(v){}async sendNetworkMessage(v,S){const C=typeof S=="string"?t.MessageType.Text:t.MessageType.Binary,y=typeof S=="string"?"application/json":"";return(await this.fetchConnection()).send(new n.SpeechConnectionMessage(C,v,this.privRequestSession.requestId,y,S))}set activityTemplate(v){this.privActivityTemplate=v}get activityTemplate(){return this.privActivityTemplate}set expectContentAssessmentResponse(v){this.privExpectContentAssessmentResponse=v}async sendTelemetryData(){const v=this.privRequestSession.getTelemetry();if(_i.telemetryDataEnabled!==!0||this.privIsDisposed||v===null)return;if(_i.telemetryData)try{_i.telemetryData(v)}catch{}await(await this.fetchConnection()).send(new n.SpeechConnectionMessage(t.MessageType.Text,"telemetry",this.privRequestSession.requestId,"application/json",v))}async cancelRecognitionLocal(v,S,C){this.privRequestSession.isRecognizing&&(await this.privRequestSession.onStopRecognizing(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,v,S,C))}async receiveMessage(){try{if(this.privIsDisposed)return;let v=await this.fetchConnection();const S=await v.read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(!S)return this.receiveMessage();this.privServiceHasSentMessage=!0;const C=n.SpeechConnectionMessage.fromConnectionMessage(S);if(C.requestId.toLowerCase()===this.privRequestSession.requestId.toLowerCase())switch(C.path.toLowerCase()){case"turn.start":this.privMustReportEndOfStream=!0,this.privRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":const y=u.SpeechDetected.fromJSON(C.textBody,this.privRequestSession.currentTurnAudioOffset),R=new i.RecognitionEventArgs(y.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,R);break;case"speech.enddetected":let T;C.textBody.length>0?T=C.textBody:T="{ Offset: 0 }";const E=u.SpeechDetected.fromJSON(T,this.privRequestSession.currentTurnAudioOffset),P=new i.RecognitionEventArgs(E.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,P);break;case"turn.end":await this.sendTelemetryData(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream&&(this.privMustReportEndOfStream=!1,await this.cancelRecognitionLocal(i.CancellationReason.EndOfStream,i.CancellationErrorCode.NoError,void 0));const I=new i.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing){this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,I);return}else v=await this.fetchConnection(),await this.sendPrePayloadJSON(v);break;default:await this.processTypeSpecificMessages(C)||this.privServiceEvents&&this.serviceEvents.onEvent(new t.ServiceEvent(C.path.toLowerCase(),C.textBody))}return this.receiveMessage()}catch{return null}}updateSpeakerDiarizationAudioOffset(){const v=this.privRequestSession.recognitionBytesSent,S=this.privAverageBytesPerMs!==0?v/this.privAverageBytesPerMs:0;this.privSpeechContext.setSpeakerDiarizationAudioOffsetMs(S)}sendSpeechContext(v,S){this.privEnableSpeakerId&&this.updateSpeakerDiarizationAudioOffset();const C=this.speechContext.toJSON();if(S&&this.privRequestSession.onSpeechContext(),C)return v.send(new n.SpeechConnectionMessage(t.MessageType.Text,"speech.context",this.privRequestSession.requestId,"application/json",C))}setupTranslationWithLanguageId(){const v=this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0),S=this.privRecognizerConfig.autoDetectSourceLanguages!==void 0;if(v!==void 0&&S){this.privSpeechContext.getContext().phraseOutput={interimResults:{resultType:l.ResultType.None},phraseResults:{resultType:h.PhraseResultOutputType.None}};const C=this.privSpeechContext.getContext().translation;if(C){const y=this.privRecognizerConfig.sourceLanguageModels;if(y!==void 0&&y.length>0){const T=this.privSpeechContext.getContext().phraseDetection||{};T.customModels=y,this.privSpeechContext.getContext().phraseDetection=T}this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&(C.onSuccess={action:r.NextAction.Synthesize},C.onPassthrough={action:r.NextAction.Synthesize})}}}noOp(){}async sendPrePayloadJSON(v,S=!0){if(this.sendPrePayloadJSONOverride!==void 0)return this.sendPrePayloadJSONOverride(v);await this.sendSpeechContext(v,S),await this.sendWaveHeader(v)}async sendWaveHeader(v){const S=await this.audioSource.format;return v.send(new n.SpeechConnectionMessage(t.MessageType.Binary,"audio",this.privRequestSession.requestId,"audio/x-wav",S.header))}connectImpl(){return this.privConnectionPromise!==void 0?this.privConnectionPromise.then(v=>v.state()===t.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl())):(this.privConnectionPromise=this.retryableConnect(),this.privConnectionPromise.catch(()=>{}),this.postConnectImplOverride!==void 0?this.postConnectImplOverride(this.privConnectionPromise):this.privConnectionPromise)}sendSpeechServiceConfig(v,S,C){if(S.onSpeechContext(),_i.telemetryDataEnabled!==!0){const R={context:{system:JSON.parse(C).context.system}};C=JSON.stringify(R)}if(this.privRecognizerConfig.parameters.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()==="true"){const y=JSON.parse(C);y.context.DisableReferenceChannel="True",y.context.MicSpec="1_0_0",C=JSON.stringify(y)}if(C)return v.send(new n.SpeechConnectionMessage(t.MessageType.Text,"speech.config",S.requestId,"application/json",C))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(v=>v.state()===t.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async sendAudio(v){const S=await this.audioSource.format;this.privAverageBytesPerMs=S.avgBytesPerSec/1e3;let C=Date.now();const y=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),R=S.avgBytesPerSec/1e3*parseInt(y,10),T=this.privRequestSession.recogNumber,E=async()=>{if(!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===T){const P=await this.fetchConnection(),I=await v.read();if(this.privRequestSession.isSpeechEnded)return;let M,k;if(!I||I.isEnd?(M=null,k=0):(M=I.buffer,this.privRequestSession.onAudioSent(M.byteLength),R>=this.privRequestSession.bytesSent?k=0:k=Math.max(0,C-Date.now())),k!==0&&await this.delay(k),M!==null&&(C=Date.now()+M.byteLength*1e3/(S.avgBytesPerSec*2)),!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===T)if(P.send(new n.SpeechConnectionMessage(t.MessageType.Binary,"audio",this.privRequestSession.requestId,null,M)).catch(()=>{this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition).catch(()=>{})}),I!=null&&I.isEnd)this.privIsLiveAudio||this.privRequestSession.onSpeechEnded();else return E()}};return E()}async retryableConnect(){let v=!1;this.privAuthFetchEventId=(0,t.createNoDashGuid)();const S=this.privRequestSession.sessionId;this.privConnectionId=S!==void 0?S:(0,t.createNoDashGuid)(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);let C=0,y="";for(;this.privRequestSession.numConnectionAttempts<=this.privRecognizerConfig.maxRetryCount;){this.privRequestSession.onRetryConnection();const T=await(v?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId));await this.privRequestSession.onAuthCompleted(!1);const E=await this.privConnectionFactory.create(this.privRecognizerConfig,T,this.privConnectionId);this.privRequestSession.listenForServiceTelemetry(E.events),E.events.attach(I=>{this.connectionEvents.onEvent(I)});const P=await E.open();if(P.statusCode===200)return await this.privRequestSession.onConnectionEstablishCompleted(P.statusCode),Promise.resolve(E);P.statusCode===1006&&(v=!0),C=P.statusCode,y=P.reason}return await this.privRequestSession.onConnectionEstablishCompleted(C,y),Promise.reject(`Unable to contact server. StatusCode: ${C}, ${this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint)} Reason: ${y}`)}delay(v){return new Promise(S=>this.privSetTimeout(S,v))}writeBufferToConsole(v){let S="Buffer Size: ";if(v===null)S+="null";else{const C=new Uint8Array(v);S+=`${v.byteLength}\r
`;for(let y=0;y<v.byteLength;y++)S+=C[y].toString(16).padStart(2,"0")+" ",(y+1)%16===0&&(console.info(S),S="")}console.info(S)}async sendFinalAudio(){await(await this.fetchConnection()).send(new n.SpeechConnectionMessage(t.MessageType.Binary,"audio",this.privRequestSession.requestId,null,null))}async configureConnection(){const v=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(v):(await this.sendSpeechServiceConfig(v,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendPrePayloadJSON(v,!1),v)}};return lt.ServiceRecognizerBase=f,f.telemetryDataEnabled=!0,lt}var Fr={},su;function Mf(){if(su)return Fr;su=1,Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.ConversationServiceRecognizer=void 0;const e=A(),t=w();let i=class extends t.ServiceRecognizerBase{constructor(n,o,s,r,a){super(n,o,s,r,a),this.handleSpeechPhraseMessage=async c=>this.handleSpeechPhrase(c),this.handleSpeechHypothesisMessage=c=>this.handleSpeechHypothesis(c)}processTypeSpecificMessages(n){}handleRecognizedCallback(n,o,s){}handleRecognizingCallback(n,o,s){}async processSpeechMessages(n){let o=!1;switch(n.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":this.handleSpeechHypothesisMessage&&this.handleSpeechHypothesisMessage(n.textBody),o=!0;break;case"speech.phrase":this.handleSpeechPhraseMessage&&await this.handleSpeechPhraseMessage(n.textBody),o=!0;break}return o}cancelRecognition(n,o,s,r,a){}async handleSpeechPhrase(n){const o=t.SimpleSpeechPhrase.fromJSON(n,this.privRequestSession.currentTurnAudioOffset),s=t.EnumTranslation.implTranslateRecognitionResult(o.RecognitionStatus);let r;const a=new e.PropertyCollection;if(a.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,n),this.privRequestSession.onPhraseRecognized(o.Offset+o.Duration),e.ResultReason.Canceled===s){const c=t.EnumTranslation.implTranslateCancelResult(o.RecognitionStatus),p=t.EnumTranslation.implTranslateCancelErrorCode(o.RecognitionStatus);await this.cancelRecognitionLocal(c,p,t.EnumTranslation.implTranslateErrorDetails(p))}else if(o.RecognitionStatus!==t.RecognitionStatus.EndOfDictation){if(this.privRecognizerConfig.parameters.getProperty(t.OutputFormatPropertyName)===e.OutputFormat[e.OutputFormat.Simple])r=new e.SpeechRecognitionResult(this.privRequestSession.requestId,s,o.DisplayText,o.Duration,o.Offset,o.Language,o.LanguageDetectionConfidence,o.SpeakerId,void 0,o.asJson(),a);else{const c=t.DetailedSpeechPhrase.fromJSON(n,this.privRequestSession.currentTurnAudioOffset);r=new e.SpeechRecognitionResult(this.privRequestSession.requestId,s,c.Text,c.Duration,c.Offset,c.Language,c.LanguageDetectionConfidence,c.SpeakerId,void 0,c.asJson(),a)}this.handleRecognizedCallback(r,r.offset,this.privRequestSession.sessionId)}}handleSpeechHypothesis(n){const o=t.SpeechHypothesis.fromJSON(n,this.privRequestSession.currentTurnAudioOffset),s=new e.PropertyCollection;s.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,n);const r=new e.SpeechRecognitionResult(this.privRequestSession.requestId,e.ResultReason.RecognizingSpeech,o.Text,o.Duration,o.Offset,o.Language,o.LanguageDetectionConfidence,o.SpeakerId,void 0,o.asJson(),s);this.privRequestSession.onHypothesis(o.Offset),this.handleRecognizingCallback(r,o.Duration,this.privRequestSession.sessionId)}};return Fr.ConversationServiceRecognizer=i,Fr}var Vn={},ou;function Of(){return ou||(ou=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.RecognizerConfig=e.SpeechResultFormat=void 0;const t=A(),i=w(),u=Y();(function(o){o[o.Simple=0]="Simple",o[o.Detailed=1]="Detailed"})(e.SpeechResultFormat||(e.SpeechResultFormat={}));class n{constructor(s,r){this.privSpeechServiceConfig=s||new i.SpeechServiceConfig(new i.Context(null)),this.privParameters=r,this.privMaxRetryCount=parseInt(r.getProperty("SPEECH-Error-MaxRetryCount","4"),10),this.privLanguageIdMode=r.getProperty(t.PropertyId.SpeechServiceConnection_LanguageIdMode,void 0),this.privEnableSpeakerId=!1}get parameters(){return this.privParameters}get recognitionMode(){return this.privRecognitionMode}set recognitionMode(s){this.privRecognitionMode=s,this.privRecognitionActivityTimeout=s===u.RecognitionMode.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=u.RecognitionMode[s]}get SpeechServiceConfig(){return this.privSpeechServiceConfig}get recognitionActivityTimeout(){return this.privRecognitionActivityTimeout}get isContinuousRecognition(){return this.privRecognitionMode!==u.RecognitionMode.Interactive}get languageIdMode(){return this.privLanguageIdMode}get autoDetectSourceLanguages(){return this.parameters.getProperty(t.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)}get recognitionEndpointVersion(){return this.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2")}set recognitionEndpointVersion(s){this.parameters.setProperty(t.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,s)}get sourceLanguageModels(){const s=[];let r=!1;if(this.autoDetectSourceLanguages!==void 0)for(const a of this.autoDetectSourceLanguages.split(",")){const c=a+t.PropertyId.SpeechServiceConnection_EndpointId.toString(),p=this.parameters.getProperty(c,void 0);p!==void 0?(s.push({language:a,endpoint:p}),r=!0):s.push({language:a,endpoint:""})}return r?s:void 0}get maxRetryCount(){return this.privMaxRetryCount}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}set isSpeakerDiarizationEnabled(s){this.privEnableSpeakerId=s}}e.RecognizerConfig=n})(Vn)),Vn}var Jn={},au;function Df(){return au||(au=1,Object.defineProperty(Jn,"__esModule",{value:!0})),Jn}var xr={},cu;function kf(){if(cu)return xr;cu=1,Object.defineProperty(xr,"__esModule",{value:!0}),xr.WebsocketMessageFormatter=void 0;const e=b(),t=`\r
`;let i=class{toConnectionMessage(n){const o=new e.Deferred;try{if(n.messageType===e.MessageType.Text){const s=n.textContent;let r={},a=null;if(s){const c=s.split(`\r
\r
`);c&&c.length>0&&(r=this.parseHeaders(c[0]),c.length>1&&(a=c[1]))}o.resolve(new e.ConnectionMessage(n.messageType,a,r,n.id))}else if(n.messageType===e.MessageType.Binary){const s=n.binaryContent;let r={},a=null;if(!s||s.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");const c=new DataView(s),p=c.getInt16(0);if(s.byteLength<p+2)throw new Error("Invalid binary message format. Header content missing.");let d="";for(let l=0;l<p;l++)d+=String.fromCharCode(c.getInt8(l+2));r=this.parseHeaders(d),s.byteLength>p+2&&(a=s.slice(2+p)),o.resolve(new e.ConnectionMessage(n.messageType,a,r,n.id))}}catch(s){o.reject(`Error formatting the message. Error: ${s}`)}return o.promise}fromConnectionMessage(n){const o=new e.Deferred;try{if(n.messageType===e.MessageType.Text){const s=`${this.makeHeaders(n)}${t}${n.textBody?n.textBody:""}`;o.resolve(new e.RawWebsocketMessage(e.MessageType.Text,s,n.id))}else if(n.messageType===e.MessageType.Binary){const s=this.makeHeaders(n),r=n.binaryBody,a=this.stringToArrayBuffer(s),c=new Int8Array(a),p=c.byteLength,d=new Int8Array(2+p+(r?r.byteLength:0));if(d[0]=p>>8&255,d[1]=p&255,d.set(c,2),r){const h=new Int8Array(r);d.set(h,2+p)}const l=d.buffer;o.resolve(new e.RawWebsocketMessage(e.MessageType.Binary,l,n.id))}}catch(s){o.reject(`Error formatting the message. ${s}`)}return o.promise}makeHeaders(n){let o="";if(n.headers)for(const s in n.headers)s&&(o+=`${s}: ${n.headers[s]}${t}`);return o}parseHeaders(n){const o={};if(n){const s=n.match(/[^\r\n]+/g);if(o){for(const r of s)if(r){const a=r.indexOf(":"),c=a>0?r.substr(0,a).trim().toLowerCase():r,p=a>0&&r.length>a+1?r.substr(a+1).trim():"";o[c]=p}}}return o}stringToArrayBuffer(n){const o=new ArrayBuffer(n.length),s=new DataView(o);for(let r=0;r<n.length;r++)s.setUint8(r,n.charCodeAt(r));return o}};return xr.WebsocketMessageFormatter=i,xr}var Ur={},uu;function Nf(){if(uu)return Ur;uu=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.SpeechConnectionFactory=void 0;const e=U(),t=w(),i=A(),u=se(),n=w(),o=V(),s=pe(),r=Y();let a=class extends u.ConnectionFactoryBase{constructor(){super(...arguments),this.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",this.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",this.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",this.universalUri="/stt/speech/universal/v"}async create(p,d,l){let h=p.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint,void 0);const g=p.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Region,void 0),f=u.ConnectionFactoryBase.getHostSuffix(g),m=p.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Host,"wss://"+g+".stt.speech"+f),v={},S=p.parameters.getProperty(i.PropertyId.SpeechServiceConnection_EndpointId,void 0),C=p.parameters.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(S?(!h||h.search(s.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(v[s.QueryParameterNames.CustomSpeechDeploymentId]=S):C&&(!h||h.search(s.QueryParameterNames.Language)===-1)&&(v[s.QueryParameterNames.Language]=C),(!h||h.search(s.QueryParameterNames.Format)===-1)&&(v[s.QueryParameterNames.Format]=p.parameters.getProperty(t.OutputFormatPropertyName,i.OutputFormat[i.OutputFormat.Simple]).toLowerCase()),p.autoDetectSourceLanguages!==void 0&&(v[s.QueryParameterNames.EnableLanguageId]="true"),this.setCommonUrlParams(p,v,h),h){const P=new URL(h),I=P.pathname;(I===""||I==="/")&&(P.pathname=this.universalUri+p.recognitionEndpointVersion,h=await u.ConnectionFactoryBase.getRedirectUrlFromEndpoint(P.toString()))}if(!h)switch(p.recognitionMode){case r.RecognitionMode.Conversation:p.parameters.getProperty(t.ForceDictationPropertyName,"false")==="true"?h=m+this.dictationRelativeUri:p.recognitionEndpointVersion!==void 0&&parseInt(p.recognitionEndpointVersion,10)>1?h=`${m}${this.universalUri}${p.recognitionEndpointVersion}`:h=m+this.conversationRelativeUri;break;case r.RecognitionMode.Dictation:h=m+this.dictationRelativeUri;break;default:p.recognitionEndpointVersion!==void 0&&parseInt(p.recognitionEndpointVersion,10)>1?h=`${m}${this.universalUri}${p.recognitionEndpointVersion}`:h=m+this.interactiveRelativeUri;break}const y={};d.token!==void 0&&d.token!==""&&(y[d.headerName]=d.token),y[o.HeaderNames.ConnectionId]=l,y.connectionId=l;const R=p.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",T=new e.WebsocketConnection(h,v,y,new n.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(p),R,l),E=T.uri;return p.parameters.setProperty(i.PropertyId.SpeechServiceConnection_Url,E),T}};return Ur.SpeechConnectionFactory=a,Ur}var Wr={},pu;function zf(){if(pu)return Wr;pu=1,Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.ConversationTranscriberConnectionFactory=void 0;const e=U(),t=A(),i=w(),u=se(),n=w(),o=V(),s=pe();let r=class extends u.ConnectionFactoryBase{constructor(){super(...arguments),this.universalUri="/stt/speech/universal/v2",this.conversationRelativeUriV1="/speech/recognition/conversation/cognitiveservices/v1"}async create(c,p,d){let l=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);const h=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,void 0),g=u.ConnectionFactoryBase.getHostSuffix(h),f=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,"wss://"+h+".stt.speech"+g),m={},v=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId,void 0),S=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(v?(!l||l.search(s.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(m[s.QueryParameterNames.CustomSpeechDeploymentId]=v):S&&(!l||l.search(s.QueryParameterNames.Language)===-1)&&(m[s.QueryParameterNames.Language]=S),c.autoDetectSourceLanguages!==void 0&&(m[s.QueryParameterNames.EnableLanguageId]="true"),c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,void 0)==="1")l=`${f}${this.universalUri}`;else{if(this.setV2UrlParams(c,m,l),l){const P=new URL(l),I=P.pathname;(I===""||I==="/")&&(P.pathname=this.universalUri,l=await u.ConnectionFactoryBase.getRedirectUrlFromEndpoint(P.toString()))}l||(l=`${f}${this.conversationRelativeUriV1}`)}const y={};p.token!==void 0&&p.token!==""&&(y[p.headerName]=p.token),y[o.HeaderNames.ConnectionId]=d;const R=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",T=new e.WebsocketConnection(l,m,y,new n.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(c),R,d),E=T.uri;return c.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,E),T}setV2UrlParams(c,p,d){new Map([[t.PropertyId.Speech_SegmentationSilenceTimeoutMs,s.QueryParameterNames.SegmentationSilenceTimeoutMs],[t.PropertyId.SpeechServiceConnection_EnableAudioLogging,s.QueryParameterNames.EnableAudioLogging],[t.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,s.QueryParameterNames.EndSilenceTimeoutMs],[t.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,s.QueryParameterNames.InitialSilenceTimeoutMs],[t.PropertyId.SpeechServiceResponse_PostProcessingOption,s.QueryParameterNames.Postprocessing],[t.PropertyId.SpeechServiceResponse_ProfanityOption,s.QueryParameterNames.Profanity],[t.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,s.QueryParameterNames.StableIntermediateThreshold]]).forEach((g,f)=>{this.setUrlParameter(f,g,c,p,d)});const h=JSON.parse(c.parameters.getProperty(i.ServicePropertiesPropertyName,"{}"));Object.keys(h).forEach(g=>{p[g]=h[g]})}};return Wr.ConversationTranscriberConnectionFactory=r,Wr}var Hr={},du;function jf(){if(du)return Hr;du=1,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.TranscriberConnectionFactory=void 0;const e=U(),t=A(),i=se(),u=w(),n=V(),o=pe();let s=class extends i.ConnectionFactoryBase{constructor(){super(...arguments),this.multiaudioRelativeUri="/speech/recognition/multiaudio"}create(a,c,p){let d=a.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);const l=a.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,"centralus"),h=i.ConnectionFactoryBase.getHostSuffix(l),g="wss://transcribe."+l+".cts.speech"+h+this.multiaudioRelativeUri,f=a.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,g),m={};this.setQueryParams(m,a,d),d||(d=f);const v={};c.token!==void 0&&c.token!==""&&(v[c.headerName]=c.token),v[n.HeaderNames.ConnectionId]=p,a.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,d);const S=a.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new e.WebsocketConnection(d,m,v,new u.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(a),S,p))}setQueryParams(a,c,p){const d=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId,void 0),l=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);d&&!(o.QueryParameterNames.CustomSpeechDeploymentId in a)&&(a[o.QueryParameterNames.CustomSpeechDeploymentId]=d),l&&!(o.QueryParameterNames.Language in a)&&(a[o.QueryParameterNames.Language]=l);const h=c.parameters.getProperty(t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true",g=c.parameters.getProperty(u.OutputFormatPropertyName,t.OutputFormat[t.OutputFormat.Simple])!==t.OutputFormat[t.OutputFormat.Simple];(h||g)&&(a[o.QueryParameterNames.Format]=t.OutputFormat[t.OutputFormat.Detailed].toLowerCase()),this.setCommonUrlParams(c,a,p)}};return Hr.TranscriberConnectionFactory=s,Hr}var Kr={},hu;function Lf(){if(hu)return Kr;hu=1,Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.TranslationConnectionFactory=void 0;const e=U(),t=Qp(),i=A(),u=se(),n=w(),o=V(),s=pe(),r=Y();let a=class extends u.ConnectionFactoryBase{constructor(){super(...arguments),this.universalUri="/stt/speech/universal/v2",this.translationV1Uri="/speech/translation/cognitiveservices/v1"}async create(p,d,l){let h=this.getEndpointUrl(p);const g={};if(this.setQueryParams(g,p,h),h){const S=new URL(h),C=S.pathname;(C===""||C==="/")&&(S.pathname=this.universalUri,h=await u.ConnectionFactoryBase.getRedirectUrlFromEndpoint(S.toString()))}const f={};d.token!==void 0&&d.token!==""&&(f[d.headerName]=d.token),f[o.HeaderNames.ConnectionId]=l,p.parameters.setProperty(i.PropertyId.SpeechServiceConnection_Url,h);const m=p.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new e.WebsocketConnection(h,g,f,new n.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(p),m,l)}getEndpointUrl(p,d){const l=p.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Region),h=u.ConnectionFactoryBase.getHostSuffix(l);let g=p.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint,void 0);return g?d===!0?g:t.StringUtils.formatString(g,{region:l}):(p.parameters.getProperty("SPEECH-ForceV1Endpoint","false")==="true"?g=p.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Host,"wss://{region}.s2s.speech"+h)+this.translationV1Uri:g=p.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Host,"wss://{region}.stt.speech"+h)+this.universalUri,d===!0?g:t.StringUtils.formatString(g,{region:l}))}setQueryParams(p,d,l){p.from=d.parameters.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage),p.to=d.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationToLanguages),p.scenario=d.recognitionMode===r.RecognitionMode.Interactive?"interactive":d.recognitionMode===r.RecognitionMode.Conversation?"conversation":"",this.setCommonUrlParams(d,p,l),this.setUrlParameter(i.PropertyId.SpeechServiceResponse_TranslationRequestStablePartialResult,s.QueryParameterNames.StableTranslation,d,p,l);const h=d.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationVoice,void 0);h!==void 0&&(p.voice=h,p.features="requireVoice")}};return Kr.TranslationConnectionFactory=a,Kr}var Vr={},lu;function qf(){if(lu)return Vr;lu=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.EnumTranslation=void 0;const e=A(),t=w();let i=class{static implTranslateRecognitionResult(n,o=!1){let s=e.ResultReason.Canceled;switch(n){case t.RecognitionStatus.Success:s=e.ResultReason.RecognizedSpeech;break;case t.RecognitionStatus.EndOfDictation:s=o?e.ResultReason.RecognizedSpeech:e.ResultReason.NoMatch;break;case t.RecognitionStatus.NoMatch:case t.RecognitionStatus.InitialSilenceTimeout:case t.RecognitionStatus.BabbleTimeout:s=e.ResultReason.NoMatch;break;case t.RecognitionStatus.Error:case t.RecognitionStatus.BadRequest:case t.RecognitionStatus.Forbidden:default:s=e.ResultReason.Canceled;break}return s}static implTranslateCancelResult(n){let o=e.CancellationReason.EndOfStream;switch(n){case t.RecognitionStatus.Success:case t.RecognitionStatus.EndOfDictation:case t.RecognitionStatus.NoMatch:o=e.CancellationReason.EndOfStream;break;case t.RecognitionStatus.InitialSilenceTimeout:case t.RecognitionStatus.BabbleTimeout:case t.RecognitionStatus.Error:case t.RecognitionStatus.BadRequest:case t.RecognitionStatus.Forbidden:default:o=e.CancellationReason.Error;break}return o}static implTranslateCancelErrorCode(n){let o=e.CancellationErrorCode.NoError;switch(n){case t.RecognitionStatus.Error:o=e.CancellationErrorCode.ServiceError;break;case t.RecognitionStatus.TooManyRequests:o=e.CancellationErrorCode.TooManyRequests;break;case t.RecognitionStatus.BadRequest:o=e.CancellationErrorCode.BadRequestParameters;break;case t.RecognitionStatus.Forbidden:o=e.CancellationErrorCode.Forbidden;break;default:o=e.CancellationErrorCode.NoError;break}return o}static implTranslateErrorDetails(n){let o="The speech service encountered an internal error and could not continue.";switch(n){case e.CancellationErrorCode.Forbidden:o="The recognizer is using a free subscription that ran out of quota.";break;case e.CancellationErrorCode.BadRequestParameters:o="Invalid parameter or unsupported audio format in the request.";break;case e.CancellationErrorCode.TooManyRequests:o="The number of parallel requests exceeded the number of allowed concurrent transcriptions.";break}return o}};return Vr.EnumTranslation=i,Vr}var Gn={},vu;function Bf(){return vu||(vu=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.RecognitionStatus=e.SynthesisStatus=void 0,(function(t){t[t.Success=0]="Success",t[t.SynthesisEnd=1]="SynthesisEnd",t[t.Error=2]="Error"})(e.SynthesisStatus||(e.SynthesisStatus={})),(function(t){t[t.Success=0]="Success",t[t.NoMatch=1]="NoMatch",t[t.InitialSilenceTimeout=2]="InitialSilenceTimeout",t[t.BabbleTimeout=3]="BabbleTimeout",t[t.Error=4]="Error",t[t.EndOfDictation=5]="EndOfDictation",t[t.TooManyRequests=6]="TooManyRequests",t[t.BadRequest=7]="BadRequest",t[t.Forbidden=8]="Forbidden"})(e.RecognitionStatus||(e.RecognitionStatus={}))})(Gn)),Gn}var Jr={},fu;function Ff(){if(fu)return Jr;fu=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.TranslationSynthesisEnd=void 0;const e=w();let t=class sd{constructor(u){this.privSynthesisEnd=JSON.parse(u),this.privSynthesisEnd.SynthesisStatus&&(this.privSynthesisEnd.SynthesisStatus=e.SynthesisStatus[this.privSynthesisEnd.SynthesisStatus]),this.privSynthesisEnd.Status&&(this.privSynthesisEnd.SynthesisStatus=e.SynthesisStatus[this.privSynthesisEnd.Status])}static fromJSON(u){return new sd(u)}get SynthesisStatus(){return this.privSynthesisEnd.SynthesisStatus}get FailureReason(){return this.privSynthesisEnd.FailureReason}};return Jr.TranslationSynthesisEnd=t,Jr}var Gr={},gu;function xf(){if(gu)return Gr;gu=1,Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.TranslationHypothesis=void 0;const e=D(),t=Cs();let i=class fs{constructor(n,o){this.privTranslationHypothesis=n,this.privTranslationHypothesis.Offset+=o,this.privTranslationHypothesis.Translation.TranslationStatus=this.mapTranslationStatus(this.privTranslationHypothesis.Translation.TranslationStatus)}static fromJSON(n,o){return new fs(JSON.parse(n),o)}static fromTranslationResponse(n,o){e.Contracts.throwIfNullOrUndefined(n,"translationHypothesis");const s=n.SpeechHypothesis;return n.SpeechHypothesis=void 0,s.Translation=n,new fs(s,o)}get Duration(){return this.privTranslationHypothesis.Duration}get Offset(){return this.privTranslationHypothesis.Offset}get Text(){return this.privTranslationHypothesis.Text}get Translation(){return this.privTranslationHypothesis.Translation}get Language(){var n;return(n=this.privTranslationHypothesis.PrimaryLanguage)==null?void 0:n.Language}asJson(){const n={...this.privTranslationHypothesis};return n.Translation!==void 0?JSON.stringify({...n,TranslationStatus:t.TranslationStatus[n.Translation.TranslationStatus]}):JSON.stringify(n)}mapTranslationStatus(n){if(typeof n=="string")return t.TranslationStatus[n];if(typeof n=="number")return n}};return Gr.TranslationHypothesis=i,Gr}var Qr={},mu;function Uf(){if(mu)return Qr;mu=1,Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.TranslationPhrase=void 0;const e=D(),t=w(),i=Cs();let u=class gs{constructor(o,s){this.privTranslationPhrase=o,this.privTranslationPhrase.Offset+=s,this.privTranslationPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privTranslationPhrase.RecognitionStatus),this.privTranslationPhrase.Translation!==void 0&&(this.privTranslationPhrase.Translation.TranslationStatus=this.mapTranslationStatus(this.privTranslationPhrase.Translation.TranslationStatus))}static fromJSON(o,s){return new gs(JSON.parse(o),s)}static fromTranslationResponse(o,s){e.Contracts.throwIfNullOrUndefined(o,"translationResponse");const r=o.SpeechPhrase;return o.SpeechPhrase=void 0,r.Translation=o,r.Text=r.DisplayText,new gs(r,s)}get RecognitionStatus(){return this.privTranslationPhrase.RecognitionStatus}get Offset(){return this.privTranslationPhrase.Offset}get Duration(){return this.privTranslationPhrase.Duration}get Text(){return this.privTranslationPhrase.Text}get Language(){var o;return(o=this.privTranslationPhrase.PrimaryLanguage)==null?void 0:o.Language}get Confidence(){var o;return(o=this.privTranslationPhrase.PrimaryLanguage)==null?void 0:o.Confidence}get Translation(){return this.privTranslationPhrase.Translation}asJson(){const o={...this.privTranslationPhrase},s={...o,RecognitionStatus:t.RecognitionStatus[o.RecognitionStatus]};return o.Translation&&(s.Translation={...o.Translation,TranslationStatus:i.TranslationStatus[o.Translation.TranslationStatus]}),JSON.stringify(s)}mapRecognitionStatus(o){if(typeof o=="string")return t.RecognitionStatus[o];if(typeof o=="number")return o}mapTranslationStatus(o){if(typeof o=="string")return i.TranslationStatus[o];if(typeof o=="number")return o}};return Qr.TranslationPhrase=u,Qr}var Xr={},Su;function Wf(){if(Su)return Xr;Su=1,Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.TranslationServiceRecognizer=void 0;const e=b(),t=A(),i=w();let u=class extends i.ConversationServiceRecognizer{constructor(o,s,r,a,c){super(o,s,r,a,c),this.privTranslationRecognizer=c,this.connectionEvents.attach(p=>{p.name==="ConnectionEstablishedEvent"&&this.privTranslationRecognizer.onConnection()})}async processTypeSpecificMessages(o){const s=new t.PropertyCollection;let r=await this.processSpeechMessages(o);if(r)return!0;const a=async p=>{if(s.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,p.asJson()),this.privRequestSession.onPhraseRecognized(p.Offset+p.Duration),p.RecognitionStatus===i.RecognitionStatus.Success){const d=this.fireEventForResult(p,s);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,d)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(d.result)}catch(l){this.privErrorCallback&&this.privErrorCallback(l)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}else{const d=i.EnumTranslation.implTranslateRecognitionResult(p.RecognitionStatus),l=new t.TranslationRecognitionResult(void 0,this.privRequestSession.requestId,d,p.Text,p.Duration,p.Offset,p.Language,p.Confidence,void 0,p.asJson(),s);if(d===t.ResultReason.Canceled){const h=i.EnumTranslation.implTranslateCancelResult(p.RecognitionStatus),g=i.EnumTranslation.implTranslateCancelErrorCode(p.RecognitionStatus);await this.cancelRecognitionLocal(h,g,i.EnumTranslation.implTranslateErrorDetails(g))}else if(p.RecognitionStatus!==i.RecognitionStatus.EndOfDictation){const h=new t.TranslationRecognitionEventArgs(l,l.offset,this.privRequestSession.sessionId);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,h)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(l)}catch(g){this.privErrorCallback&&this.privErrorCallback(g)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}r=!0}},c=p=>{s.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,p.asJson());const d=this.fireEventForResult(p,s);if(this.privRequestSession.onHypothesis(d.offset),this.privTranslationRecognizer.recognizing)try{this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,d)}catch{}r=!0};switch(o.messageType===e.MessageType.Text&&s.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,o.textBody),o.path.toLowerCase()){case"translation.hypothesis":c(i.TranslationHypothesis.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset));break;case"translation.response":const p=JSON.parse(o.textBody);if(p.SpeechPhrase)await a(i.TranslationPhrase.fromTranslationResponse(p,this.privRequestSession.currentTurnAudioOffset));else{const l=JSON.parse(o.textBody);l.SpeechHypothesis&&c(i.TranslationHypothesis.fromTranslationResponse(l,this.privRequestSession.currentTurnAudioOffset))}break;case"translation.phrase":await a(i.TranslationPhrase.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset));break;case"translation.synthesis":case"audio":this.sendSynthesisAudio(o.binaryBody,this.privRequestSession.sessionId),r=!0;break;case"audio.end":case"translation.synthesis.end":const d=i.TranslationSynthesisEnd.fromJSON(o.textBody);switch(d.SynthesisStatus){case i.SynthesisStatus.Error:if(this.privTranslationRecognizer.synthesizing){const l=new t.TranslationSynthesisResult(t.ResultReason.Canceled,void 0),h=new t.TranslationSynthesisEventArgs(l,this.privRequestSession.sessionId);try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,h)}catch{}}if(this.privTranslationRecognizer.canceled){const l=new t.TranslationRecognitionCanceledEventArgs(this.privRequestSession.sessionId,t.CancellationReason.Error,d.FailureReason,t.CancellationErrorCode.ServiceError,null);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,l)}catch{}}break;case i.SynthesisStatus.Success:this.sendSynthesisAudio(void 0,this.privRequestSession.sessionId);break}r=!0;break}return r}cancelRecognition(o,s,r,a,c){const p=new t.PropertyCollection;if(p.setProperty(i.CancellationErrorCodePropertyName,t.CancellationErrorCode[a]),this.privTranslationRecognizer.canceled){const d=new t.TranslationRecognitionCanceledEventArgs(o,r,c,a,void 0);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,d)}catch{}}if(this.privSuccessCallback){const d=new t.TranslationRecognitionResult(void 0,s,t.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,c,void 0,p);try{this.privSuccessCallback(d),this.privSuccessCallback=void 0}catch{}}}handleRecognizingCallback(o,s,r){try{const a=new t.TranslationRecognitionEventArgs(t.TranslationRecognitionResult.fromSpeechRecognitionResult(o),s,r);this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,a)}catch{}}handleRecognizedCallback(o,s,r){try{const a=new t.TranslationRecognitionEventArgs(t.TranslationRecognitionResult.fromSpeechRecognitionResult(o),s,r);this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,a)}catch{}}fireEventForResult(o,s){let r;if(o.Translation.Translations!==void 0){r=new t.Translations;for(const h of o.Translation.Translations)r.set(h.Language,h.Text||h.DisplayText)}let a,c;o instanceof i.TranslationPhrase?(o.Translation&&o.Translation.TranslationStatus===e.TranslationStatus.Success?a=t.ResultReason.TranslatedSpeech:a=t.ResultReason.RecognizedSpeech,c=o.Confidence):a=t.ResultReason.TranslatingSpeech;const p=o.Language,d=new t.TranslationRecognitionResult(r,this.privRequestSession.requestId,a,o.Text,o.Duration,o.Offset,p,c,o.Translation.FailureReason,o.asJson(),s);return new t.TranslationRecognitionEventArgs(d,o.Offset,this.privRequestSession.sessionId)}sendSynthesisAudio(o,s){const r=o===void 0?t.ResultReason.SynthesizingAudioCompleted:t.ResultReason.SynthesizingAudio,a=new t.TranslationSynthesisResult(r,o),c=new t.TranslationSynthesisEventArgs(a,s);if(this.privTranslationRecognizer.synthesizing)try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,c)}catch{}}};return Xr.TranslationServiceRecognizer=u,Xr}var Zr={},Cu;function Hf(){if(Cu)return Zr;Cu=1,Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.SpeechDetected=void 0;let e=class od{constructor(i,u){this.privSpeechStartDetected=JSON.parse(i),this.privSpeechStartDetected.Offset+=u}static fromJSON(i,u){return new od(i,u)}get Offset(){return this.privSpeechStartDetected.Offset}};return Zr.SpeechDetected=e,Zr}var Yr={},yu;function Kf(){if(yu)return Yr;yu=1,Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.SpeechHypothesis=void 0;let e=class ad{constructor(i,u){this.privSpeechHypothesis=JSON.parse(i),this.updateOffset(u)}static fromJSON(i,u){return new ad(i,u)}updateOffset(i){this.privSpeechHypothesis.Offset+=i}asJson(){return JSON.stringify(this.privSpeechHypothesis)}get Text(){return this.privSpeechHypothesis.Text}get Offset(){return this.privSpeechHypothesis.Offset}get Duration(){return this.privSpeechHypothesis.Duration}get Language(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSpeechHypothesis.SpeakerId}};return Yr.SpeechHypothesis=e,Yr}var $r={},Ru;function Vf(){if(Ru)return $r;Ru=1,Object.defineProperty($r,"__esModule",{value:!0}),$r.SpeechKeyword=void 0;let e=class cd{constructor(i,u){this.privSpeechKeyword=JSON.parse(i),this.privSpeechKeyword.Offset+=u}static fromJSON(i,u){return new cd(i,u)}get Status(){return this.privSpeechKeyword.Status}get Text(){return this.privSpeechKeyword.Text}get Offset(){return this.privSpeechKeyword.Offset}get Duration(){return this.privSpeechKeyword.Duration}asJson(){return JSON.stringify(this.privSpeechKeyword)}};return $r.SpeechKeyword=e,$r}var ei={},Pu;function Jf(){if(Pu)return ei;Pu=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.SpeechServiceRecognizer=void 0;const e=A(),t=w();let i=class extends t.ServiceRecognizerBase{constructor(n,o,s,r,a){super(n,o,s,r,a),this.privSpeechRecognizer=a}async processTypeSpecificMessages(n){let o;const s=new e.PropertyCollection;let r=!1;switch(n.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const a=t.SpeechHypothesis.fromJSON(n.textBody,this.privRequestSession.currentTurnAudioOffset);s.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,a.asJson()),o=new e.SpeechRecognitionResult(this.privRequestSession.requestId,e.ResultReason.RecognizingSpeech,a.Text,a.Duration,a.Offset,a.Language,a.LanguageDetectionConfidence,void 0,void 0,a.asJson(),s),this.privRequestSession.onHypothesis(a.Offset);const c=new e.SpeechRecognitionEventArgs(o,a.Offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,c)}catch{}r=!0;break;case"speech.phrase":const p=t.SimpleSpeechPhrase.fromJSON(n.textBody,this.privRequestSession.currentTurnAudioOffset);s.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,p.asJson());const d=t.EnumTranslation.implTranslateRecognitionResult(p.RecognitionStatus,this.privExpectContentAssessmentResponse);if(this.privRequestSession.onPhraseRecognized(p.Offset+p.Duration),e.ResultReason.Canceled===d){const l=t.EnumTranslation.implTranslateCancelResult(p.RecognitionStatus),h=t.EnumTranslation.implTranslateCancelErrorCode(p.RecognitionStatus);await this.cancelRecognitionLocal(l,h,t.EnumTranslation.implTranslateErrorDetails(h))}else{if(p.RecognitionStatus===t.RecognitionStatus.EndOfDictation)break;if(this.privRecognizerConfig.parameters.getProperty(t.OutputFormatPropertyName)===e.OutputFormat[e.OutputFormat.Simple])o=new e.SpeechRecognitionResult(this.privRequestSession.requestId,d,p.DisplayText,p.Duration,p.Offset,p.Language,p.LanguageDetectionConfidence,void 0,void 0,p.asJson(),s);else{const h=t.DetailedSpeechPhrase.fromJSON(n.textBody,this.privRequestSession.currentTurnAudioOffset);s.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,h.asJson()),o=new e.SpeechRecognitionResult(this.privRequestSession.requestId,d,h.RecognitionStatus===t.RecognitionStatus.Success?h.NBest[0].Display:"",h.Duration,h.Offset,h.Language,h.LanguageDetectionConfidence,void 0,void 0,h.asJson(),s)}const l=new e.SpeechRecognitionEventArgs(o,o.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,l)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(o)}catch(h){this.privErrorCallback&&this.privErrorCallback(h)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}r=!0;break}return r}cancelRecognition(n,o,s,r,a){const c=new e.PropertyCollection;if(c.setProperty(t.CancellationErrorCodePropertyName,e.CancellationErrorCode[r]),this.privSpeechRecognizer.canceled){const p=new e.SpeechRecognitionCanceledEventArgs(s,a,r,void 0,n);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,p)}catch{}}if(this.privSuccessCallback){const p=new e.SpeechRecognitionResult(o,e.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,a,void 0,c);try{this.privSuccessCallback(p),this.privSuccessCallback=void 0}catch{}}}};return ei.SpeechServiceRecognizer=i,ei}var ti={},Qn={},Eu;function Gf(){return Eu||(Eu=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.IdentityProvider=e.SpeakerDiarizationMode=void 0,(function(t){t.None="None",t.Identity="Identity",t.Anonymous="Anonymous"})(e.SpeakerDiarizationMode||(e.SpeakerDiarizationMode={})),(function(t){t.CallCenter="CallCenter"})(e.IdentityProvider||(e.IdentityProvider={}))})(Qn)),Qn}var Tu;function Qf(){if(Tu)return ti;Tu=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.ConversationTranscriptionServiceRecognizer=void 0;const e=A(),t=w(),i=Gf(),u=Y();let n=class extends t.ServiceRecognizerBase{constructor(s,r,a,c,p){super(s,r,a,c,p),this.privConversationTranscriber=p,this.setSpeakerDiarizationJson()}setSpeakerDiarizationJson(){if(this.privEnableSpeakerId){const s=this.privSpeechContext.getContext().phraseDetection||{};s.mode=u.RecognitionMode.Conversation;const r={};r.mode=i.SpeakerDiarizationMode.Anonymous,r.audioSessionId=this.privDiarizationSessionId,r.audioOffsetMs=0,r.diarizeIntermediates=this.privRecognizerConfig.parameters.getProperty(e.PropertyId.SpeechServiceResponse_DiarizeIntermediateResults,"false")==="true",s.speakerDiarization=r,this.privSpeechContext.getContext().phraseDetection=s}}async processTypeSpecificMessages(s){let r;const a=new e.PropertyCollection;a.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,s.textBody);let c=!1;switch(s.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const p=t.SpeechHypothesis.fromJSON(s.textBody,this.privRequestSession.currentTurnAudioOffset);r=new e.ConversationTranscriptionResult(this.privRequestSession.requestId,e.ResultReason.RecognizingSpeech,p.Text,p.Duration,p.Offset,p.Language,p.LanguageDetectionConfidence,p.SpeakerId,void 0,p.asJson(),a),this.privRequestSession.onHypothesis(p.Offset);const d=new e.ConversationTranscriptionEventArgs(r,p.Duration,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribing)try{this.privConversationTranscriber.transcribing(this.privConversationTranscriber,d)}catch{}c=!0;break;case"speech.phrase":const l=t.SimpleSpeechPhrase.fromJSON(s.textBody,this.privRequestSession.currentTurnAudioOffset),h=t.EnumTranslation.implTranslateRecognitionResult(l.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(l.Offset+l.Duration),e.ResultReason.Canceled===h){const g=t.EnumTranslation.implTranslateCancelResult(l.RecognitionStatus),f=t.EnumTranslation.implTranslateCancelErrorCode(l.RecognitionStatus);await this.cancelRecognitionLocal(g,f,t.EnumTranslation.implTranslateErrorDetails(f))}else if(!(this.privRequestSession.isSpeechEnded&&h===e.ResultReason.NoMatch&&l.RecognitionStatus!==t.RecognitionStatus.InitialSilenceTimeout)){if(this.privRecognizerConfig.parameters.getProperty(t.OutputFormatPropertyName)===e.OutputFormat[e.OutputFormat.Simple])r=new e.ConversationTranscriptionResult(this.privRequestSession.requestId,h,l.DisplayText,l.Duration,l.Offset,l.Language,l.LanguageDetectionConfidence,l.SpeakerId,void 0,l.asJson(),a);else{const f=t.DetailedSpeechPhrase.fromJSON(s.textBody,this.privRequestSession.currentTurnAudioOffset);r=new e.ConversationTranscriptionResult(this.privRequestSession.requestId,h,f.RecognitionStatus===t.RecognitionStatus.Success?f.NBest[0].Display:void 0,f.Duration,f.Offset,f.Language,f.LanguageDetectionConfidence,l.SpeakerId,void 0,f.asJson(),a)}const g=new e.ConversationTranscriptionEventArgs(r,r.offset,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribed)try{this.privConversationTranscriber.transcribed(this.privConversationTranscriber,g)}catch{}}c=!0;break}return c}cancelRecognition(s,r,a,c,p){if(new e.PropertyCollection().setProperty(t.CancellationErrorCodePropertyName,e.CancellationErrorCode[c]),this.privConversationTranscriber.canceled){const l=new e.ConversationTranscriptionCanceledEventArgs(a,p,c,void 0,s);try{this.privConversationTranscriber.canceled(this.privConversationTranscriber,l)}catch{}}}};return ti.ConversationTranscriptionServiceRecognizer=n,ti}var ri={},Au;function Xf(){if(Au)return ri;Au=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.TranscriptionServiceRecognizer=void 0;const e=b(),t=A(),i=w(),u=xi();let n=class extends i.ConversationServiceRecognizer{constructor(s,r,a,c,p){super(s,r,a,c,p),this.privTranscriberRecognizer=p,this.sendPrePayloadJSONOverride=d=>this.sendTranscriptionStartJSON(d),this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps)==="true"&&this.privSpeechContext.setWordLevelTimings()}async sendSpeechEventAsync(s,r){if(this.privRequestSession.isRecognizing){const a=await this.fetchConnection();await this.sendSpeechEvent(a,this.createSpeechEventPayload(s,r))}}async sendMeetingSpeechEventAsync(s,r){if(this.privRequestSession.isRecognizing){const a=await this.fetchConnection();await this.sendSpeechEvent(a,this.createMeetingSpeechEventPayload(s,r))}}processTypeSpecificMessages(s){return this.processSpeechMessages(s)}handleRecognizedCallback(s,r,a){try{const c=new t.SpeechRecognitionEventArgs(s,r,a);if(this.privTranscriberRecognizer.recognized(this.privTranscriberRecognizer,c),this.privSuccessCallback){try{this.privSuccessCallback(s)}catch(p){this.privErrorCallback&&this.privErrorCallback(p)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}catch{}}handleRecognizingCallback(s,r,a){try{const c=new t.SpeechRecognitionEventArgs(s,r,a);this.privTranscriberRecognizer.recognizing(this.privTranscriberRecognizer,c)}catch{}}cancelRecognition(s,r,a,c,p){const d=new t.PropertyCollection;if(d.setProperty(i.CancellationErrorCodePropertyName,t.CancellationErrorCode[c]),this.privTranscriberRecognizer.IsMeetingRecognizer()){if(this.privTranscriberRecognizer.canceled){const l=new t.MeetingTranscriptionCanceledEventArgs(a,p,c,void 0,s);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,l)}catch{}}}else if(this.privTranscriberRecognizer.canceled){const l=new t.ConversationTranscriptionCanceledEventArgs(a,p,c,void 0,s);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,l)}catch{}}if(this.privSuccessCallback){const l=new t.SpeechRecognitionResult(r,t.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,p,void 0,d);try{this.privSuccessCallback(l),this.privSuccessCallback=void 0}catch{}}}async sendTranscriptionStartJSON(s){if(await this.sendSpeechContext(s,!0),this.privTranscriberRecognizer.IsMeetingRecognizer()){const r=this.privTranscriberRecognizer.getMeetingInfo(),a=this.createMeetingSpeechEventPayload(r,"start");await this.sendSpeechEvent(s,a)}else{const r=this.privTranscriberRecognizer.getConversationInfo(),a=this.createSpeechEventPayload(r,"start");await this.sendSpeechEvent(s,a)}await this.sendWaveHeader(s)}sendSpeechEvent(s,r){const a=JSON.stringify(r);if(a)return s.send(new u.SpeechConnectionMessage(e.MessageType.Text,"speech.event",this.privRequestSession.requestId,"application/json",a))}createSpeechEventPayload(s,r){const a={id:"meeting",name:r,meeting:s.conversationProperties};return a.meeting.id=s.id,a.meeting.attendees=s.participants,a}createMeetingSpeechEventPayload(s,r){const a={id:"meeting",name:r,meeting:s.meetingProperties};return a.meeting.id=s.id,a.meeting.attendees=s.participants,a}};return ri.TranscriptionServiceRecognizer=n,ri}var ii={},Iu;function Zf(){if(Iu)return ii;Iu=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.DetailedSpeechPhrase=void 0;const e=w();let t=class ud{constructor(u,n){this.privDetailedSpeechPhrase=JSON.parse(u),this.privDetailedSpeechPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privDetailedSpeechPhrase.RecognitionStatus),this.updateOffsets(n)}static fromJSON(u,n){return new ud(u,n)}updateOffsets(u){if(this.privDetailedSpeechPhrase.Offset+=u,this.privDetailedSpeechPhrase.NBest)for(const n of this.privDetailedSpeechPhrase.NBest){if(n.Words)for(const o of n.Words)o.Offset+=u;if(n.DisplayWords)for(const o of n.DisplayWords)o.Offset+=u}}asJson(){const u={...this.privDetailedSpeechPhrase};return JSON.stringify({...u,RecognitionStatus:e.RecognitionStatus[u.RecognitionStatus]})}get RecognitionStatus(){return this.privDetailedSpeechPhrase.RecognitionStatus}get NBest(){return this.privDetailedSpeechPhrase.NBest}get Duration(){return this.privDetailedSpeechPhrase.Duration}get Offset(){return this.privDetailedSpeechPhrase.Offset}get Language(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence}get Text(){return this.privDetailedSpeechPhrase.NBest&&this.privDetailedSpeechPhrase.NBest[0]?this.privDetailedSpeechPhrase.NBest[0].Display||this.privDetailedSpeechPhrase.NBest[0].DisplayText:this.privDetailedSpeechPhrase.DisplayText}get SpeakerId(){return this.privDetailedSpeechPhrase.SpeakerId}mapRecognitionStatus(u){if(typeof u=="string")return e.RecognitionStatus[u];if(typeof u=="number")return u}};return ii.DetailedSpeechPhrase=t,ii}var ni={},wu;function Yf(){if(wu)return ni;wu=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.SimpleSpeechPhrase=void 0;const e=w();let t=class pd{constructor(u,n=0){this.privSimpleSpeechPhrase=JSON.parse(u),this.privSimpleSpeechPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privSimpleSpeechPhrase.RecognitionStatus),this.updateOffset(n)}static fromJSON(u,n){return new pd(u,n)}updateOffset(u){this.privSimpleSpeechPhrase.Offset+=u}asJson(){const u={...this.privSimpleSpeechPhrase};return JSON.stringify({...u,RecognitionStatus:e.RecognitionStatus[u.RecognitionStatus]})}get RecognitionStatus(){return this.privSimpleSpeechPhrase.RecognitionStatus}get DisplayText(){return this.privSimpleSpeechPhrase.DisplayText}get Offset(){return this.privSimpleSpeechPhrase.Offset}get Duration(){return this.privSimpleSpeechPhrase.Duration}get Language(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSimpleSpeechPhrase.SpeakerId}mapRecognitionStatus(u){if(typeof u=="string")return e.RecognitionStatus[u];if(typeof u=="number")return u}};return ni.SimpleSpeechPhrase=t,ni}var si={},oi={},_u;function $f(){if(_u)return oi;_u=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.ServiceTelemetryListener=void 0;const e=b(),t=Rs();class i{constructor(n,o,s){this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privRequestId=n,this.privAudioSourceId=o,this.privAudioNodeId=s,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}phraseReceived(n){n>0&&this.privPhraseLatencies.push(Date.now()-n)}hypothesisReceived(n){n>0&&this.privHypothesisLatencies.push(Date.now()-n)}onEvent(n){this.privIsDisposed||(n instanceof t.RecognitionTriggeredEvent&&n.requestId===this.privRequestId&&(this.privListeningTriggerMetric={End:n.eventTime,Name:"ListeningTrigger",Start:n.eventTime}),n instanceof e.AudioStreamNodeAttachingEvent&&n.audioSourceId===this.privAudioSourceId&&n.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=n.eventTime),n instanceof e.AudioStreamNodeAttachedEvent&&n.audioSourceId===this.privAudioSourceId&&n.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=n.eventTime),n instanceof e.AudioSourceErrorEvent&&n.audioSourceId===this.privAudioSourceId&&(this.privMicMetric||(this.privMicMetric={End:n.eventTime,Error:n.error,Name:"Microphone",Start:this.privMicStartTime})),n instanceof e.AudioStreamNodeErrorEvent&&n.audioSourceId===this.privAudioSourceId&&n.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:n.eventTime,Error:n.error,Name:"Microphone",Start:this.privMicStartTime})),n instanceof e.AudioStreamNodeDetachedEvent&&n.audioSourceId===this.privAudioSourceId&&n.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:n.eventTime,Name:"Microphone",Start:this.privMicStartTime})),n instanceof t.ConnectingToServiceEvent&&n.requestId===this.privRequestId&&(this.privConnectionId=n.sessionId),n instanceof e.ConnectionStartEvent&&n.connectionId===this.privConnectionId&&(this.privConnectionStartTime=n.eventTime),n instanceof e.ConnectionEstablishedEvent&&n.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:n.eventTime,Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),n instanceof e.ConnectionEstablishErrorEvent&&n.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:n.eventTime,Error:this.getConnectionError(n.statusCode),Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),n instanceof e.ConnectionMessageReceivedEvent&&n.connectionId===this.privConnectionId&&n.message&&n.message.headers&&n.message.headers.path&&(this.privReceivedMessages[n.message.headers.path]||(this.privReceivedMessages[n.message.headers.path]=new Array),this.privReceivedMessages[n.message.headers.path].length<50&&this.privReceivedMessages[n.message.headers.path].push(n.networkReceivedTime)))}getTelemetry(){const n=new Array;this.privListeningTriggerMetric&&n.push(this.privListeningTriggerMetric),this.privMicMetric&&n.push(this.privMicMetric),this.privConnectionEstablishMetric&&n.push(this.privConnectionEstablishMetric),this.privPhraseLatencies.length>0&&n.push({PhraseLatencyMs:this.privPhraseLatencies}),this.privHypothesisLatencies.length>0&&n.push({FirstHypothesisLatencyMs:this.privHypothesisLatencies});const o={Metrics:n,ReceivedMessages:this.privReceivedMessages},s=JSON.stringify(o);return this.privReceivedMessages={},this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privPhraseLatencies=[],this.privHypothesisLatencies=[],s}get hasTelemetry(){return Object.keys(this.privReceivedMessages).length!==0||this.privListeningTriggerMetric!==null||this.privMicMetric!==null||this.privConnectionEstablishMetric!==null||this.privPhraseLatencies.length!==0||this.privHypothesisLatencies.length!==0}dispose(){this.privIsDisposed=!0}getConnectionError(n){switch(n){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+n.toString()}}}return oi.ServiceTelemetryListener=i,oi}var bu;function eg(){if(bu)return si;bu=1,Object.defineProperty(si,"__esModule",{value:!0}),si.RequestSession=void 0;const e=b(),t=Rs(),i=$f();let u=class{constructor(o){this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecognitionBytesSent=0,this.privRecogNumber=0,this.privInTurn=!1,this.privConnectionAttempts=0,this.privAudioSourceId=o,this.privRequestId=(0,e.createNoDashGuid)(),this.privAudioNodeId=(0,e.createNoDashGuid)(),this.privTurnDeferral=new e.Deferred,this.privTurnDeferral.resolve()}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get audioNodeId(){return this.privAudioNodeId}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSpeechEnded(){return this.privIsSpeechEnded}get isRecognizing(){return this.privIsRecognizing}get currentTurnAudioOffset(){return this.privTurnStartAudioOffset}get recogNumber(){return this.privRecogNumber}get numConnectionAttempts(){return this.privConnectionAttempts}get bytesSent(){return this.privBytesSent}get recognitionBytesSent(){return this.privRecognitionBytesSent}listenForServiceTelemetry(o){this.privServiceTelemetryListener&&this.privDetachables.push(o.attachListener(this.privServiceTelemetryListener))}startNewRecognition(){this.privRecognitionBytesSent=0,this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRecogNumber++,this.privServiceTelemetryListener=new i.ServiceTelemetryListener(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new t.RecognitionTriggeredEvent(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}async onAudioSourceAttachCompleted(o,s){this.privAudioNode=o,this.privIsAudioNodeDetached=!1,s?await this.onComplete():this.onEvent(new t.ListeningStartedEvent(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}onPreConnectionStart(o,s){this.privAuthFetchEventId=o,this.privSessionId=s,this.onEvent(new t.ConnectingToServiceEvent(this.privRequestId,this.privAuthFetchEventId,this.privSessionId))}async onAuthCompleted(o){o&&await this.onComplete()}async onConnectionEstablishCompleted(o,s){if(o===200){this.onEvent(new t.RecognitionStartedEvent(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privBytesSent=0;return}else o===403&&await this.onComplete()}async onServiceTurnEndResponse(o){this.privTurnDeferral.resolve(),!o||this.isSpeechEnded?(await this.onComplete(),this.privInTurn=!1):(this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privAudioNode.replay())}onSpeechContext(){this.privRequestId=(0,e.createNoDashGuid)()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new e.Deferred}onHypothesis(o){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(o)))}onPhraseRecognized(o){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(o)),this.onServiceRecognized(o)}onServiceRecognized(o){this.privLastRecoOffset=o,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(o),this.privConnectionAttempts=0}onAudioSent(o){this.privBytesSent+=o,this.privRecognitionBytesSent+=o}onRetryConnection(){this.privConnectionAttempts++}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const o of this.privDetachables)await o.detach();this.privServiceTelemetryListener&&this.privServiceTelemetryListener.dispose(),this.privIsRecognizing=!1}}getTelemetry(){return this.privServiceTelemetryListener.hasTelemetry?this.privServiceTelemetryListener.getTelemetry():null}async onStopRecognizing(){await this.onComplete()}onSpeechEnded(){this.privIsSpeechEnded=!0}onEvent(o){this.privServiceTelemetryListener&&this.privServiceTelemetryListener.onEvent(o),e.Events.instance.onEvent(o)}async onComplete(){this.privIsRecognizing&&(this.privIsRecognizing=!1,await this.detachAudioNode())}async detachAudioNode(){this.privIsAudioNodeDetached||(this.privIsAudioNodeDetached=!0,this.privAudioNode&&await this.privAudioNode.detach())}};return si.RequestSession=u,si}var ai={},Xn={},Mu;function tg(){return Mu||(Mu=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TentativePhraseResultsOption=e.OutputFormat=e.PhraseExtension=e.PhraseOption=void 0,(function(t){t.WordTimings="WordTimings",t.SNR="SNR",t.Pronunciation="Pronunciation",t.WordPronunciation="WordPronunciation",t.WordConfidence="WordConfidence",t.Words="Words",t.Sentiment="Sentiment",t.PronunciationAssessment="PronunciationAssessment",t.ContentAssessment="ContentAssessment",t.PhraseAMScore="PhraseAMScore",t.PhraseLMScore="PhraseLMScore",t.WordAMScore="WordAMScore",t.WordLMScore="WordLMScore",t.RuleTree="RuleTree",t.NBestTimings="NBestTimings",t.DecoderDiagnostics="DecoderDiagnostics",t.DisplayWordTimings="DisplayWordTimings",t.DisplayWords="DisplayWords"})(e.PhraseOption||(e.PhraseOption={})),(function(t){t.Graph="Graph",t.Corrections="Corrections",t.Sentiment="Sentiment"})(e.PhraseExtension||(e.PhraseExtension={})),(function(t){t.Simple="Simple",t.Detailed="Detailed"})(e.OutputFormat||(e.OutputFormat={})),(function(t){t.None="None",t.Always="Always"})(e.TentativePhraseResultsOption||(e.TentativePhraseResultsOption={}))})(Xn)),Xn}var Ou;function rg(){if(Ou)return ai;Ou=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.SpeechContext=void 0;const e=Y(),t=tg();let i=class{constructor(n){this.privContext={},this.privDynamicGrammar=n}getContext(){return this.privContext}setPronunciationAssessmentParams(n,o=!1){this.privContext.phraseDetection===void 0&&(this.privContext.phraseDetection={enrichment:{pronunciationAssessment:{}}}),this.privContext.phraseDetection.enrichment===void 0&&(this.privContext.phraseDetection.enrichment={pronunciationAssessment:{}}),this.privContext.phraseDetection.enrichment.pronunciationAssessment=JSON.parse(n)||{},o&&(this.privContext.phraseDetection.mode=e.RecognitionMode.Conversation),this.setWordLevelTimings(),this.privContext.phraseOutput.detailed.options.push(t.PhraseOption.PronunciationAssessment),this.privContext.phraseOutput.detailed.options.indexOf(t.PhraseOption.SNR)===-1&&this.privContext.phraseOutput.detailed.options.push(t.PhraseOption.SNR)}setDetailedOutputFormat(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format=t.OutputFormat.Detailed}setWordLevelTimings(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format=t.OutputFormat.Detailed,this.privContext.phraseOutput.detailed.options.indexOf(t.PhraseOption.WordTimings)===-1&&this.privContext.phraseOutput.detailed.options.push(t.PhraseOption.WordTimings)}setSpeakerDiarizationAudioOffsetMs(n){this.privContext.phraseDetection.speakerDiarization.audioOffsetMs=n}toJSON(){const n=this.privDynamicGrammar.generateGrammarObject();return this.privContext.dgi=n,JSON.stringify(this.privContext)}};return ai.SpeechContext=i,ai}var ci={},Zn={},Du;function ig(){return Du||(Du=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SubstringMatchType=e.GroupType=void 0,(function(t){t.IntentText="IntentText",t.IntentEntity="IntentEntity",t.Generic="Generic",t.People="People",t.Place="Place",t.DynamicEntity="DynamicEntity"})(e.GroupType||(e.GroupType={})),(function(t){t.None="None",t.LeftRooted="LeftRooted",t.PartialName="PartialName",t.MiddleOfSentence="MiddleOfSentence"})(e.SubstringMatchType||(e.SubstringMatchType={}))})(Zn)),Zn}var ku;function ng(){if(ku)return ci;ku=1,Object.defineProperty(ci,"__esModule",{value:!0}),ci.DynamicGrammarBuilder=void 0;const e=ig();let t=class{constructor(){this.privWeight=1}addPhrase(u){this.privPhrases||(this.privPhrases=[]),u instanceof Array?this.privPhrases=this.privPhrases.concat(u):this.privPhrases.push(u)}clearPhrases(){this.privPhrases=void 0}addReferenceGrammar(u){this.privGrammars||(this.privGrammars=[]),u instanceof Array?this.privGrammars=this.privGrammars.concat(u):this.privGrammars.push(u)}clearGrammars(){this.privGrammars=void 0}setWeight(u){this.privWeight=u}generateGrammarObject(){if(this.privGrammars===void 0&&this.privPhrases===void 0)return;const u={};if(u.referenceGrammars=this.privGrammars,this.privPhrases!==void 0&&this.privPhrases.length!==0){const n=[];this.privPhrases.forEach(o=>{n.push({text:o})}),u.groups=[{type:e.GroupType.Generic,items:n}],u.bias=this.privWeight}return u}};return ci.DynamicGrammarBuilder=t,ci}var ui={},pi={},di={},Yn={},Nu;function dd(){return Nu||(Nu=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.MessageDataStreamType=e.ActivityPayloadResponse=void 0;class t{constructor(u){this.privActivityResponse=JSON.parse(u)}static fromJSON(u){return new t(u)}get conversationId(){return this.privActivityResponse.conversationId}get messageDataStreamType(){return this.privActivityResponse.messageDataStreamType}get messagePayload(){return this.privActivityResponse.messagePayload}get version(){return this.privActivityResponse.version}}e.ActivityPayloadResponse=t,(function(i){i[i.None=0]="None",i[i.TextToSpeechAudio=1]="TextToSpeechAudio"})(e.MessageDataStreamType||(e.MessageDataStreamType={}))})(Yn)),Yn}var zu;function sg(){if(zu)return di;zu=1,Object.defineProperty(di,"__esModule",{value:!0}),di.DialogServiceTurnState=void 0;const e=Oi(),t=Le(),i=dd();let u=class{constructor(o,s){this.privRequestId=s,this.privIsCompleted=!1,this.privAudioStream=null,this.privTurnManager=o,this.resetTurnEndTimeout()}get audioStream(){return this.resetTurnEndTimeout(),this.privAudioStream}processActivityPayload(o,s){return o.messageDataStreamType===i.MessageDataStreamType.TextToSpeechAudio&&(this.privAudioStream=t.AudioOutputStream.createPullStream(),this.privAudioStream.format=s!==void 0?s:e.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privAudioStream}endAudioStream(){this.privAudioStream!==null&&!this.privAudioStream.isClosed&&this.privAudioStream.close()}complete(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.endAudioStream()}resetTurnEndTimeout(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.privTimeoutToken=setTimeout(()=>{this.privTurnManager.CompleteTurn(this.privRequestId)},2e3)}};return di.DialogServiceTurnState=u,di}var ju;function og(){if(ju)return pi;ju=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.DialogServiceTurnStateManager=void 0;const e=$(),t=sg();let i=class{constructor(){this.privTurnMap=new Map}StartTurn(n){if(this.privTurnMap.has(n))throw new e.InvalidOperationError("Service error: There is already a turn with id:"+n);const o=new t.DialogServiceTurnState(this,n);return this.privTurnMap.set(n,o),this.privTurnMap.get(n)}GetTurn(n){return this.privTurnMap.get(n)}CompleteTurn(n){if(!this.privTurnMap.has(n))throw new e.InvalidOperationError("Service error: Received turn end for an unknown turn id:"+n);const o=this.privTurnMap.get(n);return o.complete(),this.privTurnMap.delete(n),o}};return pi.DialogServiceTurnStateManager=i,pi}var $n={},Lu;function ag(){return Lu||(Lu=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.InvocationSource=void 0,(function(t){t.None="None",t.VoiceActivationWithKeyword="VoiceActivationWithKeyword"})(e.InvocationSource||(e.InvocationSource={}))})($n)),$n}var es={},qu;function cg(){return qu||(qu=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.OnRejectAction=e.KeywordDetectionType=void 0,(function(t){t.StartTrigger="StartTrigger"})(e.KeywordDetectionType||(e.KeywordDetectionType={})),(function(t){t.EndOfTurn="EndOfTurn",t.Continue="Continue"})(e.OnRejectAction||(e.OnRejectAction={}))})(es)),es}var Bu;function ug(){if(Bu)return ui;Bu=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.DialogServiceAdapter=void 0;const e=U(),t=Pp(),i=b(),u=Oi(),n=A(),o=og(),s=w(),r=dd(),a=ag(),c=cg(),p=xi();let d=class extends s.ServiceRecognizerBase{constructor(h,g,f,m,v){super(h,g,f,m,v),this.privEvents=new i.EventSource,this.privDialogServiceConnector=v,this.receiveMessageOverride=()=>this.receiveDialogMessageOverride(),this.privTurnStateManager=new o.DialogServiceTurnStateManager,this.recognizeOverride=(S,C,y)=>this.listenOnce(S,C,y),this.postConnectImplOverride=S=>this.dialogConnectImpl(S),this.configConnectionOverride=S=>this.configConnection(S),this.disconnectOverride=()=>this.privDisconnect(),this.privDialogAudioSource=f,this.agentConfigSent=!1,this.privLastResult=null,this.connectionEvents.attach(S=>{S.name==="ConnectionClosedEvent"&&(this.terminateMessageLoop=!0)})}async sendMessage(h){const g=(0,i.createGuid)(),f=(0,i.createNoDashGuid)(),m={context:{interactionId:g},messagePayload:JSON.parse(h),version:.5},v=JSON.stringify(m);await(await this.fetchConnection()).send(new p.SpeechConnectionMessage(i.MessageType.Text,"agent",f,"application/json",v))}async privDisconnect(){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,n.CancellationReason.Error,n.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,this.agentConfigSent=!1}processTypeSpecificMessages(h){const g=new n.PropertyCollection;h.messageType===i.MessageType.Text&&g.setProperty(n.PropertyId.SpeechServiceResponse_JsonResult,h.textBody);let f,m;switch(h.path.toLowerCase()){case"speech.phrase":const S=s.SimpleSpeechPhrase.fromJSON(h.textBody,this.privRequestSession.currentTurnAudioOffset);if(this.privRequestSession.onPhraseRecognized(S.Offset+S.Duration),S.RecognitionStatus!==s.RecognitionStatus.TooManyRequests&&S.RecognitionStatus!==s.RecognitionStatus.Error){const E=this.fireEventForResult(S,g);if(this.privLastResult=E.result,this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,E)}catch{}}m=!0;break;case"speech.hypothesis":const C=s.SpeechHypothesis.fromJSON(h.textBody,this.privRequestSession.currentTurnAudioOffset);f=new n.SpeechRecognitionResult(this.privRequestSession.requestId,n.ResultReason.RecognizingSpeech,C.Text,C.Duration,C.Offset,C.Language,C.LanguageDetectionConfidence,void 0,void 0,C.asJson(),g),this.privRequestSession.onHypothesis(C.Offset);const y=new n.SpeechRecognitionEventArgs(f,C.Offset,this.privRequestSession.sessionId);if(this.privDialogServiceConnector.recognizing)try{this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector,y)}catch{}m=!0;break;case"speech.keyword":const R=s.SpeechKeyword.fromJSON(h.textBody,this.privRequestSession.currentTurnAudioOffset);f=new n.SpeechRecognitionResult(this.privRequestSession.requestId,R.Status==="Accepted"?n.ResultReason.RecognizedKeyword:n.ResultReason.NoMatch,R.Text,R.Duration,R.Offset,void 0,void 0,void 0,void 0,R.asJson(),g),R.Status!=="Accepted"&&(this.privLastResult=f);const T=new n.SpeechRecognitionEventArgs(f,f.duration,f.resultId);if(this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,T)}catch{}m=!0;break;case"audio":{const E=h.requestId.toUpperCase(),P=this.privTurnStateManager.GetTurn(E);try{h.binaryBody?P.audioStream.write(h.binaryBody):P.endAudioStream()}catch{}}m=!0;break;case"response":this.handleResponseMessage(h),m=!0;break}const v=new i.Deferred;return v.resolve(m),v.promise}async cancelRecognition(h,g,f,m,v){if(this.terminateMessageLoop=!0,this.privRequestSession.isRecognizing&&await this.privRequestSession.onStopRecognizing(),this.privDialogServiceConnector.canceled){const S=new n.PropertyCollection;S.setProperty(s.CancellationErrorCodePropertyName,n.CancellationErrorCode[m]);const C=new n.SpeechRecognitionCanceledEventArgs(f,v,m,void 0,h);try{this.privDialogServiceConnector.canceled(this.privDialogServiceConnector,C)}catch{}if(this.privSuccessCallback){const y=new n.SpeechRecognitionResult(void 0,n.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,v,void 0,S);try{this.privSuccessCallback(y),this.privSuccessCallback=void 0}catch{}}}}async listenOnce(h,g,f){this.privRecognizerConfig.recognitionMode=h,this.privSuccessCallback=g,this.privErrorCallback=f,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events),this.privRecognizerConfig.parameters.setProperty(n.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const m=this.connectImpl(),v=this.sendPreAudioMessages(),S=await this.privDialogAudioSource.attach(this.privRequestSession.audioNodeId),C=await this.privDialogAudioSource.format,y=await this.privDialogAudioSource.deviceInfo,R=new e.ReplayableAudioNode(S,C.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(R,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:y};try{await m,await v}catch(P){return await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,n.CancellationReason.Error,n.CancellationErrorCode.ConnectionFailure,P),Promise.resolve()}const T=new n.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,T),this.sendAudio(R).then(()=>{},async P=>{await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,n.CancellationReason.Error,n.CancellationErrorCode.RuntimeError,P)})}dialogConnectImpl(h){return this.privConnectionLoop=this.startMessageLoop(),h}receiveDialogMessageOverride(){const h=new i.Deferred,g=async()=>{try{const f=this.isDisposed(),m=!this.isDisposed()&&this.terminateMessageLoop;if(f||m){h.resolve(void 0);return}const S=await(await this.fetchConnection()).read();if(!S)return g();const C=p.SpeechConnectionMessage.fromConnectionMessage(S);switch(C.path.toLowerCase()){case"turn.start":{const M=C.requestId.toUpperCase(),k=this.privRequestSession.requestId.toUpperCase();M!==k?this.privTurnStateManager.StartTurn(M):this.privRequestSession.onServiceTurnStartResponse()}break;case"speech.startdetected":const R=s.SpeechDetected.fromJSON(C.textBody,this.privRequestSession.currentTurnAudioOffset),T=new n.RecognitionEventArgs(R.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,T);break;case"speech.enddetected":let E;C.textBody.length>0?E=C.textBody:E="{ Offset: 0 }";const P=s.SpeechDetected.fromJSON(E,this.privRequestSession.currentTurnAudioOffset);this.privRequestSession.onServiceRecognized(P.Offset);const I=new n.RecognitionEventArgs(P.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,I);break;case"turn.end":{const M=C.requestId.toUpperCase(),k=this.privRequestSession.requestId.toUpperCase();if(M!==k)this.privTurnStateManager.CompleteTurn(M);else{const ee=new n.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(!1),(!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing)&&this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,ee),this.privSuccessCallback&&this.privLastResult){try{this.privSuccessCallback(this.privLastResult),this.privLastResult=null}catch(_){this.privErrorCallback&&this.privErrorCallback(_)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}}break;default:try{await this.processTypeSpecificMessages(C)||this.serviceEvents&&this.serviceEvents.onEvent(new i.ServiceEvent(C.path.toLowerCase(),C.textBody))}catch{}}return g()}catch{this.terminateMessageLoop=!0,h.resolve()}};return g().catch(f=>{i.Events.instance.onEvent(new i.BackgroundEvent(f))}),h.promise}async startMessageLoop(){this.terminateMessageLoop=!1;try{await this.receiveDialogMessageOverride()}catch(h){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,n.CancellationReason.Error,n.CancellationErrorCode.RuntimeError,h)}return Promise.resolve()}async configConnection(h){return this.terminateMessageLoop?(this.terminateMessageLoop=!1,Promise.reject("Connection to service terminated.")):(await this.sendSpeechServiceConfig(h,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendAgentConfig(h),h)}async sendPreAudioMessages(){const h=await this.fetchConnection();this.addKeywordContextData(),await this.sendSpeechContext(h,!0),await this.sendAgentContext(h),await this.sendWaveHeader(h)}sendAgentConfig(h){if(this.agentConfig&&!this.agentConfigSent){if(this.privRecognizerConfig.parameters.getProperty(n.PropertyId.Conversation_DialogType)===n.DialogServiceConfig.DialogTypes.CustomCommands){const f=this.agentConfig.get();f.botInfo.commandsCulture=this.privRecognizerConfig.parameters.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage,"en-us"),this.agentConfig.set(f)}this.onEvent(new t.SendingAgentContextMessageEvent(this.agentConfig));const g=this.agentConfig.toJsonString();return this.agentConfigSent=!0,h.send(new p.SpeechConnectionMessage(i.MessageType.Text,"agent.config",this.privRequestSession.requestId,"application/json",g))}}sendAgentContext(h){const g=(0,i.createGuid)(),f=this.privDialogServiceConnector.properties.getProperty(n.PropertyId.Conversation_Speech_Activity_Template),v=JSON.stringify({channelData:"",context:{interactionId:g},messagePayload:typeof f===void 0?void 0:f,version:.5});return h.send(new p.SpeechConnectionMessage(i.MessageType.Text,"speech.agent.context",this.privRequestSession.requestId,"application/json",v))}fireEventForResult(h,g){const f=s.EnumTranslation.implTranslateRecognitionResult(h.RecognitionStatus),m=new n.SpeechRecognitionResult(this.privRequestSession.requestId,f,h.DisplayText,h.Duration,h.Offset,h.Language,h.LanguageDetectionConfidence,void 0,void 0,h.asJson(),g);return new n.SpeechRecognitionEventArgs(m,h.Offset,this.privRequestSession.sessionId)}handleResponseMessage(h){const g=JSON.parse(h.textBody);switch(g.messageType.toLowerCase()){case"message":const f=h.requestId.toUpperCase(),m=r.ActivityPayloadResponse.fromJSON(h.textBody),v=this.privTurnStateManager.GetTurn(f);if(m.conversationId){const y=this.agentConfig.get();y.botInfo.conversationId=m.conversationId,this.agentConfig.set(y)}const S=v.processActivityPayload(m,u.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString(this.privDialogServiceConnector.properties.getProperty(n.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0))),C=new n.ActivityReceivedEventArgs(m.messagePayload,S);if(this.privDialogServiceConnector.activityReceived)try{this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector,C)}catch{}break;case"messagestatus":if(this.privDialogServiceConnector.turnStatusReceived)try{this.privDialogServiceConnector.turnStatusReceived(this.privDialogServiceConnector,new n.TurnStatusReceivedEventArgs(h.textBody))}catch{}break;default:i.Events.instance.onEvent(new i.BackgroundEvent(`Unexpected response of type ${g.messageType}. Ignoring.`));break}}onEvent(h){this.privEvents.onEvent(h),i.Events.instance.onEvent(h)}addKeywordContextData(){const h=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect");if(h===void 0)return;const g=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Offsets"),f=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Durations"),m=h.split(";"),v=g===void 0?[]:g.split(";"),S=f===void 0?[]:f.split(";"),C=[];for(let y=0;y<m.length;y++){const R={text:m[y]};y<v.length&&(R.startOffset=Number(v[y])),y<S.length&&(R.duration=Number(S[y])),C.push(R)}this.speechContext.getContext().invocationSource=a.InvocationSource.VoiceActivationWithKeyword,this.speechContext.getContext().keywordDetection=[{clientDetectedKeywords:C,onReject:{action:c.OnRejectAction.EndOfTurn},type:c.KeywordDetectionType.StartTrigger}]}};return ui.DialogServiceAdapter=d,ui}var hi={},Fu;function pg(){if(Fu)return hi;Fu=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.AgentConfig=void 0;let e=class{toJsonString(){return JSON.stringify(this.iPrivConfig)}get(){return this.iPrivConfig}set(i){this.iPrivConfig=i}};return hi.AgentConfig=e,hi}var ts={},li={},vi={},xu;function Is(){if(xu)return vi;xu=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.ConversationConnectionConfig=void 0;const e=nd();let t=class ue extends e.RestConfigBase{static get host(){return ue.privHost}static get apiVersion(){return ue.privApiVersion}static get clientAppId(){return ue.privClientAppId}static get defaultLanguageCode(){return ue.privDefaultLanguageCode}static get restPath(){return ue.privRestPath}static get webSocketPath(){return ue.privWebSocketPath}static get transcriptionEventKeys(){return ue.privTranscriptionEventKeys}};return vi.ConversationConnectionConfig=t,t.privHost="dev.microsofttranslator.com",t.privRestPath="/capito/room",t.privApiVersion="2.0",t.privDefaultLanguageCode="en-US",t.privClientAppId="FC539C22-1767-4F1F-84BC-B4D811114F15",t.privWebSocketPath="/capito/translate",t.privTranscriptionEventKeys=["iCalUid","callId","organizer","FLAC","MTUri","DifferentiateGuestSpeakers","audiorecording","Threadid","OrganizerMri","OrganizerTenantId","UserToken"],vi}var Uu;function dg(){if(Uu)return li;Uu=1,Object.defineProperty(li,"__esModule",{value:!0}),li.ConversationManager=void 0;const e=U(),t=D(),i=A(),u=Is();let n=class{constructor(){this.privRequestParams=u.ConversationConnectionConfig.configParams,this.privErrors=u.ConversationConnectionConfig.restErrors,this.privHost=u.ConversationConnectionConfig.host,this.privApiVersion=u.ConversationConnectionConfig.apiVersion,this.privRestPath=u.ConversationConnectionConfig.restPath,this.privRestAdapter=new e.RestMessageAdapter({})}createOrJoin(s,r,a,c){try{t.Contracts.throwIfNullOrUndefined(s,"args");const p=s.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,u.ConversationConnectionConfig.defaultLanguageCode),d=s.getProperty(i.PropertyId.ConversationTranslator_Name,"conversation_host"),l=s.getProperty(i.PropertyId.ConversationTranslator_Host,this.privHost),h=s.getProperty(i.PropertyId.ConversationTranslator_CorrelationId),g=s.getProperty(i.PropertyId.SpeechServiceConnection_Key),f=s.getProperty(i.PropertyId.SpeechServiceConnection_Region),m=s.getProperty(i.PropertyId.SpeechServiceAuthorization_Token);t.Contracts.throwIfNullOrWhitespace(p,"languageCode"),t.Contracts.throwIfNullOrWhitespace(d,"nickname"),t.Contracts.throwIfNullOrWhitespace(l,"endpointHost");const v={};v[this.privRequestParams.apiVersion]=this.privApiVersion,v[this.privRequestParams.languageCode]=p,v[this.privRequestParams.nickname]=d;const S={};h&&(S[this.privRequestParams.correlationId]=h),S[this.privRequestParams.clientAppId]=u.ConversationConnectionConfig.clientAppId,r!==void 0?v[this.privRequestParams.roomId]=r:(t.Contracts.throwIfNullOrUndefined(f,this.privErrors.authInvalidSubscriptionRegion),S[this.privRequestParams.subscriptionRegion]=f,g?S[this.privRequestParams.subscriptionKey]=g:m?S[this.privRequestParams.authorization]=`Bearer ${m}`:t.Contracts.throwIfNullOrUndefined(g,this.privErrors.authInvalidSubscriptionKey));const C={};C.headers=S,this.privRestAdapter.options=C;const y=`https://${l}${this.privRestPath}`;this.privRestAdapter.request(e.RestRequestType.Post,y,v,null).then(R=>{const T=e.RestMessageAdapter.extractHeaderValue(this.privRequestParams.requestId,R.headers);if(!R.ok){if(c){let P=this.privErrors.invalidCreateJoinConversationResponse.replace("{status}",R.status.toString()),I;try{I=JSON.parse(R.data),P+=` [${I.error.code}: ${I.error.message}]`}catch{P+=` [${R.data}]`}T&&(P+=` ${T}`),c(P)}return}const E=JSON.parse(R.data);if(E&&(E.requestId=T),a){try{a(E)}catch(P){c&&c(P)}a=void 0}}).catch(()=>{})}catch(p){if(c)if(p instanceof Error){const d=p;c(d.name+": "+d.message)}else c(p)}}leave(s,r){return new Promise((a,c)=>{try{t.Contracts.throwIfNullOrUndefined(s,this.privErrors.invalidArgs.replace("{arg}","config")),t.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","token"));const p=s.getProperty(i.PropertyId.ConversationTranslator_Host,this.privHost),d=s.getProperty(i.PropertyId.ConversationTranslator_CorrelationId),l={};l[this.privRequestParams.apiVersion]=this.privApiVersion,l[this.privRequestParams.sessionToken]=r;const h={};d&&(h[this.privRequestParams.correlationId]=d);const g={};g.headers=h,this.privRestAdapter.options=g;const f=`https://${p}${this.privRestPath}`;this.privRestAdapter.request(e.RestRequestType.Delete,f,l,null).then(m=>{m.ok,a()}).catch(()=>{})}catch(p){if(p instanceof Error){const d=p;c(d.name+": "+d.message)}else c(p)}})}};return li.ConversationManager=n,li}var we={},fi={},gi={},mi={},Wu;function hd(){if(Wu)return mi;Wu=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.ConversationConnectionMessage=void 0;const e=b();let t=class extends e.ConnectionMessage{constructor(u,n,o,s){super(u,n,o,s);const r=JSON.parse(this.textBody);r.type!==void 0&&(this.privConversationMessageType=r.type)}get conversationMessageType(){return this.privConversationMessageType}};return mi.ConversationConnectionMessage=t,mi}var Hu;function hg(){if(Hu)return gi;Hu=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.ConversationWebsocketMessageFormatter=void 0;const e=b(),t=hd();let i=class{toConnectionMessage(n){const o=new e.Deferred;try{if(n.messageType===e.MessageType.Text){const s=new t.ConversationConnectionMessage(n.messageType,n.textContent,{},n.id);o.resolve(s)}else n.messageType===e.MessageType.Binary&&o.resolve(new t.ConversationConnectionMessage(n.messageType,n.binaryContent,void 0,n.id))}catch(s){o.reject(`Error formatting the message. Error: ${s}`)}return o.promise}fromConnectionMessage(n){const o=new e.Deferred;try{if(n.messageType===e.MessageType.Text){const s=`${n.textBody?n.textBody:""}`;o.resolve(new e.RawWebsocketMessage(e.MessageType.Text,s,n.id))}}catch(s){o.reject(`Error formatting the message. ${s}`)}return o.promise}};return gi.ConversationWebsocketMessageFormatter=i,gi}var Ku;function lg(){if(Ku)return fi;Ku=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.ConversationConnectionFactory=void 0;const e=U(),t=b(),i=D(),u=A(),n=se(),o=Is(),s=hg();let r=class extends n.ConnectionFactoryBase{create(c,p,d){const l=c.parameters.getProperty(u.PropertyId.ConversationTranslator_Host,o.ConversationConnectionConfig.host),h=c.parameters.getProperty(u.PropertyId.ConversationTranslator_CorrelationId,(0,t.createGuid)()),g=`wss://${l}${o.ConversationConnectionConfig.webSocketPath}`,f=c.parameters.getProperty(u.PropertyId.ConversationTranslator_Token,void 0);i.Contracts.throwIfNullOrUndefined(f,"token");const m={};m[o.ConversationConnectionConfig.configParams.apiVersion]=o.ConversationConnectionConfig.apiVersion,m[o.ConversationConnectionConfig.configParams.token]=f,m[o.ConversationConnectionConfig.configParams.correlationId]=h;const v=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new e.WebsocketConnection(g,m,{},new s.ConversationWebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(c),v,d))}};return fi.ConversationConnectionFactory=r,fi}var Si={},Ci={},Vu;function vg(){if(Vu)return Ci;Vu=1,Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.ConversationRequestSession=void 0;const e=b();let t=class{constructor(u){this.privIsDisposed=!1,this.privDetachables=new Array,this.privSessionId=u,this.privRequestId=(0,e.createNoDashGuid)(),this.privRequestCompletionDeferral=new e.Deferred}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get completionPromise(){return this.privRequestCompletionDeferral.promise}onPreConnectionStart(u,n){this.privSessionId=n}onAuthCompleted(u){u&&this.onComplete()}onConnectionEstablishCompleted(u){u!==200&&u===403&&this.onComplete()}onServiceTurnEndResponse(u){u?this.privRequestId=(0,e.createNoDashGuid)():this.onComplete()}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const u of this.privDetachables)await u.detach()}}onComplete(){}};return Ci.ConversationRequestSession=t,Ci}var F={},Ju;function ld(){if(Ju)return F;Ju=1,Object.defineProperty(F,"__esModule",{value:!0}),F.ConversationReceivedTranslationEventArgs=F.ParticipantsListEventArgs=F.ParticipantAttributeEventArgs=F.ParticipantEventArgs=F.LockRoomEventArgs=F.MuteAllEventArgs=void 0;const e=A();class t extends e.SessionEventArgs{constructor(a,c){super(c),this.privIsMuted=a}get isMuted(){return this.privIsMuted}}F.MuteAllEventArgs=t;class i extends e.SessionEventArgs{constructor(a,c){super(c),this.privIsLocked=a}get isMuted(){return this.privIsLocked}}F.LockRoomEventArgs=i;class u extends e.SessionEventArgs{constructor(a,c){super(c),this.privParticipant=a}get participant(){return this.privParticipant}}F.ParticipantEventArgs=u;class n extends e.SessionEventArgs{constructor(a,c,p,d){super(d),this.privKey=c,this.privValue=p,this.privParticipantId=a}get value(){return this.privValue}get key(){return this.privKey}get id(){return this.privParticipantId}}F.ParticipantAttributeEventArgs=n;class o extends e.SessionEventArgs{constructor(a,c,p,d,l,h,g,f,m){super(m),this.privRoomId=a,this.privSessionToken=c,this.privTranslateTo=p,this.privProfanityFilter=d,this.privRoomProfanityFilter=l,this.privIsRoomLocked=h,this.privIsRoomLocked=g,this.privParticipants=f}get sessionToken(){return this.privSessionToken}get conversationId(){return this.privRoomId}get translateTo(){return this.privTranslateTo}get profanityFilter(){return this.privProfanityFilter}get roomProfanityFilter(){return this.privRoomProfanityFilter}get isRoomLocked(){return this.privIsRoomLocked}get isMuteAll(){return this.privIsMuteAll}get participants(){return this.privParticipants}}F.ParticipantsListEventArgs=o;class s{constructor(a,c,p){this.privPayload=c,this.privCommand=a,this.privSessionId=p}get payload(){return this.privPayload}get command(){return this.privCommand}get sessionId(){return this.privSessionId}}return F.ConversationReceivedTranslationEventArgs=s,F}var ne={},Gu;function vd(){if(Gu)return ne;Gu=1,Object.defineProperty(ne,"__esModule",{value:!0}),ne.ConversationTranslatorCommandTypes=ne.ConversationTranslatorMessageTypes=ne.InternalParticipants=void 0;class e{constructor(i=[],u){this.participants=i,this.meId=u}addOrUpdateParticipant(i){if(i===void 0)return;const u=this.getParticipantIndex(i.id);return u>-1?this.participants.splice(u,1,i):this.participants.push(i),this.getParticipant(i.id)}getParticipantIndex(i){return this.participants.findIndex(u=>u.id===i)}getParticipant(i){return this.participants.find(u=>u.id===i)}deleteParticipant(i){this.participants=this.participants.filter(u=>u.id!==i)}get host(){return this.participants.find(i=>i.isHost===!0)}get me(){return this.getParticipant(this.meId)}}return ne.InternalParticipants=e,ne.ConversationTranslatorMessageTypes={command:"command",final:"final",info:"info",instantMessage:"instant_message",keepAlive:"keep_alive",partial:"partial",participantCommand:"participant_command",translatedMessage:"translated_message"},ne.ConversationTranslatorCommandTypes={changeNickname:"ChangeNickname",disconnectSession:"DisconnectSession",ejectParticipant:"EjectParticipant",instant_message:"instant_message",joinSession:"JoinSession",leaveSession:"LeaveSession",participantList:"ParticipantList",roomExpirationWarning:"RoomExpirationWarning",setLockState:"SetLockState",setMute:"SetMute",setMuteAll:"SetMuteAll",setProfanityFiltering:"SetProfanityFiltering",setTranslateToLanguages:"SetTranslateToLanguages",setUseTTS:"SetUseTTS"},ne}var rs={},yi={},Qu;function fg(){if(Qu)return yi;Qu=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.CommandResponsePayload=void 0;const e=i=>JSON.parse(i);let t=class fd{constructor(u){this.privCommandResponse=e(u)}get type(){return this.privCommandResponse.type}get command(){return this.privCommandResponse.command}get id(){return this.privCommandResponse.id}get nickname(){return this.privCommandResponse.nickname}get participantId(){return this.privCommandResponse.participantId}get roomid(){return this.privCommandResponse.roomid}get value(){return this.privCommandResponse.value}get token(){return this.privCommandResponse.token}static fromJSON(u){return new fd(u)}};return yi.CommandResponsePayload=t,yi}var _e={},Xu;function gg(){if(Xu)return _e;Xu=1,Object.defineProperty(_e,"__esModule",{value:!0}),_e.ParticipantPayloadResponse=_e.ParticipantsListPayloadResponse=void 0;const e=n=>JSON.parse(n),t=n=>JSON.parse(n);class i{constructor(o){this.privParticipantsPayloadResponse=e(o)}get roomid(){return this.privParticipantsPayloadResponse.roomid}get id(){return this.privParticipantsPayloadResponse.id}get command(){return this.privParticipantsPayloadResponse.command}get participants(){return this.privParticipantsPayloadResponse.participants}get token(){return this.privParticipantsPayloadResponse.token}get translateTo(){return this.privParticipantsPayloadResponse.translateTo}get profanityFilter(){return this.privParticipantsPayloadResponse.profanityFilter}get roomProfanityFilter(){return this.privParticipantsPayloadResponse.roomProfanityFilter}get roomLocked(){return this.privParticipantsPayloadResponse.roomLocked}get muteAll(){return this.privParticipantsPayloadResponse.muteAll}get type(){return this.privParticipantsPayloadResponse.type}static fromJSON(o){return new i(o)}}_e.ParticipantsListPayloadResponse=i;class u{constructor(o){this.privParticipantPayloadResponse=t(o)}get nickname(){return this.privParticipantPayloadResponse.nickname}get locale(){return this.privParticipantPayloadResponse.locale}get usetts(){return this.privParticipantPayloadResponse.usetts}get ismuted(){return this.privParticipantPayloadResponse.ismuted}get ishost(){return this.privParticipantPayloadResponse.ishost}get participantId(){return this.privParticipantPayloadResponse.participantId}get avatar(){return this.privParticipantPayloadResponse.avatar}static fromJSON(o){return new u(o)}}return _e.ParticipantPayloadResponse=u,_e}var be={},Zu;function mg(){if(Zu)return be;Zu=1,Object.defineProperty(be,"__esModule",{value:!0}),be.TextResponsePayload=be.SpeechResponsePayload=void 0;const e=n=>JSON.parse(n),t=n=>JSON.parse(n);class i{constructor(o){this.privSpeechResponse=e(o)}get recognition(){return this.privSpeechResponse.recognition}get translations(){return this.privSpeechResponse.translations}get id(){return this.privSpeechResponse.id}get language(){return this.privSpeechResponse.language}get nickname(){return this.privSpeechResponse.nickname}get participantId(){return this.privSpeechResponse.participantId}get roomid(){return this.privSpeechResponse.roomid}get timestamp(){return this.privSpeechResponse.timestamp}get type(){return this.privSpeechResponse.type}get isFinal(){return this.privSpeechResponse.type==="final"}static fromJSON(o){return new i(o)}}be.SpeechResponsePayload=i;class u{constructor(o){this.privTextResponse=t(o)}get originalText(){return this.privTextResponse.originalText}get translations(){return this.privTextResponse.translations}get id(){return this.privTextResponse.id}get language(){return this.privTextResponse.language}get nickname(){return this.privTextResponse.nickname}get participantId(){return this.privTextResponse.participantId}get roomid(){return this.privTextResponse.roomid}get timestamp(){return this.privTextResponse.timestamp}get type(){return this.privTextResponse.type}static fromJSON(o){return new u(o)}}return be.TextResponsePayload=u,be}var Yu;function Sg(){return Yu||(Yu=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TextResponsePayload=e.SpeechResponsePayload=e.ParticipantPayloadResponse=e.ParticipantsListPayloadResponse=e.CommandResponsePayload=void 0;var t=fg();Object.defineProperty(e,"CommandResponsePayload",{enumerable:!0,get:function(){return t.CommandResponsePayload}});var i=gg();Object.defineProperty(e,"ParticipantsListPayloadResponse",{enumerable:!0,get:function(){return i.ParticipantsListPayloadResponse}}),Object.defineProperty(e,"ParticipantPayloadResponse",{enumerable:!0,get:function(){return i.ParticipantPayloadResponse}});var u=mg();Object.defineProperty(e,"SpeechResponsePayload",{enumerable:!0,get:function(){return u.SpeechResponsePayload}}),Object.defineProperty(e,"TextResponsePayload",{enumerable:!0,get:function(){return u.TextResponsePayload}})})(rs)),rs}var $u;function Cg(){if($u)return Si;$u=1,Object.defineProperty(Si,"__esModule",{value:!0}),Si.ConversationServiceAdapter=void 0;const e=b(),t=A(),i=w(),u=hd(),n=vg(),o=ld(),s=vd(),r=Sg();let a=class extends i.ServiceRecognizerBase{constructor(p,d,l,h,g){super(p,d,l,h,g),this.privConnectionConfigPromise=void 0,this.privLastPartialUtteranceId="",this.privConversationServiceConnector=g,this.privConversationAuthentication=p,this.receiveMessageOverride=()=>this.receiveConversationMessageOverride(),this.recognizeOverride=()=>this.noOp(),this.postConnectImplOverride=f=>this.conversationConnectImpl(f),this.configConnectionOverride=()=>this.configConnection(),this.disconnectOverride=()=>this.privDisconnect(),this.privConversationRequestSession=new n.ConversationRequestSession((0,e.createNoDashGuid)()),this.privConversationConnectionFactory=d,this.privConversationIsDisposed=!1}isDisposed(){return super.isDisposed()||this.privConversationIsDisposed}async dispose(p){this.privConversationIsDisposed=!0,this.privConnectionConfigPromise!==void 0&&await(await this.privConnectionConfigPromise).dispose(p),await super.dispose(p)}async sendMessage(p){return(await this.fetchConnection()).send(new u.ConversationConnectionMessage(e.MessageType.Text,p))}async sendMessageAsync(p){await(await this.fetchConnection()).send(new u.ConversationConnectionMessage(e.MessageType.Text,p))}privDisconnect(){if(!this.terminateMessageLoop)return this.cancelRecognition(this.privConversationRequestSession.sessionId,this.privConversationRequestSession.requestId,t.CancellationReason.Error,t.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,Promise.resolve()}async processTypeSpecificMessages(){return!0}cancelRecognition(p,d,l,h,g){this.terminateMessageLoop=!0;const f=new t.ConversationTranslationCanceledEventArgs(l,g,h,void 0,p);try{this.privConversationServiceConnector.canceled&&this.privConversationServiceConnector.canceled(this.privConversationServiceConnector,f)}catch{}}async conversationConnectImpl(p){return this.privConnectionLoop=this.startMessageLoop(),p}async receiveConversationMessageOverride(){if(this.isDisposed()||this.terminateMessageLoop)return Promise.resolve();const p=new e.Deferred;try{const l=await(await this.fetchConnection()).read();if(this.isDisposed()||this.terminateMessageLoop)return p.resolve(),Promise.resolve();if(!l)return this.receiveConversationMessageOverride();const h=this.privConversationRequestSession.sessionId,g=l.conversationMessageType.toLowerCase();let f=!1;try{switch(g){case"info":case"participant_command":case"command":const m=r.CommandResponsePayload.fromJSON(l.textBody);switch(m.command.toLowerCase()){case"participantlist":const T=r.ParticipantsListPayloadResponse.fromJSON(l.textBody),E=T.participants.map(_=>({avatar:_.avatar,displayName:_.nickname,id:_.participantId,isHost:_.ishost,isMuted:_.ismuted,isUsingTts:_.usetts,preferredLanguage:_.locale}));this.privConversationServiceConnector.participantsListReceived&&this.privConversationServiceConnector.participantsListReceived(this.privConversationServiceConnector,new o.ParticipantsListEventArgs(T.roomid,T.token,T.translateTo,T.profanityFilter,T.roomProfanityFilter,T.roomLocked,T.muteAll,E,h));break;case"settranslatetolanguages":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new o.ParticipantAttributeEventArgs(m.participantId,s.ConversationTranslatorCommandTypes.setTranslateToLanguages,m.value,h));break;case"setprofanityfiltering":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new o.ParticipantAttributeEventArgs(m.participantId,s.ConversationTranslatorCommandTypes.setProfanityFiltering,m.value,h));break;case"setmute":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new o.ParticipantAttributeEventArgs(m.participantId,s.ConversationTranslatorCommandTypes.setMute,m.value,h));break;case"setmuteall":this.privConversationServiceConnector.muteAllCommandReceived&&this.privConversationServiceConnector.muteAllCommandReceived(this.privConversationServiceConnector,new o.MuteAllEventArgs(m.value,h));break;case"roomexpirationwarning":this.privConversationServiceConnector.conversationExpiration&&this.privConversationServiceConnector.conversationExpiration(this.privConversationServiceConnector,new t.ConversationExpirationEventArgs(m.value,this.privConversationRequestSession.sessionId));break;case"setusetts":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new o.ParticipantAttributeEventArgs(m.participantId,s.ConversationTranslatorCommandTypes.setUseTTS,m.value,h));break;case"setlockstate":this.privConversationServiceConnector.lockRoomCommandReceived&&this.privConversationServiceConnector.lockRoomCommandReceived(this.privConversationServiceConnector,new o.LockRoomEventArgs(m.value,h));break;case"changenickname":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new o.ParticipantAttributeEventArgs(m.participantId,s.ConversationTranslatorCommandTypes.changeNickname,m.value,h));break;case"joinsession":const P=r.ParticipantPayloadResponse.fromJSON(l.textBody),I={avatar:P.avatar,displayName:P.nickname,id:P.participantId,isHost:P.ishost,isMuted:P.ismuted,isUsingTts:P.usetts,preferredLanguage:P.locale};this.privConversationServiceConnector.participantJoinCommandReceived&&this.privConversationServiceConnector.participantJoinCommandReceived(this.privConversationServiceConnector,new o.ParticipantEventArgs(I,h));break;case"leavesession":const M={id:m.participantId};this.privConversationServiceConnector.participantLeaveCommandReceived&&this.privConversationServiceConnector.participantLeaveCommandReceived(this.privConversationServiceConnector,new o.ParticipantEventArgs(M,h));break;case"disconnectsession":const k={id:m.participantId};break;case"token":const ee=new i.CognitiveTokenAuthentication(()=>{const _=m.token;return Promise.resolve(_)},()=>{const _=m.token;return Promise.resolve(_)});this.authentication=ee,this.privConversationServiceConnector.onToken(ee);break;default:break}break;case"partial":case"final":const v=r.SpeechResponsePayload.fromJSON(l.textBody),S=g==="final"?t.ResultReason.TranslatedParticipantSpeech:t.ResultReason.TranslatingParticipantSpeech,C=new t.ConversationTranslationResult(v.participantId,this.getTranslations(v.translations),v.language,v.id,S,v.recognition,void 0,void 0,l.textBody,void 0);v.isFinal?((C.text!==void 0&&C.text.length>0||v.id===this.privLastPartialUtteranceId)&&(f=!0),f&&this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new o.ConversationReceivedTranslationEventArgs(s.ConversationTranslatorMessageTypes.final,C,h))):C.text!==void 0&&(this.privLastPartialUtteranceId=v.id,this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new o.ConversationReceivedTranslationEventArgs(s.ConversationTranslatorMessageTypes.partial,C,h)));break;case"translated_message":const y=r.TextResponsePayload.fromJSON(l.textBody),R=new t.ConversationTranslationResult(y.participantId,this.getTranslations(y.translations),y.language,void 0,void 0,y.originalText,void 0,void 0,void 0,l.textBody,void 0);this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new o.ConversationReceivedTranslationEventArgs(s.ConversationTranslatorMessageTypes.instantMessage,R,h));break;default:break}}catch{}return this.receiveConversationMessageOverride()}catch{this.terminateMessageLoop=!0}return p.promise}async startMessageLoop(){if(this.isDisposed())return Promise.resolve();this.terminateMessageLoop=!1;const p=this.receiveConversationMessageOverride();try{return await p}catch(d){return this.cancelRecognition(this.privRequestSession?this.privRequestSession.sessionId:"",this.privRequestSession?this.privRequestSession.requestId:"",t.CancellationReason.Error,t.CancellationErrorCode.RuntimeError,d),null}}configConnection(){return this.isDisposed()?Promise.resolve(void 0):this.privConnectionConfigPromise!==void 0?this.privConnectionConfigPromise.then(p=>p.state()===e.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection()):this.privConnectionConfigPromise,()=>(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection())):this.terminateMessageLoop?Promise.resolve(void 0):(this.privConnectionConfigPromise=this.connectImpl().then(p=>p),this.privConnectionConfigPromise)}getTranslations(p){let d;if(p!==void 0){d=new t.Translations;for(const l of p)d.set(l.lang,l.translation)}return d}};return Si.ConversationServiceAdapter=a,Si}var ep;function yg(){if(ep)return we;ep=1,Object.defineProperty(we,"__esModule",{value:!0}),we.ConversationTranslatorRecognizer=we.ConversationRecognizerFactory=void 0;const e=w(),t=b(),i=D(),u=A(),n=lg(),o=Cg();class s{static fromConfig(c,p,d){return new r(c,p,d)}}we.ConversationRecognizerFactory=s;let r=class extends u.Recognizer{constructor(c,p,d){const l=p;i.Contracts.throwIfNull(l,"speechConfig");const h=c;i.Contracts.throwIfNull(h,"conversationImpl"),super(d,l.properties,new n.ConversationConnectionFactory),this.privConversation=h,this.privIsDisposed=!1,this.privProperties=l.properties.clone(),this.privConnection=u.Connection.fromRecognizer(this),this.privProperties.getProperty(u.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?(this.privSetTimeout=t.Timeout.setTimeout,this.privClearTimeout=t.Timeout.clearTimeout):typeof window<"u"?(this.privSetTimeout=window.setTimeout.bind(window),this.privClearTimeout=window.clearTimeout.bind(window)):(this.privSetTimeout=setTimeout,this.privClearTimeout=clearTimeout)}set connected(c){this.privConnection.connected=c}set disconnected(c){this.privConnection.disconnected=c}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get properties(){return this.privProperties}isDisposed(){return this.privIsDisposed}connect(c,p,d){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfNullOrWhitespace(c,"token"),this.privReco.conversationTranslatorToken=c,this.resetConversationTimeout(),this.privReco.connectAsync(p,d)}catch(l){if(d)if(l instanceof Error){const h=l;d(h.name+": "+h.message)}else d(l)}}disconnect(c,p){try{i.Contracts.throwIfDisposed(this.privIsDisposed),this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privReco.disconnect().then(()=>{c&&c()},d=>{p&&p(d)})}catch(d){if(p)if(d instanceof Error){const l=d;p(l.name+": "+l.message)}else p(d);this.dispose(!0).catch(l=>{t.Events.instance.onEvent(new t.BackgroundEvent(l))})}}sendRequest(c,p,d){try{i.Contracts.throwIfDisposed(this.privIsDisposed),this.sendMessage(c,p,d)}catch(l){if(d)if(l instanceof Error){const h=l;d(h.name+": "+h.message)}else d(l);this.dispose(!0).catch(h=>{t.Events.instance.onEvent(new t.BackgroundEvent(h))})}}onToken(c){this.privConversation.onToken(c)}async close(){this.privIsDisposed||(this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close()),this.privConnection=void 0,await this.dispose(!0))}async dispose(c){this.privIsDisposed||c&&(this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privIsDisposed=!0,this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close(),this.privConnection=void 0),await super.dispose(c))}createRecognizerConfig(c){return new e.RecognizerConfig(c,this.privProperties)}createServiceRecognizer(c,p,d,l){const h=d;return new o.ConversationServiceAdapter(c,p,h,l,this)}sendMessage(c,p,d){const l=this.privReco;((g,f,m)=>{g!==void 0?g.then(()=>{try{f&&f()}catch(v){m&&m(`'Unhandled error on promise callback: ${v}'`)}},v=>{try{m&&m(v)}catch{}}):m&&m("Null promise")})(l.sendMessageAsync(c),p,d),this.resetConversationTimeout()}resetConversationTimeout(){this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privTimeoutToken=this.privSetTimeout(()=>{this.sendRequest(this.privConversation.getKeepAlive())},6e4)}};return we.ConversationTranslatorRecognizer=r,we}var Ri={},tp;function Rg(){if(tp)return Ri;tp=1,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.TranscriberRecognizer=void 0;const e=b(),t=D(),i=A(),u=w(),n=Y();let o=class extends i.Recognizer{constructor(r,a){const c=r;t.Contracts.throwIfNull(c,"speechTranslationConfig");const p=a;t.Contracts.throwIfNull(p,"audioConfigImpl"),t.Contracts.throwIfNullOrWhitespace(c.speechRecognitionLanguage,i.PropertyId[i.PropertyId.SpeechServiceConnection_RecoLanguage]),super(a,c.properties,new u.TranscriberConnectionFactory),this.privDisposedRecognizer=!1,this.isMeetingRecognizer=!1}get speechRecognitionLanguage(){return t.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(i.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(r){t.Contracts.throwIfNullOrWhitespace(r,"token"),this.properties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,r)}set conversation(r){t.Contracts.throwIfNullOrUndefined(r,"Conversation"),this.isMeetingRecognizer=!1,this.privConversation=r}getConversationInfo(){return t.Contracts.throwIfNullOrUndefined(this.privConversation,"Conversation"),this.privConversation.conversationInfo}set meeting(r){t.Contracts.throwIfNullOrUndefined(r,"Meeting"),this.isMeetingRecognizer=!0,this.privMeeting=r}getMeetingInfo(){return t.Contracts.throwIfNullOrUndefined(this.privMeeting,"Meeting"),this.privMeeting.meetingInfo}IsMeetingRecognizer(){return this.isMeetingRecognizer}startContinuousRecognitionAsync(r,a){(0,e.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(n.RecognitionMode.Conversation),r,a)}stopContinuousRecognitionAsync(r,a){(0,e.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),r,a)}async close(){this.privDisposedRecognizer||await this.dispose(!0)}async pushConversationEvent(r,a){const c=this.privReco;t.Contracts.throwIfNullOrUndefined(c,"serviceRecognizer"),await c.sendSpeechEventAsync(r,a)}async pushMeetingEvent(r,a){const c=this.privReco;t.Contracts.throwIfNullOrUndefined(c,"serviceRecognizer"),await c.sendMeetingSpeechEventAsync(r,a)}async enforceAudioGating(){const c=(await this.audioConfig.format).channels;if(c===1){if(this.properties.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()!=="true")throw new Error("Single channel audio configuration for MeetingTranscriber is currently under private preview, please contact diarizationrequest@microsoft.com for more details")}else if(c!==8)throw new Error(`Unsupported audio configuration: Detected ${c}-channel audio`)}connectMeetingCallbacks(r){this.isMeetingRecognizer=!0,this.canceled=(a,c)=>{r.canceled&&r.canceled(r,c)},this.recognizing=(a,c)=>{r.transcribing&&r.transcribing(r,c)},this.recognized=(a,c)=>{r.transcribed&&r.transcribed(r,c)},this.sessionStarted=(a,c)=>{r.sessionStarted&&r.sessionStarted(r,c)},this.sessionStopped=(a,c)=>{r.sessionStopped&&r.sessionStopped(r,c)}}disconnectCallbacks(){this.canceled=void 0,this.recognizing=void 0,this.recognized=void 0,this.sessionStarted=void 0,this.sessionStopped=void 0}async dispose(r){this.privDisposedRecognizer||(r&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(r))}createRecognizerConfig(r){return new u.RecognizerConfig(r,this.properties)}createServiceRecognizer(r,a,c,p){const d=c;return new u.TranscriptionServiceRecognizer(r,a,d,p,this)}};return Ri.TranscriberRecognizer=o,Ri}var rp;function Pg(){return rp||(rp=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.InternalParticipants=e.ConversationTranslatorMessageTypes=e.ConversationTranslatorCommandTypes=e.ParticipantsListEventArgs=e.ParticipantEventArgs=e.ParticipantAttributeEventArgs=e.MuteAllEventArgs=e.LockRoomEventArgs=e.ConversationReceivedTranslationEventArgs=e.TranscriberRecognizer=e.ConversationRecognizerFactory=e.ConversationConnectionConfig=e.ConversationManager=void 0;var t=dg();Object.defineProperty(e,"ConversationManager",{enumerable:!0,get:function(){return t.ConversationManager}});var i=Is();Object.defineProperty(e,"ConversationConnectionConfig",{enumerable:!0,get:function(){return i.ConversationConnectionConfig}});var u=yg();Object.defineProperty(e,"ConversationRecognizerFactory",{enumerable:!0,get:function(){return u.ConversationRecognizerFactory}});var n=Rg();Object.defineProperty(e,"TranscriberRecognizer",{enumerable:!0,get:function(){return n.TranscriberRecognizer}});var o=ld();Object.defineProperty(e,"ConversationReceivedTranslationEventArgs",{enumerable:!0,get:function(){return o.ConversationReceivedTranslationEventArgs}}),Object.defineProperty(e,"LockRoomEventArgs",{enumerable:!0,get:function(){return o.LockRoomEventArgs}}),Object.defineProperty(e,"MuteAllEventArgs",{enumerable:!0,get:function(){return o.MuteAllEventArgs}}),Object.defineProperty(e,"ParticipantAttributeEventArgs",{enumerable:!0,get:function(){return o.ParticipantAttributeEventArgs}}),Object.defineProperty(e,"ParticipantEventArgs",{enumerable:!0,get:function(){return o.ParticipantEventArgs}}),Object.defineProperty(e,"ParticipantsListEventArgs",{enumerable:!0,get:function(){return o.ParticipantsListEventArgs}});var s=vd();Object.defineProperty(e,"ConversationTranslatorCommandTypes",{enumerable:!0,get:function(){return s.ConversationTranslatorCommandTypes}}),Object.defineProperty(e,"ConversationTranslatorMessageTypes",{enumerable:!0,get:function(){return s.ConversationTranslatorMessageTypes}}),Object.defineProperty(e,"InternalParticipants",{enumerable:!0,get:function(){return s.InternalParticipants}})})(ts)),ts}var is={},ip;function gd(){return ip||(ip=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SynthesisAudioMetadata=e.MetadataType=void 0,(function(i){i.WordBoundary="WordBoundary",i.Bookmark="Bookmark",i.Viseme="Viseme",i.SentenceBoundary="SentenceBoundary",i.SessionEnd="SessionEnd",i.AvatarSignal="TalkingAvatarSignal"})(e.MetadataType||(e.MetadataType={}));class t{constructor(u){this.privSynthesisAudioMetadata=JSON.parse(u)}static fromJSON(u){return new t(u)}get Metadata(){return this.privSynthesisAudioMetadata.Metadata}}e.SynthesisAudioMetadata=t})(is)),is}var Pi={},X={},np;function Eg(){if(np)return X;np=1,Object.defineProperty(X,"__esModule",{value:!0}),X.SynthesisStartedEvent=X.ConnectingToSynthesisServiceEvent=X.SynthesisTriggeredEvent=X.SpeechSynthesisEvent=void 0;const e=b();class t extends e.PlatformEvent{constructor(s,r,a=e.EventType.Info){super(s,a),this.privRequestId=r}get requestId(){return this.privRequestId}}X.SpeechSynthesisEvent=t;class i extends t{constructor(s,r,a){super("SynthesisTriggeredEvent",s),this.privSessionAudioDestinationId=r,this.privTurnAudioDestinationId=a}get audioSessionDestinationId(){return this.privSessionAudioDestinationId}get audioTurnDestinationId(){return this.privTurnAudioDestinationId}}X.SynthesisTriggeredEvent=i;class u extends t{constructor(s,r){super("ConnectingToSynthesisServiceEvent",s),this.privAuthFetchEventId=r}get authFetchEventId(){return this.privAuthFetchEventId}}X.ConnectingToSynthesisServiceEvent=u;class n extends t{constructor(s,r){super("SynthesisStartedEvent",s),this.privAuthFetchEventId=r}get authFetchEventId(){return this.privAuthFetchEventId}}return X.SynthesisStartedEvent=n,X}var sp;function Tg(){if(sp)return Pi;sp=1,Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.SynthesisTurn=void 0;const e=b(),t=Le(),i=A(),u=gd(),n=Eg();let o=class ms{constructor(){this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privInTurn=!1,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privRequestId=(0,e.createNoDashGuid)(),this.privTurnDeferral=new e.Deferred,this.privTurnDeferral.resolve()}get requestId(){return this.privRequestId}get streamId(){return this.privStreamId}set streamId(r){this.privStreamId=r}get audioOutputFormat(){return this.privAudioOutputFormat}set audioOutputFormat(r){this.privAudioOutputFormat=r}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSynthesisEnded(){return this.privIsSynthesisEnded}get isSynthesizing(){return this.privIsSynthesizing}get currentTextOffset(){return this.privTextOffset}get currentSentenceOffset(){return this.privSentenceOffset}get bytesReceived(){return this.privBytesReceived}get audioDuration(){return this.privAudioDuration}get extraProperties(){if(this.privWebRTCSDP){const r=new i.PropertyCollection;return r.setProperty(i.PropertyId.TalkingAvatarService_WebRTC_SDP,this.privWebRTCSDP),r}}async getAllReceivedAudio(){return this.privReceivedAudio?Promise.resolve(this.privReceivedAudio):this.privIsSynthesisEnded?(await this.readAllAudioFromStream(),Promise.resolve(this.privReceivedAudio)):null}async getAllReceivedAudioWithHeader(){if(this.privReceivedAudioWithHeader)return this.privReceivedAudioWithHeader;if(!this.privIsSynthesisEnded)return null;if(this.audioOutputFormat.hasHeader){const r=await this.getAllReceivedAudio();return this.privReceivedAudioWithHeader=this.audioOutputFormat.addHeader(r),this.privReceivedAudioWithHeader}else return this.getAllReceivedAudio()}startNewSynthesis(r,a,c,p){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=r,this.privRawText=a,this.privIsSSML=c,this.privAudioOutputStream=new t.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privPartialVisemeAnimation="",this.privWebRTCSDP="",p!==void 0&&(this.privTurnAudioDestination=p,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new n.SynthesisTriggeredEvent(this.requestId,void 0,p===void 0?void 0:p.id()))}onPreConnectionStart(r){this.privAuthFetchEventId=r,this.onEvent(new n.ConnectingToSynthesisServiceEvent(this.privRequestId,this.privAuthFetchEventId))}onAuthCompleted(r){r&&this.onComplete()}onConnectionEstablishCompleted(r){if(r===200){this.onEvent(new n.SynthesisStartedEvent(this.requestId,this.privAuthFetchEventId)),this.privBytesReceived=0;return}else r===403&&this.onComplete()}onServiceResponseMessage(r){const a=JSON.parse(r);this.streamId=a.audio.streamId}onServiceTurnEndResponse(){this.privInTurn=!1,this.privTurnDeferral.resolve(),this.onComplete()}onServiceTurnStartResponse(r){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new e.Deferred;const a=JSON.parse(r);a.webrtc&&(this.privWebRTCSDP=a.webrtc.connectionString)}onAudioChunkReceived(r){this.isSynthesizing&&(this.privAudioOutputStream.write(r),this.privBytesReceived+=r.byteLength,this.privTurnAudioDestination!==void 0&&this.privTurnAudioDestination.write(r))}onTextBoundaryEvent(r){this.updateTextOffset(r.Data.text.Text,r.Type)}onVisemeMetadataReceived(r){r.Data.AnimationChunk!==void 0&&(this.privPartialVisemeAnimation+=r.Data.AnimationChunk)}onSessionEnd(r){this.privAudioDuration=r.Data.Offset}async constructSynthesisResult(){const r=await this.getAllReceivedAudioWithHeader();return new i.SpeechSynthesisResult(this.requestId,i.ResultReason.SynthesizingAudioCompleted,r,void 0,this.extraProperties,this.audioDuration)}dispose(){this.privIsDisposed||(this.privIsDisposed=!0)}onStopSynthesizing(){this.onComplete()}getAndClearVisemeAnimation(){const r=this.privPartialVisemeAnimation;return this.privPartialVisemeAnimation="",r}onEvent(r){e.Events.instance.onEvent(r)}static isXmlTag(r){return r.length>=2&&r[0]==="<"&&r[r.length-1]===">"}updateTextOffset(r,a){a===u.MetadataType.WordBoundary?(this.privTextOffset=this.privRawText.indexOf(r,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+r.length,this.privIsSSML&&this.withinXmlTag(this.privTextOffset)&&!ms.isXmlTag(r)&&this.updateTextOffset(r,a))):(this.privSentenceOffset=this.privRawText.indexOf(r,this.privNextSearchSentenceIndex),this.privSentenceOffset>=0&&(this.privNextSearchSentenceIndex=this.privSentenceOffset+r.length,this.privIsSSML&&this.withinXmlTag(this.privSentenceOffset)&&!ms.isXmlTag(r)&&this.updateTextOffset(r,a)))}onComplete(){this.privIsSynthesizing&&(this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!0,this.privAudioOutputStream.close(),this.privInTurn=!1,this.privTurnAudioDestination!==void 0&&(this.privTurnAudioDestination.close(),this.privTurnAudioDestination=void 0))}async readAllAudioFromStream(){if(this.privIsSynthesisEnded){this.privReceivedAudio=new ArrayBuffer(this.bytesReceived);try{await this.privAudioOutputStream.read(this.privReceivedAudio)}catch{this.privReceivedAudio=new ArrayBuffer(0)}}}withinXmlTag(r){return this.privRawText.indexOf("<",r+1)>this.privRawText.indexOf(">",r+1)}};return Pi.SynthesisTurn=o,Pi}var Ei={},op;function Ag(){if(op)return Ei;op=1,Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.SynthesisAdapterBase=void 0;const e=b(),t=A(),i=w(),u=xi();let n=class{constructor(s,r,a,c){if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.privConnectionConfigurationPromise=void 0,!s)throw new e.ArgumentNullError("authentication");if(!r)throw new e.ArgumentNullError("connectionFactory");if(!a)throw new e.ArgumentNullError("synthesizerConfig");this.privAuthentication=s,this.privConnectionFactory=r,this.privSynthesizerConfig=a,this.privIsDisposed=!1,this.privSessionAudioDestination=c,this.privSynthesisTurn=new i.SynthesisTurn,this.privConnectionEvents=new e.EventSource,this.privServiceEvents=new e.EventSource,this.privSynthesisContext=new i.SynthesisContext,this.privAgentConfig=new i.AgentConfig,this.connectionEvents.attach(p=>{if(p.name==="ConnectionClosedEvent"){const d=p;d.statusCode!==1e3&&this.cancelSynthesisLocal(t.CancellationReason.Error,d.statusCode===1007?t.CancellationErrorCode.BadRequestParameters:t.CancellationErrorCode.ConnectionFailure,`${d.reason} websocket error code: ${d.statusCode}`)}})}get synthesizerConfig(){return this.privSynthesizerConfig}get synthesisContext(){return this.privSynthesisContext}get agentConfig(){return this.privAgentConfig}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}set activityTemplate(s){this.privActivityTemplate=s}get activityTemplate(){return this.privActivityTemplate}set audioOutputFormat(s){this.privAudioOutputFormat=s,this.privSynthesisTurn.audioOutputFormat=s,this.privSessionAudioDestination!==void 0&&(this.privSessionAudioDestination.format=s),this.synthesisContext!==void 0&&(this.synthesisContext.audioOutputFormat=s)}isDisposed(){return this.privIsDisposed}async dispose(s){this.privIsDisposed=!0,this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.close(),this.privConnectionConfigurationPromise!==void 0&&await(await this.privConnectionConfigurationPromise).dispose(s)}async connect(){await this.connectImpl()}async sendNetworkMessage(s,r){const a=typeof r=="string"?e.MessageType.Text:e.MessageType.Binary,c=typeof r=="string"?"application/json":"";return(await this.fetchConnection()).send(new u.SpeechConnectionMessage(a,s,this.privSynthesisTurn.requestId,c,r))}async Speak(s,r,a,c,p,d){let l;if(r?l=s:l=this.privSynthesizer.buildSsml(s),this.speakOverride!==void 0)return this.speakOverride(l,a,c,p);this.privSuccessCallback=c,this.privErrorCallback=p,this.privSynthesisTurn.startNewSynthesis(a,s,r,d);try{await this.connectImpl();const h=await this.fetchConnection();await this.sendSynthesisContext(h),await this.sendSsmlMessage(h,l,a),this.onSynthesisStarted(a),this.receiveMessage()}catch(h){return this.cancelSynthesisLocal(t.CancellationReason.Error,t.CancellationErrorCode.ConnectionFailure,h),Promise.reject(h)}}async stopSpeaking(){return await this.connectImpl(),(await this.fetchConnection()).send(new u.SpeechConnectionMessage(e.MessageType.Text,"synthesis.control",this.privSynthesisTurn.requestId,"application/json",JSON.stringify({action:"stop"})))}cancelSynthesis(s,r,a,c){const p=new t.PropertyCollection;p.setProperty(i.CancellationErrorCodePropertyName,t.CancellationErrorCode[a]);const d=new t.SpeechSynthesisResult(s,t.ResultReason.Canceled,void 0,c,p);if(this.onSynthesisCancelled(d),this.privSuccessCallback)try{this.privSuccessCallback(d)}catch{}}cancelSynthesisLocal(s,r,a){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,s,r,a))}processTypeSpecificMessages(s){return!0}async receiveMessage(){try{const r=await(await this.fetchConnection()).read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(this.privIsDisposed)return;if(!r)return this.privSynthesisTurn.isSynthesizing?this.receiveMessage():void 0;const a=u.SpeechConnectionMessage.fromConnectionMessage(r);if(a.requestId.toLowerCase()===this.privSynthesisTurn.requestId.toLowerCase())switch(a.path.toLowerCase()){case"turn.start":this.privSynthesisTurn.onServiceTurnStartResponse(a.textBody);break;case"response":this.privSynthesisTurn.onServiceResponseMessage(a.textBody);break;case"audio":this.privSynthesisTurn.streamId.toLowerCase()===a.streamId.toLowerCase()&&a.binaryBody&&(this.privSynthesisTurn.onAudioChunkReceived(a.binaryBody),this.onSynthesizing(a.binaryBody),this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.write(a.binaryBody));break;case"audio.metadata":const c=i.SynthesisAudioMetadata.fromJSON(a.textBody).Metadata;for(const d of c)switch(d.Type){case i.MetadataType.WordBoundary:case i.MetadataType.SentenceBoundary:this.privSynthesisTurn.onTextBoundaryEvent(d);const l=new t.SpeechSynthesisWordBoundaryEventArgs(d.Data.Offset,d.Data.Duration,d.Data.text.Text,d.Data.text.Length,d.Type===i.MetadataType.WordBoundary?this.privSynthesisTurn.currentTextOffset:this.privSynthesisTurn.currentSentenceOffset,d.Data.text.BoundaryType);this.onWordBoundary(l);break;case i.MetadataType.Bookmark:const h=new t.SpeechSynthesisBookmarkEventArgs(d.Data.Offset,d.Data.Bookmark);this.onBookmarkReached(h);break;case i.MetadataType.Viseme:if(this.privSynthesisTurn.onVisemeMetadataReceived(d),d.Data.IsLastAnimation){const g=new t.SpeechSynthesisVisemeEventArgs(d.Data.Offset,d.Data.VisemeId,this.privSynthesisTurn.getAndClearVisemeAnimation());this.onVisemeReceived(g)}break;case i.MetadataType.AvatarSignal:this.onAvatarEvent(d);break;case i.MetadataType.SessionEnd:this.privSynthesisTurn.onSessionEnd(d);break}break;case"turn.end":this.privSynthesisTurn.onServiceTurnEndResponse();let p;try{p=await this.privSynthesisTurn.constructSynthesisResult(),this.privSuccessCallback&&this.privSuccessCallback(p)}catch(d){this.privErrorCallback&&this.privErrorCallback(d)}this.onSynthesisCompleted(p);break;default:this.processTypeSpecificMessages(a)||this.privServiceEvents&&this.serviceEvents.onEvent(new e.ServiceEvent(a.path.toLowerCase(),a.textBody))}return this.receiveMessage()}catch{}}sendSynthesisContext(s){this.setSynthesisContextSynthesisSection();const r=this.synthesisContext.toJSON();if(r)return s.send(new u.SpeechConnectionMessage(e.MessageType.Text,"synthesis.context",this.privSynthesisTurn.requestId,"application/json",r))}setSpeechConfigSynthesisSection(){}connectImpl(s=!1){if(this.privConnectionPromise!=null)return this.privConnectionPromise.then(a=>a.state()===e.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()));this.privAuthFetchEventId=(0,e.createNoDashGuid)(),this.privConnectionId=(0,e.createNoDashGuid)(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId);const r=s?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=r.then(async a=>{this.privSynthesisTurn.onAuthCompleted(!1);const c=await this.privConnectionFactory.create(this.privSynthesizerConfig,a,this.privConnectionId);c.events.attach(d=>{this.connectionEvents.onEvent(d)});const p=await c.open();return p.statusCode===200?(this.privSynthesisTurn.onConnectionEstablishCompleted(p.statusCode),Promise.resolve(c)):p.statusCode===403&&!s?this.connectImpl(!0):(this.privSynthesisTurn.onConnectionEstablishCompleted(p.statusCode),Promise.reject(`Unable to contact server. StatusCode: ${p.statusCode},
                    ${this.privSynthesizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Url)} Reason: ${p.reason}`))},a=>{throw this.privSynthesisTurn.onAuthCompleted(!0),new Error(a)}),this.privConnectionPromise.catch(()=>{}),this.privConnectionPromise}sendSpeechServiceConfig(s,r){if(r)return s.send(new u.SpeechConnectionMessage(e.MessageType.Text,"speech.config",this.privSynthesisTurn.requestId,"application/json",r))}sendSsmlMessage(s,r,a){return s.send(new u.SpeechConnectionMessage(e.MessageType.Text,"ssml",a,"application/ssml+xml",r))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(s=>s.state()===e.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async configureConnection(){const s=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(s):(this.setSpeechConfigSynthesisSection(),await this.sendSpeechServiceConfig(s,this.privSynthesizerConfig.SpeechServiceConfig.serialize()),s)}onAvatarEvent(s){}onSynthesisStarted(s){}onSynthesizing(s){}onSynthesisCancelled(s){}onSynthesisCompleted(s){}onWordBoundary(s){}onVisemeReceived(s){}onBookmarkReached(s){}};return Ei.SynthesisAdapterBase=n,n.telemetryDataEnabled=!0,Ei}var Ti={},ap;function Ig(){if(ap)return Ti;ap=1,Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.AvatarSynthesisAdapter=void 0;const e=A(),t=w();let i=class extends t.SynthesisAdapterBase{constructor(n,o,s,r,a){super(n,o,s,void 0),this.privAvatarSynthesizer=r,this.privSynthesizer=r,this.privAvatarConfig=a}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(void 0)}setSpeechConfigSynthesisSection(){var n,o,s,r,a,c,p,d,l,h,g,f,m,v,S,C,y;this.privSynthesizerConfig.synthesisVideoSection={format:{bitrate:(n=this.privAvatarConfig.videoFormat)==null?void 0:n.bitrate,codec:(o=this.privAvatarConfig.videoFormat)==null?void 0:o.codec,crop:{bottomRight:{x:(a=(r=(s=this.privAvatarConfig.videoFormat)==null?void 0:s.cropRange)==null?void 0:r.bottomRight)==null?void 0:a.x,y:(d=(p=(c=this.privAvatarConfig.videoFormat)==null?void 0:c.cropRange)==null?void 0:p.bottomRight)==null?void 0:d.y},topLeft:{x:(g=(h=(l=this.privAvatarConfig.videoFormat)==null?void 0:l.cropRange)==null?void 0:h.topLeft)==null?void 0:g.x,y:(v=(m=(f=this.privAvatarConfig.videoFormat)==null?void 0:f.cropRange)==null?void 0:m.topLeft)==null?void 0:v.y}},resolution:{height:(S=this.privAvatarConfig.videoFormat)==null?void 0:S.height,width:(C=this.privAvatarConfig.videoFormat)==null?void 0:C.width}},protocol:{name:"WebRTC",webrtcConfig:{clientDescription:btoa(this.privSynthesizerConfig.parameters.getProperty(e.PropertyId.TalkingAvatarService_WebRTC_SDP)),iceServers:this.privAvatarConfig.remoteIceServers??this.privAvatarSynthesizer.iceServers}},talkingAvatar:{background:{color:this.privAvatarConfig.backgroundColor,image:{url:(y=this.privAvatarConfig.backgroundImage)==null?void 0:y.toString()}},character:this.privAvatarConfig.character,customized:this.privAvatarConfig.customized,photoAvatarBaseModel:this.privAvatarConfig.photoAvatarBaseModel,style:this.privAvatarConfig.style,useBuiltInVoice:this.privAvatarConfig.useBuiltInVoice}}}onAvatarEvent(n){if(this.privAvatarSynthesizer.avatarEventReceived){const o=new e.AvatarEventArgs(n.Data.Offset,n.Data.Name);try{this.privAvatarSynthesizer.avatarEventReceived(this.privAvatarSynthesizer,o)}catch{}}}};return Ti.AvatarSynthesisAdapter=i,Ti}var Ai={},cp;function wg(){if(cp)return Ai;cp=1,Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.SpeechSynthesisAdapter=void 0;const e=A(),t=w();let i=class extends t.SynthesisAdapterBase{constructor(n,o,s,r,a){super(n,o,s,a),this.privSpeechSynthesizer=r,this.privSynthesizer=r}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(this.privSpeechSynthesizer)}onSynthesisStarted(n){const o=new e.SpeechSynthesisEventArgs(new e.SpeechSynthesisResult(n,e.ResultReason.SynthesizingAudioStarted));this.privSpeechSynthesizer.synthesisStarted&&this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer,o)}onSynthesizing(n){if(this.privSpeechSynthesizer.synthesizing)try{const o=this.privSynthesisTurn.audioOutputFormat.addHeader(n),s=new e.SpeechSynthesisEventArgs(new e.SpeechSynthesisResult(this.privSynthesisTurn.requestId,e.ResultReason.SynthesizingAudio,o));this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer,s)}catch{}}onSynthesisCancelled(n){if(this.privSpeechSynthesizer.SynthesisCanceled){const o=new e.SpeechSynthesisEventArgs(n);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,o)}catch{}}}onSynthesisCompleted(n){if(this.privSpeechSynthesizer.synthesisCompleted)try{this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer,new e.SpeechSynthesisEventArgs(n))}catch{}}onWordBoundary(n){if(this.privSpeechSynthesizer.wordBoundary)try{this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer,n)}catch{}}onVisemeReceived(n){if(this.privSpeechSynthesizer.visemeReceived)try{this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer,n)}catch{}}onBookmarkReached(n){if(this.privSpeechSynthesizer.bookmarkReached)try{this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer,n)}catch{}}};return Ai.SpeechSynthesisAdapter=i,Ai}var Ii={},up;function _g(){if(up)return Ii;up=1,Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.SynthesisRestAdapter=void 0;const e=U(),t=A(),i=se(),u=V();let n=class{constructor(s,r){let a=s.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);if(!a){const p=s.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,"westus"),d=i.ConnectionFactoryBase.getHostSuffix(p);a=s.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,`https://${p}.tts.speech${d}`)}this.privUri=`${a}/cognitiveservices/voices/list`;const c=e.RestConfigBase.requestOptions;this.privRestAdapter=new e.RestMessageAdapter(c),this.privAuthentication=r}getVoicesList(s){return this.privRestAdapter.setHeaders(u.HeaderNames.ConnectionId,s),this.privAuthentication.fetch(s).then(r=>(this.privRestAdapter.setHeaders(r.headerName,r.token),this.privRestAdapter.request(e.RestRequestType.Get,this.privUri)))}};return Ii.SynthesisRestAdapter=n,Ii}var ns={},pp;function bg(){return pp||(pp=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SynthesizerConfig=e.SynthesisServiceType=void 0;const t=w();var i;(function(n){n[n.Standard=0]="Standard",n[n.Custom=1]="Custom"})(i=e.SynthesisServiceType||(e.SynthesisServiceType={}));class u{constructor(o,s){this.privSynthesisServiceType=i.Standard,this.avatarEnabled=!1,this.privSpeechServiceConfig=o||new t.SpeechServiceConfig(new t.Context(null)),this.privParameters=s}get parameters(){return this.privParameters}get synthesisServiceType(){return this.privSynthesisServiceType}set synthesisServiceType(o){this.privSynthesisServiceType=o}set synthesisVideoSection(o){this.privSpeechServiceConfig.Context.synthesis={video:o}}get SpeechServiceConfig(){return this.privSpeechServiceConfig}setContextFromJson(o){const s=JSON.parse(o);s.system&&(this.privSpeechServiceConfig.Context.system=s.system),s.os&&(this.privSpeechServiceConfig.Context.os=s.os),s.audio&&(this.privSpeechServiceConfig.Context.audio=s.audio),s.synthesis&&(this.privSpeechServiceConfig.Context.synthesis=s.synthesis)}}e.SynthesizerConfig=u})(ns)),ns}var wi={},dp;function Mg(){if(dp)return wi;dp=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.SynthesisContext=void 0;const e=A();let t=class{constructor(){this.privContext={}}setSection(u,n){this.privContext[u]=n}set audioOutputFormat(u){this.privAudioOutputFormat=u}toJSON(){return JSON.stringify(this.privContext)}setSynthesisSection(u){const n=this.buildSynthesisContext(u);this.setSection("synthesis",n)}buildSynthesisContext(u){return{audio:{metadataOptions:{bookmarkEnabled:!!(u!=null&&u.bookmarkReached),punctuationBoundaryEnabled:u==null?void 0:u.properties.getProperty(e.PropertyId.SpeechServiceResponse_RequestPunctuationBoundary,!!(u!=null&&u.wordBoundary)),sentenceBoundaryEnabled:u==null?void 0:u.properties.getProperty(e.PropertyId.SpeechServiceResponse_RequestSentenceBoundary,!1),sessionEndEnabled:!0,visemeEnabled:!!(u!=null&&u.visemeReceived),wordBoundaryEnabled:u==null?void 0:u.properties.getProperty(e.PropertyId.SpeechServiceResponse_RequestWordBoundary,!!(u!=null&&u.wordBoundary))},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:u==null?void 0:u.autoDetectSourceLanguage}}}};return wi.SynthesisContext=t,wi}var ss={},hp;function Og(){return hp||(hp=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.type=e.connectivity=e.Device=e.OS=e.System=e.Context=e.SpeechServiceConfig=void 0;class t{constructor(r){this.context=r}serialize(){return JSON.stringify(this,(r,a)=>{if(a&&typeof a=="object"&&!Array.isArray(a)){const c={};for(const p in a)Object.hasOwnProperty.call(a,p)&&(c[p&&p.charAt(0).toLowerCase()+p.substring(1)]=a[p]);return c}return a})}get Context(){return this.context}get Recognition(){return this.recognition}set Recognition(r){this.recognition=r.toLowerCase()}}e.SpeechServiceConfig=t;class i{constructor(r){this.system=new u,this.os=r}}e.Context=i;class u{constructor(){const r="1.47.0";this.name="SpeechSDK",this.version=r,this.build="JavaScript",this.lang="JavaScript"}}e.System=u;class n{constructor(r,a,c){this.platform=r,this.name=a,this.version=c}}e.OS=n;class o{constructor(r,a,c){this.manufacturer=r,this.model=a,this.version=c}}e.Device=o,(function(s){s.Bluetooth="Bluetooth",s.Wired="Wired",s.WiFi="WiFi",s.Cellular="Cellular",s.InBuilt="InBuilt",s.Unknown="Unknown"})(e.connectivity||(e.connectivity={})),(function(s){s.Phone="Phone",s.Speaker="Speaker",s.Car="Car",s.Headset="Headset",s.Thermostat="Thermostat",s.Microphones="Microphones",s.Deskphone="Deskphone",s.RemoteControl="RemoteControl",s.Unknown="Unknown",s.File="File",s.Stream="Stream"})(e.type||(e.type={}))})(ss)),ss}var lp;function w(){return lp||(lp=1,(function(e){var t=le&&le.__createBinding||(Object.create?(function(o,s,r,a){a===void 0&&(a=r),Object.defineProperty(o,a,{enumerable:!0,get:function(){return s[r]}})}):(function(o,s,r,a){a===void 0&&(a=r),o[a]=s[r]})),i=le&&le.__exportStar||function(o,s){for(var r in o)r!=="default"&&!Object.prototype.hasOwnProperty.call(s,r)&&t(s,o,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.AutoDetectSourceLanguagesOpenRangeOptionName=e.ForceDictationPropertyName=e.ServicePropertiesPropertyName=e.CancellationErrorCodePropertyName=e.OutputFormatPropertyName=e.SpeechSynthesisAdapter=e.AvatarSynthesisAdapter=void 0,i(_l(),e),i(bl(),e),i(ys(),e),i(Ml(),e),i(Ol(),e),i(Rs(),e),i(bf(),e),i(Mf(),e),i(Of(),e),i(Df(),e),i(kf(),e),i(Nf(),e),i(zf(),e),i(jf(),e),i(Lf(),e),i(rd(),e),i(qf(),e),i(Bf(),e),i(Ff(),e),i(xf(),e),i(Uf(),e),i(Wf(),e),i(Hf(),e),i(Kf(),e),i(Vf(),e),i(Jf(),e),i(Qf(),e),i(Xf(),e),i(Zf(),e),i(Yf(),e),i(eg(),e),i(rg(),e),i(ng(),e),i(ug(),e),i(pg(),e),i(Pg(),e),i(gd(),e),i(Tg(),e),i(Ag(),e);var u=Ig();Object.defineProperty(e,"AvatarSynthesisAdapter",{enumerable:!0,get:function(){return u.AvatarSynthesisAdapter}});var n=wg();Object.defineProperty(e,"SpeechSynthesisAdapter",{enumerable:!0,get:function(){return n.SpeechSynthesisAdapter}}),i(_g(),e),i(bg(),e),i(Mg(),e),i(Og(),e),e.OutputFormatPropertyName="OutputFormat",e.CancellationErrorCodePropertyName="CancellationErrorCode",e.ServicePropertiesPropertyName="ServiceProperties",e.ForceDictationPropertyName="ForceDictation",e.AutoDetectSourceLanguagesOpenRangeOptionName="UND"})(le)),le}var vp;function Dg(){return vp||(vp=1,(function(e){var t=he&&he.__createBinding||(Object.create?(function(n,o,s,r){r===void 0&&(r=s),Object.defineProperty(n,r,{enumerable:!0,get:function(){return o[s]}})}):(function(n,o,s,r){r===void 0&&(r=s),n[r]=o[s]})),i=he&&he.__exportStar||function(n,o){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(o,s)&&t(o,n,s)};Object.defineProperty(e,"__esModule",{value:!0});const u=w();new u.AgentConfig,i(A(),e)})(he)),he}var zi=Dg();const kg="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M394 480a16 16 0 0 1-9.39-3L256 383.76 127.39 477a16 16 0 0 1-24.55-18.08L153 310.35 23 221.2a16 16 0 0 1 9-29.2h160.38l48.4-148.95a16 16 0 0 1 30.44 0l48.4 149H480a16 16 0 0 1 9.05 29.2L359 310.35l50.13 148.53A16 16 0 0 1 394 480'/></svg>",bi={TIMES:"times",PLUS:"plus",MINUS:"minus"},Z={BEGINNER:"beginner",MEDIUM:"medium",EXPERT:"expert"},fp={[bi.TIMES]:{[Z.BEGINNER]:{min1:1,max1:12,min2:1,max2:12},[Z.MEDIUM]:{min1:3,max1:12,min2:3,max2:12},[Z.EXPERT]:{min1:5,max1:20,min2:5,max2:20}},[bi.PLUS]:{[Z.BEGINNER]:{min1:1,max1:50,min2:1,max2:50},[Z.MEDIUM]:{min1:1,max1:100,min2:1,max2:100},[Z.EXPERT]:{min1:1,max1:1e3,min2:1,max2:1e3}},[bi.MINUS]:{[Z.BEGINNER]:{min1:10,max1:20,min2:1,max2:10},[Z.MEDIUM]:{min1:20,max1:100,min2:1,max2:20},[Z.EXPERT]:{min1:100,max1:500,min2:1,max2:100}}},os={ENCOURAGEMENT:["Well done!","Great work!","Good job!","Keep up the good work!","You've really got this!","Amazing!","Fantastic!"],CORRECT:["That's correct","That's right","Exactly!","Flawless","Perfect"],INCORRECT:["Not quite","Maybe next time","I'm sure you can get the next one right","Incorrect","Close, but not quite"]};function gp(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}function as(e){return e[Math.floor(Math.random()*e.length)]}function Ng(e){if(!e)return null;const t=String(e).match(/\d+/);return t?parseInt(t[0],10):null}function zg(e){return`${e} star${e===1?"":"s"}`}const jg=1e4;function md(){return"https://olivermath-api.azurewebsites.net"}async function Sd(e,t={},i=jg){const u=new AbortController,n=setTimeout(()=>u.abort(),i);try{return await fetch(e,{...t,signal:u.signal})}finally{clearTimeout(n)}}async function Lg(){const e=await Sd(`${md()}/api/speechToken`);if(!e.ok)throw new Error(`Speech token request failed: ${e.status}`);return e.json()}async function qg(e,t="en-US-AnaNeural",i="friendly"){if(!e||e.trim().length===0)throw new Error("Text is required for speech synthesis");const u=e.slice(0,500),n=await Sd(`${md()}/api/speak`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:u,voice:t,style:i})});if(!n.ok){const o=await n.json().catch(()=>({}));throw new Error(o.error||`TTS request failed: ${n.status}`)}return n.json()}const je=new Map,Bg=20;async function Fg(e){const t=e.toLowerCase().trim();if(je.has(t)){const n=je.get(t);return n.currentTime=0,n}const i=await qg(e),u=new Audio(`data:audio/mpeg;base64,${i.audio}`);if(je.size>=Bg){const n=je.keys().next().value;je.delete(n)}return je.set(t,u),u}const xg={name:"Math",components:{BotFace:Vh,IonHeader:bh,IonToolbar:_h,IonTitle:wh,IonContent:Ih,IonPage:Ah,IonChip:Th,IonLabel:Eh,IonIcon:Ph,IonItem:Rh,IonSelect:yh,IonSelectOption:Ch,IonButton:Sh,IonFooter:mh},data(){return{typeText:[],isLoading:!0,isOnBoundary:!1,isTalking:!1,isListening:!1,isComputing:!1,isLaughing:!1,isError:!1,isQuery:!1,isPlayMode:!0,isResolved:!1,text:"",selectedLevel:Z.MEDIUM,selectedOperator:bi.TIMES,speech_phrases:"Click play, listen the question and respond back by talking your answer.",number1:2,number2:3,stars:0,previousPosition:-1,synth:window.speechSynthesis,greetingSpeech:new window.SpeechSynthesisUtterance,audioConfig:null,speechConfig:null,speechRecognizer:null,speechRecording:null,token:null,speechRegion:null,audioPlayer:null,isMicrophoneEnabled:!1,publicPath:"/OliverMath/",timeout:null}},computed:{botState(){return this.isError?"broken":this.isLaughing?"laughing":this.isTalking?"speaking":this.isListening?"listening":this.isComputing?"computing":"thinking"},expectedResultAsNumber(){return this.selectedOperator=="plus"?this.number1+this.number2:this.selectedOperator=="minus"?this.number1-this.number2:this.number1*this.number2}},methods:{changeStatus(e){if(this.timeout&&e=="laughing"){var t=new Audio(window.location.origin+this.$route.path+this.publicPath+"assets/sound/laugh.wav");t.play(),this.isLaughing=!0}clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.isLaughing=!1},1500)},keyDownHandler(e){let t=e.key*1;!isNaN(parseFloat(t))&&isFinite(t)&&(this.typeText.push(t),this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{if(this.typeText.length>0){var i=this.typeText.join("");this.showToast("Your writing response is : "+i,"secondary"),this.validateWord(i),this.typeText=[]}},400))},async showToast(e,t){return(await Mh.create({message:e,duration:5e3,color:t,translucent:!1,cssClass:"toast-custom-position",animated:!1})).present()},async enableMicrophone(){var e=this;this.isMicrophoneEnabled||(e.speech_phrases="enabling microphone..",e.isMicrophoneEnabled=!0,await navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(t){e.audioConfig=zi.AudioConfig.fromMicrophoneInput(t.id),e.speech_phrases="microphone enabled"}).catch(function(){e.speech_phrases="microphone disabled",e.isError=!0,e.showToast("Microphone disabled","danger"),e.isMicrophoneEnabled=!1}))},async askQuestion(){this.audioConfig=zi.AudioConfig.fromDefaultMicrophoneInput(),this.isResolved=!1;var e=this;this.isComputing=!0,await this.enableMicrophone().then(function(){var t;if(e.isMicrophoneEnabled){e.isComputing=!1,e.isQuery=!0,e.isPlayMode=!1,e.speech_phrases="";const i=((t=fp[e.selectedOperator])==null?void 0:t[e.selectedLevel])||fp[bi.TIMES][Z.BEGINNER];e.number1=gp(i.min1,i.max1),e.number2=gp(i.min2,i.max2),e.text=`What's ${e.number1} ${e.selectedOperator} ${e.number2}?`,e.speak()}else e.speech_phrases="microphone not available",e.isError=!0,e.showToast("Microphone not available","danger")}).catch(function(t){console.error("Failed to ask question:",t),e.isError=!0,e.text="Something went wrong. Please try again.",e.showToast(e.text,"danger")})},async speak(){if(!(this.audioPlayer&&!this.audioPlayer.paused)){this.speech_phrases=this.text,this.isTalking=!0,this.isOnBoundary=!0;try{const e=await Fg(this.text);this.audioPlayer=e,e.onended=()=>{this.isTalking=!1,this.isQuery&&(this.isQuery=!1,this.listen())},e.onerror=()=>{this.isTalking=!1,this.speakWithBrowser()},await e.play()}catch(e){console.error("Azure TTS error:",e),this.isTalking=!1,this.speakWithBrowser()}}},speakWithBrowser(){this.synth.speaking||(this.greetingSpeech.text=this.text,this.synth.speak(this.greetingSpeech))},listen(){this.showToast("Listening...","warning"),this.isComputing=!0,this.isListening=!1;var e=zi.SpeechConfig.fromAuthorizationToken(this.token,this.speechRegion);e.speechRecognitionLanguage="en-GB",this.speechConfig=e,this.speechRecording=new zi.SpeechRecognizer(this.speechConfig,this.audioConfig),this.listenForSpeechRecordingEvents()},listenForSpeechRecordingEvents(){const e=this;this.speechRecording.speechStartDetected=function(){console.log("speechStartDetected"),e.showToast("I'm Listening","success"),e.isListening=!0,e.isComputing=!1},this.speechRecording.recognizing=function(t,i){window.console.log("recognizing ",i.result.text),e.validateSpeechRecording(i.result.text,!1)},this.speechRecording.recognizeOnceAsync(function(t){e.validateSpeechRecording(t.text,!0),e.isListening=!1,e.isComputing=!1,e.speechRecording.close(),e.speechRecording=null},function(t){console.log("err recognizeOnceAsync",t),e.showToast("Unable to connect to the server.","danger"),e.isListening=!1,e.isComputing=!1,e.isQuery=!1,e.isError=!0,e.text="Unable to recognized the voice. Internal error",e.showToast(e.text),e.speechRecording.close(),e.speechRecording=null})},listenForSpeechEvents(){this.greetingSpeech.onstart=()=>{this.isTalking=!0,this.isOnBoundary=!1,this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.isOnBoundary||(this.speech_phrases=this.text,this.isOnBoundary=!0)},600)},this.greetingSpeech.onend=()=>{this.isTalking=!1,this.isQuery&&(this.isQuery=!1,this.listen())},this.greetingSpeech.onboundary=e=>{if(this.isOnBoundary=!0,e.name=="word"){var t=this.getWordAt(this.text,e.charIndex).toLowerCase();t=="times"&&(t="x"),t=="plus"&&(t="+"),t=="minus"&&(t="-"),this.speech_phrases+=t+" "}}},validateWord(e){if(!e||this.isResolved)return;const t=Ng(e);t!==null&&t===this.expectedResultAsNumber&&(this.isResolved=!0)},validateSpeechRecording(e,t){const i=e===void 0,u=i?"(silent)":String(e);if(i||(this.showToast(`Your response: ${u}`,"secondary"),this.validateWord(e)),this.isResolved){this.stars++,localStorage.stars=this.stars;const n=as(os.CORRECT),o=as(os.ENCOURAGEMENT);this.text=`${n}, ${o}; You earned ${zg(this.stars)}.`}else if(t){const n=as(os.INCORRECT);this.text=`${n}, the correct answer is ${this.expectedResultAsNumber}.`}t&&(this.speak(),this.isPlayMode=!0)},getWordAt(e,t){if(e=String(e),t=Number(t)>>>0,this.previousPosition===t)return this.isTalking=!1,"";this.previousPosition=t;const i=e.slice(0,t+1).search(/\S+$/),u=e.slice(t).search(/\s/);return u<0?(this.isQuery||(this.isPlayMode=!0),this.isTalking=!1,e.slice(i)):e.slice(i,u+t)}},async mounted(){try{await navigator.mediaDevices.getUserMedia({audio:!0}),this.isMicrophoneEnabled=!0}catch{console.warn("Microphone not available")}this.listenForSpeechEvents();const e=localStorage.getItem("stars");e&&(this.stars=parseInt(e,10)||0);try{const{token:t,region:i}=await Lg();this.token=t,this.speechRegion=i}catch(t){console.error("Failed to get speech token:",t),this.isError=!0,this.speech_phrases="Server is unavailable. Please refresh the page.",this.showToast(this.speech_phrases,"danger")}},setup(){return{star:kg}},created(){window.addEventListener("keydown",this.keyDownHandler)},unmounted(){window.removeEventListener("keydown",this.keyDownHandler),this.audioPlayer&&(this.audioPlayer.pause(),this.audioPlayer=null),this.timeout&&clearTimeout(this.timeout)}};function Ug(e,t,i,u,n,o){const s=B("ion-title"),r=B("ion-icon"),a=B("ion-label"),c=B("ion-chip"),p=B("ion-toolbar"),d=B("ion-header"),l=B("ion-select-option"),h=B("ion-select"),g=B("ion-item"),f=B("BotFace"),m=B("ion-content"),v=B("ion-button"),S=B("ion-footer"),C=B("ion-page");return qi(),cs(C,null,{default:L(()=>[q(d,null,{default:L(()=>[q(p,null,{default:L(()=>[q(s,null,{default:L(()=>[...t[3]||(t[3]=[J("Math Game",-1)])]),_:1}),q(c,{slot:"end","aria-label":"Stars earned"},{default:L(()=>[q(r,{icon:u.star,color:"warning","aria-hidden":"true"},null,8,["icon"]),q(a,null,{default:L(()=>[J(us(n.stars),1)]),_:1})]),_:1})]),_:1})]),_:1}),q(g,null,{default:L(()=>[q(a,{id:"level-label"},{default:L(()=>[...t[4]||(t[4]=[J("Difficulty",-1)])]),_:1}),q(h,{interface:"popover",value:n.selectedLevel,onIonChange:t[0]||(t[0]=y=>n.selectedLevel=y.target.value),"aria-labelledby":"level-label"},{default:L(()=>[q(l,{value:"beginner"},{default:L(()=>[...t[5]||(t[5]=[J("Beginner",-1)])]),_:1}),q(l,{value:"medium"},{default:L(()=>[...t[6]||(t[6]=[J("Medium",-1)])]),_:1}),q(l,{value:"expert"},{default:L(()=>[...t[7]||(t[7]=[J("Expert",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),q(g,null,{default:L(()=>[q(a,{id:"operator-label"},{default:L(()=>[...t[8]||(t[8]=[J("Operator",-1)])]),_:1}),q(h,{interface:"popover",value:n.selectedOperator,onIonChange:t[1]||(t[1]=y=>n.selectedOperator=y.target.value),"aria-labelledby":"operator-label"},{default:L(()=>[q(l,{value:"times"},{default:L(()=>[...t[9]||(t[9]=[J("Multiply ()",-1)])]),_:1}),q(l,{value:"plus"},{default:L(()=>[...t[10]||(t[10]=[J("Addition (+)",-1)])]),_:1}),q(l,{value:"minus"},{default:L(()=>[...t[11]||(t[11]=[J("Subtraction ()",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),q(m,{fullscreen:!0,role:"main"},{default:L(()=>[q(f,{botState:o.botState,isPlayMode:n.isPlayMode,text:n.speech_phrases,onAsk_question:o.askQuestion,onClick:t[2]||(t[2]=y=>o.changeStatus("laughing")),"aria-live":"polite"},null,8,["botState","isPlayMode","text","onAsk_question"])]),_:1}),q(S,{"no-padding":"",style:{"margin-bottom":"5px"}},{default:L(()=>[n.isPlayMode&&o.botState!=="broken"?(qi(),cs(v,{key:0,expand:"full",onClick:o.askQuestion,disabled:n.isComputing,"aria-label":"Start a new math question"},{default:L(()=>[J(us(n.isComputing?"Loading...":"Play Math"),1)]),_:1},8,["onClick","disabled"])):Oh("",!0)]),_:1})]),_:1})}const Wg=Ss(xg,[["render",Ug]]),Hg=()=>Dh(()=>import("./Assistant-Cf7rrYP-.js"),__vite__mapDeps([0,1,2])),Kg=[{path:"/",name:"Home",component:Wg},{path:"/assistant",name:"Assistant",component:Hg}],Cd=xh({history:Uh("/OliverMath/"),routes:Kg}),Vg=kh(Lh).use(Nh).use(Cd);Cd.isReady().then(()=>{Vg.mount("#app")});export{Ss as _};
